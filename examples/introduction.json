{"history":[],"inner":{"t":"resheet.document","v":1,"pages":[{"id":0,"name":"Introduction","state":{"t":"resheet.selector","v":0,"mode":"run","expr":"SheetOf(Note)","inner":{"t":"resheet.sheet","v":2,"lines":[{"id":0,"name":"","visibility":"result","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"= <h1 className=\"flex space-x-2 items-baseline my-2 text-5xl\">\n    <img className=\"h-12\" src={resheet.assets.logoSvg} alt=\"ReSheet Logo\"/>\n    <span>ReSheet</span>\n    <span className=\"text-2xl\">alpha</span>\n  </h1>","note":{"type":"expr","code":" <h1 className=\"flex space-x-2 items-baseline my-2 text-5xl\">\n    <img className=\"h-12\" src={resheet.assets.logoSvg} alt=\"ReSheet Logo\"/>\n    <span>ReSheet</span>\n    <span className=\"text-2xl\">alpha</span>\n  </h1>"}}},{"id":41,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"A hackable notes-spreadsheet-hybrid for programmers.","note":{"type":"text","tag":"p","text":"A hackable notes-spreadsheet-hybrid for programmers."}}},{"id":86,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"","note":{"type":"text","tag":"p","text":""}}},{"id":87,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"ReSheet is a notepad similar to Notion. In every line you can choose to write a formula in JavaScript. Just start with a \"`=`\" like in a spreadsheet.","note":{"type":"text","tag":"p","text":"ReSheet is a notepad similar to Notion. In every line you can choose to write a formula in JavaScript. Just start with a \"`=`\" like in a spreadsheet."}}},{"id":99,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"Every line is a Block. A Block can be thought of like a cell in a spreadsheet. There are different types of Blocks you can use and you can build your own custom Blocks. See the Introduction > Blocks and Examples > \"Advanced Playground\" pages for details.","note":{"type":"text","tag":"p","text":"Every line is a Block. A Block can be thought of like a cell in a spreadsheet. There are different types of Blocks you can use and you can build your own custom Blocks. See the Introduction > Blocks and Examples > \"Advanced Playground\" pages for details."}}},{"id":100,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"","note":{"type":"text","tag":"p","text":""}}},{"id":85,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"ReSheet is heavily keyboard-focused:","note":{"type":"text","tag":"p","text":"ReSheet is heavily keyboard-focused:"}}},{"id":88,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":1,"input":"Try **⌘K/⌘⇧P** to see all commands for the currently focused block(s). (Also try **⌘?**)","note":{"type":"text","tag":"p","text":"Try **⌘K/⌘⇧P** to see all commands for the currently focused block(s). (Also try **⌘?**)"}}},{"id":89,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":1,"input":"Use the ArrowKeys or `H`/`J`/`K`/`L` and `Enter`/`Escape` to move between Blocks.","note":{"type":"text","tag":"p","text":"Use the ArrowKeys or `H`/`J`/`K`/`L` and `Enter`/`Escape` to move between Blocks."}}},{"id":90,"name":"","visibility":"result","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"= <img className=\"my-4\" alt=\"ReSheet demo animation\" src={resheet.assets.demoGif} />","note":{"type":"expr","code":" <img className=\"my-4\" alt=\"ReSheet demo animation\" src={resheet.assets.demoGif} />"}}},{"id":70,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"## Shortcuts","note":{"type":"text","tag":"h2","text":"Shortcuts"}}},{"id":76,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"*⌘ = Meta = Ctrl (can be used interchangeably, useful if the browser intercepts a variant)*","note":{"type":"text","tag":"p","text":"*⌘ = Meta = Ctrl (can be used interchangeably, useful if the browser intercepts a variant)*"}}},{"id":66,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"Command Search: **⌘K/⌘⇧P**","note":{"type":"text","tag":"p","text":"Command Search: **⌘K/⌘⇧P**"}}},{"id":67,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"Shortcut Suggestions: **⌘?**","note":{"type":"text","tag":"p","text":"Shortcut Suggestions: **⌘?**"}}},{"id":68,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"Navigation: **Arrow Keys/`HJKL`**","note":{"type":"text","tag":"p","text":"Navigation: **Arrow Keys/`HJKL`**"}}},{"id":69,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"Go in/out: **`Enter`/`Escape`**","note":{"type":"text","tag":"p","text":"Go in/out: **`Enter`/`Escape`**"}}},{"id":98,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"","note":{"type":"text","tag":"p","text":""}}},{"id":71,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"## Writing","note":{"type":"text","tag":"h2","text":"Writing"}}},{"id":72,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"Format with Markdown: `*italic* **bold** [link text](link url)` etc","note":{"type":"text","tag":"p","text":"Format with Markdown: `*italic* **bold** [link text](link url)` etc"}}},{"id":97,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"","note":{"type":"text","tag":"p","text":""}}},{"id":7,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"\"Formulas\" (JavaScript) start with `\"=\"`:","note":{"type":"text","tag":"p","text":"\"Formulas\" (JavaScript) start with `\"=\"`:"}}},{"id":82,"name":"x","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"= 12","note":{"type":"expr","code":" 12"}}},{"id":84,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"= Math.sqrt(x + x)","note":{"type":"expr","code":" Math.sqrt(x + x)"}}},{"id":80,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"**⌘`Space`** for completions","note":{"type":"text","tag":"p","text":"**⌘`Space`** for completions"}}},{"id":81,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"**⌘`D`** for docs (if available)","note":{"type":"text","tag":"p","text":"**⌘`D`** for docs (if available)"}}},{"id":91,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"","note":{"type":"text","tag":"p","text":""}}},{"id":94,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"","note":{"type":"text","tag":"p","text":""}}},{"id":95,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"---","note":{"type":"text","tag":"p","text":"---"}}},{"id":92,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"#### Notes on Privacy and Data","note":{"type":"text","tag":"h4","text":"Notes on Privacy and Data"}}},{"id":93,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"Documents in ReSheet reside 100% on your devices. They are not stored or sent anywhere on/to a server. Documents are backed up a limited time (7 days since last opening) in your browser (IndexedDB) so you don't lose them because of accidentally reloading or closing ReSheet. To persist your documents use the \"Save File\" and \"Load local File ...\" actions in the File menu.","note":{"type":"text","tag":"p","text":"Documents in ReSheet reside 100% on your devices. They are not stored or sent anywhere on/to a server. Documents are backed up a limited time (7 days since last opening) in your browser (IndexedDB) so you don't lose them because of accidentally reloading or closing ReSheet. To persist your documents use the \"Save File\" and \"Load local File ...\" actions in the File menu."}}},{"id":96,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"ReSheet collects some very basic analytics like visitor count, visit time, browser type and OS without any personally identifiable information with umami.is.","note":{"type":"text","tag":"p","text":"ReSheet collects some very basic analytics like visitor count, visit time, browser type and OS without any personally identifiable information with umami.is."}}}]}},"isCollapsed":false,"children":[{"id":0,"name":"Tips","state":{"t":"resheet.selector","v":0,"mode":"run","expr":"SheetOf(Note)","inner":{"t":"resheet.sheet","v":2,"lines":[{"id":13,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"# Tips","note":{"type":"text","tag":"h1","text":"Tips"}}},{"id":2,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"Your document is automatically backed up to IndexedDB, but gets deleted after 7 days. So don't forget to save it to a local file.","note":{"type":"text","tag":"p","text":"Your document is automatically backed up to IndexedDB, but gets deleted after 7 days. So don't forget to save it to a local file."}}},{"id":3,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"","note":{"type":"text","tag":"p","text":""}}},{"id":4,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"ReSheet gives you the full power of JavaScript and React.","note":{"type":"text","tag":"p","text":"ReSheet gives you the full power of JavaScript and React."}}},{"id":5,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"**Be aware:** You have the **power to break it** (but generally you can undo it – ⌘Z) and full responsibilty to **ensure you trust the code you run**.","note":{"type":"text","tag":"p","text":"**Be aware:** You have the **power to break it** (but generally you can undo it – ⌘Z) and full responsibilty to **ensure you trust the code you run**."}}},{"id":6,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"Also beware of side-effects in your code: Everything is automatically rerun as needed (for changes), so side-effects may execute for every character you type.","note":{"type":"text","tag":"p","text":"Also beware of side-effects in your code: Everything is automatically rerun as needed (for changes), so side-effects may execute for every character you type."}}},{"id":7,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"","note":{"type":"text","tag":"p","text":""}}},{"id":8,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"If a shortcut triggers a browser action, try an alternative key combination by switching ⌘/Meta/Ctrl.","note":{"type":"text","tag":"p","text":"If a shortcut triggers a browser action, try an alternative key combination by switching ⌘/Meta/Ctrl."}}},{"id":9,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":1,"input":"For example:","note":{"type":"text","tag":"p","text":"For example:"}}},{"id":10,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":2,"input":"⌘N = Meta-N = Ctrl-N","note":{"type":"text","tag":"p","text":"⌘N = Meta-N = Ctrl-N"}}},{"id":11,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":2,"input":"⌘⇧P = Meta-Shift-P = Ctrl-Shift-P","note":{"type":"text","tag":"p","text":"⌘⇧P = Meta-Shift-P = Ctrl-Shift-P"}}},{"id":12,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":2,"input":"etc","note":{"type":"text","tag":"p","text":"etc"}}}]}},"isCollapsed":true,"children":[]},{"id":1,"name":"Formulas","state":{"t":"resheet.selector","v":0,"mode":"run","expr":"SheetOf(Note)","inner":{"t":"resheet.sheet","v":2,"lines":[{"id":0,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"# Formulas","note":{"type":"text","tag":"h1","text":"Formulas"}}},{"id":1,"name":"msInADay","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"= 24 /*h*/ * 60 /*min*/ * 60 /*sec*/ * 1000 /*ms*/","note":{"type":"expr","code":" 24 /*h*/ * 60 /*min*/ * 60 /*sec*/ * 1000 /*ms*/"}}},{"id":2,"name":"startOfThisYear","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"= new Date(new Date().getFullYear(), 0, 1)","note":{"type":"expr","code":" new Date(new Date().getFullYear(), 0, 1)"}}},{"id":3,"name":"daysInThisYear","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"= (Date.now() - startOfThisYear.getTime()) / msInADay","note":{"type":"expr","code":" (Date.now() - startOfThisYear.getTime()) / msInADay"}}},{"id":4,"name":"","visibility":"result","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"= // using react:\n<p className=\"py-2\">\n  This year is already {/* preserve the space character before this comment */}\n  {daysInThisYear.toLocaleString(\"en-US\", { maximumFractionDigits: 1 })}\n  {} days long. {}\n  <span className=\"text-sm text-gray-700\">(Select this line and show or hide the code with ⌘M)</span>\n</p>","note":{"type":"expr","code":" // using react:\n<p className=\"py-2\">\n  This year is already {/* preserve the space character before this comment */}\n  {daysInThisYear.toLocaleString(\"en-US\", { maximumFractionDigits: 1 })}\n  {} days long. {}\n  <span className=\"text-sm text-gray-700\">(Select this line and show or hide the code with ⌘M)</span>\n</p>"}}},{"id":30,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"","note":{"type":"text","tag":"p","text":""}}},{"id":35,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"---","note":{"type":"text","tag":"p","text":"---"}}},{"id":31,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"**Important**","note":{"type":"text","tag":"p","text":"**Important**"}}},{"id":32,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"Don't mutate values of other cells. ReSheet is designed to be used like a functional language.","note":{"type":"text","tag":"p","text":"Don't mutate values of other cells. ReSheet is designed to be used like a functional language."}}},{"id":33,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"*Side note:* This is just like any other Spreadsheet works. You can't write formulas that change another cell's value. Cells only change because the values of other cells they depend on change.","note":{"type":"text","tag":"p","text":"*Side note:* This is just like any other Spreadsheet works. You can't write formulas that change another cell's value. Cells only change because the values of other cells they depend on change."}}},{"id":34,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"---","note":{"type":"text","tag":"p","text":"---"}}},{"id":36,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"","note":{"type":"text","tag":"p","text":""}}},{"id":5,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"## External Libraries","note":{"type":"text","tag":"h2","text":"External Libraries"}}},{"id":6,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"[esm.sh](https://esm.sh/) works great for loading npm libraries","note":{"type":"text","tag":"p","text":"[esm.sh](https://esm.sh/) works great for loading npm libraries"}}},{"id":14,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"### Number Formatting","note":{"type":"text","tag":"h3","text":"Number Formatting"}}},{"id":7,"name":"numeral","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"= import('https://esm.sh/numeral')","note":{"type":"expr","code":" import('https://esm.sh/numeral')"}}},{"id":8,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"= numeral.default(123456.789).format('0,0.00')","note":{"type":"expr","code":" numeral.default(123456.789).format('0,0.00')"}}},{"id":10,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"### CSV Parsing","note":{"type":"text","tag":"h3","text":"CSV Parsing"}}},{"id":11,"name":"Papa","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"= import('https://esm.sh/papaparse')","note":{"type":"expr","code":" import('https://esm.sh/papaparse')"}}},{"id":12,"name":"csv","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"id,name,age,plan,email\n0,John,28,free,john@example.com\n1,Alice,34,premium,alice@boo\n2,Bob,43,premium,bob@b.b","note":{"type":"text","tag":"p","text":"id,name,age,plan,email\n0,John,28,free,john@example.com\n1,Alice,34,premium,alice@boo\n2,Bob,43,premium,bob@b.b"}}},{"id":13,"name":"data","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"= Papa.default.parse(csv.text, { header: true }).data","note":{"type":"expr","code":" Papa.default.parse(csv.text, { header: true }).data"}}},{"id":15,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"### Data Validation","note":{"type":"text","tag":"h3","text":"Data Validation"}}},{"id":16,"name":"validator","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"= import('https://esm.sh/validator')","note":{"type":"expr","code":" import('https://esm.sh/validator')"}}},{"id":17,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"= data.map(user => ({ ...user, validEmail: validator.default.isEmail(user.email) }))","note":{"type":"expr","code":" data.map(user => ({ ...user, validEmail: validator.default.isEmail(user.email) }))"}}},{"id":18,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"### Data Processing","note":{"type":"text","tag":"h3","text":"Data Processing"}}},{"id":19,"name":"lodash","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"= import('https://esm.sh/lodash')","note":{"type":"expr","code":" import('https://esm.sh/lodash')"}}},{"id":20,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"= lodash.default.groupBy(data, 'plan')","note":{"type":"expr","code":" lodash.default.groupBy(data, 'plan')"}}},{"id":21,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"### Dates","note":{"type":"text","tag":"h3","text":"Dates"}}},{"id":22,"name":"datefns","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"= import('https://esm.sh/date-fns')","note":{"type":"expr","code":" import('https://esm.sh/date-fns')"}}},{"id":23,"name":"startOfThisyear","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"= datefns.startOfYear(new Date())","note":{"type":"expr","code":" datefns.startOfYear(new Date())"}}},{"id":28,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"= datefns.differenceInDays(new Date(), startOfThisYear)","note":{"type":"expr","code":" datefns.differenceInDays(new Date(), startOfThisYear)"}}},{"id":29,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"= datefns.getDayOfYear(new Date())","note":{"type":"expr","code":" datefns.getDayOfYear(new Date())"}}},{"id":24,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"### Charts","note":{"type":"text","tag":"h3","text":"Charts"}}},{"id":25,"name":"recharts","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"= import('https://esm.sh/recharts?external=react')","note":{"type":"expr","code":" import('https://esm.sh/recharts?external=react')"}}},{"id":27,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"/Code","note":{"type":"block","isInstantiated":true,"code":"Code","state":"const { ResponsiveContainer, BarChart, Bar, XAxis, YAxis } = recharts;\n\n<ResponsiveContainer height={400}>\n  <BarChart data={data}>\n    <Bar type=\"monotone\" dataKey=\"age\" fill=\"#8884d8\" />\n    <XAxis dataKey=\"name\"/>\n    <YAxis/>\n  </BarChart>\n</ResponsiveContainer>"}}}]}},"isCollapsed":true,"children":[]},{"id":2,"name":"Markdown","state":{"t":"resheet.selector","v":0,"mode":"run","expr":"SheetOf(Note)","inner":{"t":"resheet.sheet","v":2,"lines":[{"id":0,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"# Markdown","note":{"type":"text","tag":"h1","text":"Markdown"}}},{"id":1,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"*`*italic*`*","note":{"type":"text","tag":"p","text":"*`*italic*`*"}}},{"id":2,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"**`**bold**`**","note":{"type":"text","tag":"p","text":"**`**bold**`**"}}},{"id":3,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"`[a link](url)`","note":{"type":"text","tag":"p","text":"`[a link](url)`"}}},{"id":4,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"- Lists","note":{"type":"text","tag":"li","text":"Lists"}}},{"id":5,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"[ ] Todos","note":{"type":"checkbox","checked":false,"text":"Todos"}}},{"id":6,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"[x] Done","note":{"type":"checkbox","checked":true,"text":"Done"}}},{"id":7,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"`# Headings`","note":{"type":"text","tag":"p","text":"`# Headings`"}}},{"id":8,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"Inline <span className=\"before:block before:absolute before:-inset-0.5 before:-skew-y-1 before:bg-blue-100 relative inline-block\"><span className=\"relative text-blue-950\">Html with [tailwindcss](https://tailwindcss.com/docs/utility-first)</span></span>","note":{"type":"text","tag":"p","text":"Inline <span className=\"before:block before:absolute before:-inset-0.5 before:-skew-y-1 before:bg-blue-100 relative inline-block\"><span className=\"relative text-blue-950\">Html with [tailwindcss](https://tailwindcss.com/docs/utility-first)</span></span>"}}}]}},"isCollapsed":true,"children":[]},{"id":3,"name":"Blocks","state":{"t":"resheet.selector","v":0,"mode":"run","expr":"SheetOf(Note)","inner":{"t":"resheet.sheet","v":2,"lines":[{"id":0,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"# Blocks","note":{"type":"text","tag":"h1","text":"Blocks"}}},{"id":1,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"Blocks are the equivalent to cells in a spreadsheet. Most things in ReSheet are Blocks.","note":{"type":"text","tag":"p","text":"Blocks are the equivalent to cells in a spreadsheet. Most things in ReSheet are Blocks."}}},{"id":3,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"","note":{"type":"text","tag":"p","text":""}}},{"id":2,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"Every line here contains a `Note` Block, which allows writing Markdown or Formulas (e.g. \"`= 1 + 1`\").","note":{"type":"text","tag":"p","text":"Every line here contains a `Note` Block, which allows writing Markdown or Formulas (e.g. \"`= 1 + 1`\")."}}},{"id":4,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"A `Note` Block also allows using another Block, for example `Code`. Type in an empty line:","note":{"type":"text","tag":"p","text":"A `Note` Block also allows using another Block, for example `Code`. Type in an empty line:"}}},{"id":5,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"`/Code`","note":{"type":"text","tag":"p","text":"`/Code`"}}},{"id":6,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"and after hitting ⌘`Enter` you get:","note":{"type":"text","tag":"p","text":"and after hitting ⌘`Enter` you get:"}}},{"id":7,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"/Code","note":{"type":"block","isInstantiated":true,"code":"Code","state":"// This is a Code Block now\nfunction Mark({ children }) {\n  return (\n    <span className=\"before:block before:absolute before:-inset-0.5 before:-skew-y-2 before:bg-blue-400 relative inline-block\">\n      <span className=\"relative text-white px-0.5 tracking-wide\">\n        {children}\n      </span>\n    </span>\n  )\n}\n\n<p className=\"py-1\">\n  <Mark>Look</Mark> at it!\n</p>"}}},{"id":8,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"","note":{"type":"text","tag":"p","text":""}}},{"id":9,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"All lines here are part of the `SheetOf` Block:","note":{"type":"text","tag":"p","text":"All lines here are part of the `SheetOf` Block:"}}},{"id":10,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"`/SheetOf(Note)`","note":{"type":"text","tag":"p","text":"`/SheetOf(Note)`"}}},{"id":11,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"/SheetOf(Note)","note":{"type":"block","isInstantiated":true,"code":"SheetOf(Note)","state":{"t":"resheet.sheet","v":2,"lines":[{"id":0,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"Now we have a Sheet inside of a Sheet","note":{"type":"text","tag":"p","text":"Now we have a Sheet inside of a Sheet"}}},{"id":1,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"= $9.text","note":{"type":"expr","code":" $9.text"}}}]}}}},{"id":12,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"","note":{"type":"text","tag":"p","text":""}}},{"id":13,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"","note":{"type":"text","tag":"p","text":""}}},{"id":14,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"There are other Blocks available in `blocks`. (Use completion/docs with ⌘`Space`/⌘`D`)","note":{"type":"text","tag":"p","text":"There are other Blocks available in `blocks`. (Use completion/docs with ⌘`Space`/⌘`D`)"}}},{"id":15,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"= blocks","note":{"type":"expr","code":" blocks"}}},{"id":16,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"","note":{"type":"text","tag":"p","text":""}}},{"id":17,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"## Custom Blocks","note":{"type":"text","tag":"h2","text":"Custom Blocks"}}},{"id":18,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"You can build your own blocks. In Examples > \"Advanced Playground\" you can see more elaborate examples. For now you either have to shoot me a message or look at the source code of the existing blocks to find out more.","note":{"type":"text","tag":"p","text":"You can build your own blocks. In Examples > \"Advanced Playground\" you can see more elaborate examples. For now you either have to shoot me a message or look at the source code of the existing blocks to find out more."}}},{"id":19,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"","note":{"type":"text","tag":"p","text":""}}},{"id":20,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"Ok, I'll give you a small example:","note":{"type":"text","tag":"p","text":"Ok, I'll give you a small example:"}}},{"id":21,"name":"RAW","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"/Code","note":{"type":"block","isInstantiated":true,"code":"Code","state":"resheet.core.block.create({\n  init: \"\",\n  view({ state, dispatch, env }, ref) {\n    return (\n      <textarea\n        ref={ref}\n        value={state}\n        onChange={ev => dispatch(stateBefore => ({ state: ev.target.value }))}\n        rows={state.split('\\n').length}\n        />\n    )\n  },\n  recompute(state, update, env) {\n    return { state, invalidated: false }\n  },\n  getResult(state) {\n    return state\n  },\n  fromJSON(json) {\n    return typeof json === 'string' ? json : ''\n  },\n  toJSON(state) {\n    return state\n  },\n})"}}},{"id":22,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"`/RAW`","note":{"type":"text","tag":"p","text":"`/RAW`"}}},{"id":23,"name":"rawText","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"/RAW","note":{"type":"block","isInstantiated":true,"code":"RAW","state":"{\n  \"hello\": \"world\"\n}"}}},{"id":24,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"= JSON.parse(rawText)","note":{"type":"expr","code":" JSON.parse(rawText)"}}}]}},"isCollapsed":true,"children":[]}]},{"id":1,"name":"Examples","state":{"t":"resheet.selector","v":0,"mode":"run","expr":"SheetOf(Note)","inner":{"t":"resheet.sheet","v":2,"lines":[{"id":0,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"# Examples","note":{"type":"text","tag":"h1","text":"Examples"}}},{"id":1,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"The following examples reside in subpages. You find them in the sidebar on the left inside \"Examples\".","note":{"type":"text","tag":"p","text":"The following examples reside in subpages. You find them in the sidebar on the left inside \"Examples\"."}}},{"id":24,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"","note":{"type":"text","tag":"p","text":""}}},{"id":26,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"","note":{"type":"text","tag":"p","text":""}}},{"id":27,"name":"","visibility":"block","width":"wide","state":{"t":"resheet.note","v":1,"level":0,"input":"----","note":{"type":"text","tag":"p","text":"----"}}},{"id":25,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"","note":{"type":"text","tag":"p","text":""}}},{"id":2,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"#### Personal Finances","note":{"type":"text","tag":"h4","text":"Personal Finances"}}},{"id":3,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"Load and parse a CSV file, process and display the data in a chart.","note":{"type":"text","tag":"p","text":"Load and parse a CSV file, process and display the data in a chart."}}},{"id":8,"name":"","visibility":"result","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"/Code","note":{"type":"block","isInstantiated":true,"code":"Code","state":"<div className=\"m-4 p-3 rounded border bg-gray-50 overflow-scroll md:max-h-[60vh]\">\n  <h2 className=\"sticky -top-3 py-1 bg-gray-50 font-medium text-xl z-20 border-b\">\n    Personal Finances Preview\n  </h2>\n  {$`Personal Finances`}\n</div>"}}},{"id":10,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"","note":{"type":"text","tag":"p","text":""}}},{"id":20,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"","note":{"type":"text","tag":"p","text":""}}},{"id":16,"name":"","visibility":"block","width":"wide","state":{"t":"resheet.note","v":1,"level":0,"input":"----","note":{"type":"text","tag":"p","text":"----"}}},{"id":17,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"","note":{"type":"text","tag":"p","text":""}}},{"id":21,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"","note":{"type":"text","tag":"p","text":""}}},{"id":4,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"#### Invoice","note":{"type":"text","tag":"h4","text":"Invoice"}}},{"id":5,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"Load a working hours export (from atWork) and generate an invoice.","note":{"type":"text","tag":"p","text":"Load a working hours export (from atWork) and generate an invoice."}}},{"id":9,"name":"","visibility":"result","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"/Code","note":{"type":"block","isInstantiated":true,"code":"Code","state":"<div className=\"m-4 p-3 rounded border bg-gray-50 overflow-scroll md:max-h-[60vh]\">\n  <h2 className=\"sticky -top-3 py-1 border-b bg-gray-50 font-medium text-xl z-20\">Invoice Preview</h2>\n  {Invoice}\n</div>"}}},{"id":13,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"","note":{"type":"text","tag":"p","text":""}}},{"id":22,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"","note":{"type":"text","tag":"p","text":""}}},{"id":18,"name":"","visibility":"block","width":"wide","state":{"t":"resheet.note","v":1,"level":0,"input":"----","note":{"type":"text","tag":"p","text":"----"}}},{"id":19,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"","note":{"type":"text","tag":"p","text":""}}},{"id":23,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"","note":{"type":"text","tag":"p","text":""}}},{"id":6,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"#### Advanced Playground","note":{"type":"text","tag":"h4","text":"Advanced Playground"}}},{"id":7,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"Create custom Blocks and use the Inspect Block to get a glimpse into ReSheet.","note":{"type":"text","tag":"p","text":"Create custom Blocks and use the Inspect Block to get a glimpse into ReSheet."}}},{"id":15,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"","note":{"type":"text","tag":"p","text":""}}},{"id":34,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"/$`Advanced Playground`","note":{"type":"block","isInstantiated":true,"code":"$`Advanced Playground`","state":{"t":"resheet.sheet","v":2,"lines":[{"id":1,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"### Advanced Playground Preview","note":{"type":"text","tag":"h3","text":"Advanced Playground Preview"}}},{"id":2,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"We build these custom Blocks in this Page:","note":{"type":"text","tag":"p","text":"We build these custom Blocks in this Page:"}}},{"id":3,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"","note":{"type":"text","tag":"p","text":""}}},{"id":4,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"`/CheckEditableBlock`","note":{"type":"text","tag":"p","text":"`/CheckEditableBlock`"}}},{"id":5,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"/CheckEditableBlock","note":{"type":"block","isInstantiated":true,"code":"CheckEditableBlock","state":{"checked":true,"label":"This is an editable label"}}}},{"id":6,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"","note":{"type":"text","tag":"p","text":""}}},{"id":7,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"","note":{"type":"text","tag":"p","text":""}}},{"id":8,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"`/SliderBlock()`","note":{"type":"text","tag":"p","text":"`/SliderBlock()`"}}},{"id":9,"name":"sliderBlockValue","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"/SliderBlock()","note":{"type":"block","isInstantiated":true,"code":"SliderBlock()","state":49}}},{"id":10,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"= sliderBlockValue","note":{"type":"expr","code":" sliderBlockValue"}}},{"id":11,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"","note":{"type":"text","tag":"p","text":""}}},{"id":12,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"","note":{"type":"text","tag":"p","text":""}}},{"id":13,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"And we inspect some built-in Blocks:","note":{"type":"text","tag":"p","text":"And we inspect some built-in Blocks:"}}},{"id":14,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"`/Debug.Inspect(Note)`","note":{"type":"text","tag":"p","text":"`/Debug.Inspect(Note)`"}}},{"id":15,"name":"inspectNote","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"/Debug.Inspect(Note)","note":{"type":"block","isInstantiated":true,"code":"Debug.Inspect(Note)","state":{"t":"resheet.note","v":1,"level":0,"input":"= sliderBlockValue","note":{"type":"expr","code":" sliderBlockValue"}}}}},{"id":16,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"= inspectNote.state","note":{"type":"expr","code":" inspectNote.state"}}},{"id":17,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"","note":{"type":"text","tag":"p","text":""}}},{"id":18,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"","note":{"type":"text","tag":"p","text":""}}},{"id":19,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"<span className=\"text-gray-400 text-sm\">Psst: And don't miss the Grand Finale!</span>","note":{"type":"text","tag":"p","text":"<span className=\"text-gray-400 text-sm\">Psst: And don't miss the Grand Finale!</span>"}}}]}}}},{"id":28,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"","note":{"type":"text","tag":"p","text":""}}},{"id":29,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"","note":{"type":"text","tag":"p","text":""}}},{"id":33,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"","note":{"type":"text","tag":"p","text":""}}}]}},"isCollapsed":false,"children":[{"id":0,"name":"Personal Finances","state":{"t":"resheet.selector","v":0,"mode":"run","expr":"SheetOf(Note)","inner":{"t":"resheet.sheet","v":2,"lines":[{"id":1,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"# Personal Finances","note":{"type":"text","tag":"h1","text":"Personal Finances"}}},{"id":2,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"Load and parse a CSV file, process and display the data in a chart.","note":{"type":"text","tag":"p","text":"Load and parse a CSV file, process and display the data in a chart."}}},{"id":3,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"","note":{"type":"text","tag":"p","text":""}}},{"id":15,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"## Load and Parse CSV","note":{"type":"text","tag":"h2","text":"Load and Parse CSV"}}},{"id":4,"name":"bankExportFile","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"/LoadFile","note":{"type":"block","isInstantiated":true,"code":"LoadFile","state":{"state":"loaded","file":{"content":"IkV4YW1wbGViYW5rIEdsb2JhbCIKCiJUcmFuc2FjdGlvbiBPdmVydmlldyIKCiJCYW5rIENvZGU6IjsiMTIzNDU2NzgiOzsiRGF0ZToiOyIwNC8wOS8yMDEzIgoiQWNjb3VudDoiOyI5ODc2NTQzMiI7OyJUaW1lOiI7IjEyOjM5OjE4IgoiUXVlcnkgYnk6IjsiSmFuZSBEb2UiOzsiQWNjb3VudCBIb2xkZXI6IjsiSmFuZSBEb2UiCgoiUGVyaW9kOiI7OyJmcm9tOiI7IjA4LzAxLzIwMTIiOyJ0bzoiOyIwNC8wOC8yMDEzIgoiQW1vdW50IGluIEVVUjoiOzsiZnJvbToiOyIgIjsidG86IjsiICIKIlNvcnRlZCBieToiOyJCb29raW5nIGRheSI7ImRlc2NlbmRpbmciCgoiQm9va2luZyBEYXkiOyJWYWx1ZSBEYXRlIjsiUGF5ZXIvUGF5ZWUiOyJSZWNpcGllbnQvT2JsaWdvciI7IkFjY291bnQgTm8uIjsiQmFuayBDb2RlIjsiVHJhbnNhY3Rpb24vUHVycG9zZSI7IkN1cnJlbmN5IjsiQW1vdW50IjsiICIKIjA0LzAyLzIwMTMiOyIwMy8zMS8yMDEzIjs7Ozs7IlNUQVRFTUVOVAoKU1RBVEVNRU5UIEFTIE9GIDAzLzMxLzIwMTMiOyJFVVIiOyIwLjkyIjsiSCIKIjAzLzI1LzIwMTMiOyIwMy8yNS8yMDEzIjsiRjA4NDc5MjE3NDA0NyAgICAgICAwMDAwMCI7IkRFVVRTQ0hFIEJBSE4gS0FSTFNSVUhFIEhCIjsiOTQ3Mjk0ODk0MiI7IjEyMDgwMDAwIjsiRElSRUNUIERFQklUCkVDIDQ3ODI3MjQ4IDg0Mjk3MjQ5NTMyNU9DMSI7IkVVUiI7IjEyNy45MCI7IlMiCiIwMy8yMi8yMDEzIjsiMDMvMjIvMjAxMyI7IkpBTkUgRE9FIjsiQU1BWk9OIERPV05MT0FEUyI7IjQ3ODI3NDkyMDkiOyI4Mjk0Mjk4MCI7IkRJUkVDVCBERUJJVAoxNDkyODI5NDgwMzU1NjI0IjsiRVVSIjsiMy45OSI7IlMiCiIwMy8yMi8yMDEzIjsiMDMvMjIvMjAxMyI7IkpBTkUgRE9FIjsiQU1BWk9OIERPV05MT0FEUyI7IjE3NDI4NDcyNDkiOyI3MjQ5NzI0OSI7IkRJUkVDVCBERUJJVAoyNDk4OTI0ODAyNTQwMjQ5IjsiRVVSIjsiMC43OSI7IlMiCiIwMy8xOC8yMDEzIjsiMDMvMTgvMjAxMyI7IkFUTSA0ODgyIjsiQVRNIE5SMDAwMjg0MDEgQkFOSyBDT0RFNzQyOTI4OTAgMSI7OzsiQVRNIFdJVEhEUkFXQUwKMDMvMTgvMTM6NTYiOyJFVVIiOyI1MC4wMCI7IlMiCiIwMy8xMy8yMDEzIjsiMDMvMTMvMjAxMyI7IkFUTSA3NDg5IjsiQVRNIE5SMDAwMjQ5ODEgQkFOSyBDT0RFMjk0Mjg0OTAgMSI7OzsiQVRNIFdJVEhEUkFXQUwKMDMvMTMvMTg6NDMiOyJFVVIiOyI1MC4wMCI7IlMiCiIwMy8xMS8yMDEzIjsiMDMvMTEvMjAxMyI7IkpBTkUgRE9FIjsiUEVURVIgUEFSS0VSIjsiMTg0OTE0ODIiOyI5MTQ3MTk4NiI7IlNUQU5ESU5HIE9SREVSIENSRURJVApNT05FWSI7IkVVUiI7IjE3Mi4wMCI7IkgiCiIwMy8wNC8yMDEzIjsiMDMvMDQvMjAxMyI7IkFUTSAyNDgyIjsiQVRNIE5SMDAwOTg0MjEgQkFOSyBDT0RFOTE4NDk5NDAgMSI7OzsiQVRNIFdJVEhEUkFXQUwKMDMvMDQvMTk6MDEiOyJFVVIiOyI1MC4wMCI7IlMiCiIwMy8wNC8yMDEzIjsiMDMvMDQvMjAxMyI7IkFUTSA5ODQ5IjsiQVRNIE5SMDA4NDkyMzQgQkFOSyBDT0RFOTQ4MjkyNDAgMSI7OzsiQVRNIFdJVEhEUkFXQUwKMDMvMDIvMTg6MTYiOyJFVVIiOyIyMC4wMCI7IlMiCiIwMi8yNy8yMDEzIjsiMDIvMjcvMjAxMyI7IkFUTSA4MjQ5IjsiQVRNIE5SMDAwNDcyOTEgQkFOSyBDT0RFNzk1Mjg5MDIgMSI7OzsiQVRNIFdJVEhEUkFXQUwKMDIvMjcvMTk6MTUiOyJFVVIiOyIyMC4wMCI7IlMiCiIwMi8yNi8yMDEzIjsiMDIvMjYvMjAxMyI7IlNVUEVSTUFSS0VUIENPUk5FUiI7IkpBTkUgRE9FIjsiOTgyNzQ4MjkiOyIxMjA4MDAwMCI7IkRJUkVDVCBERUJJVApHUk9DRVJJRVMiOyJFVVIiOyI4NS40NyI7IlMiCiIwMi8yMC8yMDEzIjsiMDIvMjAvMjAxMyI7IkpBTkUgRE9FIjsiTUFYIE1VU1RFUk1BTk4iOyI5NDg3Mjk0OCI7IjEyOTQ4NzI5IjsiVFJBTlNGRVIKQklMTCBQQVlNRU5UIjsiRVVSIjsiMjUwLjAwIjsiUyIKIjAyLzE1LzIwMTMiOyIwMi8xNS8yMDEzIjsiVVRJTElUWSBDT01QQU5ZIENJVFkiOyJKQU5FIERPRSI7IjI5NDgyOTQ4IjsiMTIwODAwMDAiOyJESVJFQ1QgREVCSVQKRUxFQ1RSSUNJVFkvRU5FUkdZIjsiRVVSIjsiOTAuMDAiOyJTIgoiMDIvMTAvMjAxMyI7IjAyLzEwLzIwMTMiOyJKQU5FIERPRSI7Ik9OTElORSBTSE9QIFhZWiI7Ijc0ODI5NDgyIjsiMTIwODAwMDAiOyJESVJFQ1QgREVCSVQKT1JERVIgTk8uIDQ4Mjk0IjsiRVVSIjsiNDcuOTAiOyJTIgoiMDIvMDUvMjAxMyI7IjAyLzA1LzIwMTMiOyJGSVRORVNTIENFTlRFUiBHWU0iOyJKQU5FIERPRSI7IjI5Mzg0NzI5IjsiMTIwODAwMDAiOyJESVJFQ1QgREVCSVQKTUVNQkVSU0hJUCBGRUUgRkVCIjsiRVVSIjsiMjkuOTkiOyJTIgoiMDIvMDEvMjAxMyI7IjAyLzAxLzIwMTMiOyJKQU5FIERPRSI7IkxJU0EgTVVTVEVSIjsiODQ5MzcyOTQiOyIxMjA4MDAwMCI7IlRSQU5TRkVSCkJJUlRIREFZIEdJRlQiOyJFVVIiOyIxMDAuMDAiOyJIIgoiMDEvMjgvMjAxMyI7IjAxLzI4LzIwMTMiOyJDSU5FTUEgQ0hBSU4gQ0lUWSI7IkpBTkUgRE9FIjsiNDkyODM3NDkiOyIxMjA4MDAwMCI7IkRJUkVDVCBERUJJVApDSU5FTUEgVElDS0VUUyI7IkVVUiI7IjM1LjAwIjsiUyIKIjAxLzI1LzIwMTMiOyIwMS8yNS8yMDEzIjsiSkFORSBET0UiOyJWRVQgRFIuIFdVRkYiOyI4NDczOTI4NCI7IjEyMDgwMDAwIjsiRElSRUNUIERFQklUClZFVEVSSU5BUlkgVFJFQVRNRU5UIjsiRVVSIjsiMTIwLjAwIjsiUyIKIjAxLzIwLzIwMTMiOyIwMS8yMC8yMDEzIjsiSEFSRFdBUkUgU1RPUkUgRElZIjsiSkFORSBET0UiOyIyODM3NDkyOCI7IjEyMDgwMDAwIjsiRElSRUNUIERFQklUClJFTk9WQVRJT04gTUFURVJJQUwiOyJFVVIiOyIyMDAuMDAiOyJTIgoiMDEvMTUvMjAxMyI7IjAxLzE1LzIwMTMiOyJKQU5FIERPRSI7IkJPT0tTVE9SRSBSRUFESk9ZIjsiOTgyMzc0OTIiOyIxMjA4MDAwMCI7IkRJUkVDVCBERUJJVApTUEVDSUFMVFkgQk9PS1MiOyJFVVIiOyI2MC4wMCI7IlMiCiIwMS8xMC8yMDEzIjsiMDEvMTAvMjAxMyI7IkNBRkUgQ09GRkVFQ0hBVCI7IkpBTkUgRE9FIjsiODI3Mzk0ODIiOyIxMjA4MDAwMCI7IkRJUkVDVCBERUJJVApCUkVBS0ZBU1QgTUVFVElORyI7IkVVUiI7IjE1LjkwIjsiUyIKIjAxLzA1LzIwMTMiOyIwMS8wNS8yMDEzIjsiSkFORSBET0UiOyJJTlRFUk5FVCBQUk9WSURFUiBTUEVFRFkiOyI4NDczMjg5NCI7IjEyMDgwMDAwIjsiRElSRUNUIERFQklUCklOVEVSTkVUIEZFRVMgSkFOIjsiRVVSIjsiMjkuOTUiOyJTIgoiMDEvMDIvMjAxMyI7IjAxLzAxLzIwMTMiOzs7OzsiU1RBVEVNRU5UCgpTVEFURU1FTlQgQVMgT0YgMTIvMzEvMjAxMiI7IkVVUiI7IjEuNTAiOyJIIgoKCiIxMi8wNC8yMDEyIjs7Ozs7OyJFVVIiOyJPcGVuaW5nIEJhbGFuY2UiOyIxLDQxOC45MyI7IkgiCg==","name":"bank-extract.csv","options":{"type":"text/csv","lastModified":1712397176186}}}}}},{"id":5,"name":"bankExportContent","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"= bankExportFile.text()","note":{"type":"expr","code":" bankExportFile.text()"}}},{"id":6,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"","note":{"type":"text","tag":"p","text":""}}},{"id":7,"name":"bankExportParsed","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"= libs.papaparse.parse(bankExportContent)","note":{"type":"expr","code":" libs.papaparse.parse(bankExportContent)"}}},{"id":8,"name":"","visibility":"result","width":"full","state":{"t":"resheet.note","v":1,"level":0,"input":"= <reactInspector.TableInspector data={bankExportParsed.data} />","note":{"type":"expr","code":" <reactInspector.TableInspector data={bankExportParsed.data} />"}}},{"id":9,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"","note":{"type":"text","tag":"p","text":""}}},{"id":17,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"","note":{"type":"text","tag":"p","text":""}}},{"id":18,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"","note":{"type":"text","tag":"p","text":""}}},{"id":16,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"## Convert and Process Data","note":{"type":"text","tag":"h2","text":"Convert and Process Data"}}},{"id":38,"name":"balanceStart","visibility":"result","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"= Number.parseFloat(\n    bankExportParsed.data.slice(-2)[0][8].replace(',','')\n  )","note":{"type":"expr","code":" Number.parseFloat(\n    bankExportParsed.data.slice(-2)[0][8].replace(',','')\n  )"}}},{"id":10,"name":"transactionsCSV","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"= bankExportParsed.data.slice(13, -4)","note":{"type":"expr","code":" bankExportParsed.data.slice(13, -4)"}}},{"id":36,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"","note":{"type":"text","tag":"p","text":""}}},{"id":37,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"","note":{"type":"text","tag":"p","text":""}}},{"id":13,"name":"transactions","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"/Code","note":{"type":"block","isInstantiated":true,"code":"Code","state":"lodash(transactionsCSV)\n  .map(\n    ([date,, payerPayee, recipientObligor, account, bankCode, purpose, currency, turnoverStr, creditDebit]) => {\n      const turnoverNum = Number.parseFloat(turnoverStr)\n      return {\n        date: libs.datefns.parse(date, 'LL/dd/uuuu', new Date()),\n        payerPayee,\n        recipientObligor,\n        purpose,\n        turnover: creditDebit === 'S' ? -turnoverNum : turnoverNum,\n        currency,\n        account,\n        bankCode,\n      }\n    }\n  )\n  .sortBy('date')\n  .value()"}}},{"id":11,"name":"","visibility":"result","width":"full","state":{"t":"resheet.note","v":1,"level":0,"input":"= <reactInspector.TableInspector data={transactions} />","note":{"type":"expr","code":" <reactInspector.TableInspector data={transactions} />"}}},{"id":34,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"","note":{"type":"text","tag":"p","text":""}}},{"id":35,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"","note":{"type":"text","tag":"p","text":""}}},{"id":30,"name":"turnoverByMonth","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"/Code","note":{"type":"block","isInstantiated":true,"code":"Code","state":"lodash.chain(transactions)\n  .map(transaction => ({\n    ...transaction,\n    month: libs.datefns.format(transaction.date, \"MMM yyyy\"),\n  }))\n  .groupBy('month')\n  .mapValues(month =>\n    lodash.chain(month)\n      .groupBy(transaction =>\n        transaction.turnover < 0 ? \"expense\" : \"income\"\n      )\n      .mapValues(transactions =>\n        lodash.sumBy(transactions, 'turnover')\n      )\n      .value()\n  )\n  .map((turnover, month) => ({ month, ...turnover }))\n  .value()"}}},{"id":33,"name":"","visibility":"result","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"= <reactInspector.TableInspector data={turnoverByMonth} />","note":{"type":"expr","code":" <reactInspector.TableInspector data={turnoverByMonth} />"}}},{"id":19,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"","note":{"type":"text","tag":"p","text":""}}},{"id":20,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"","note":{"type":"text","tag":"p","text":""}}},{"id":21,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"## Graphs","note":{"type":"text","tag":"h2","text":"Graphs"}}},{"id":23,"name":"fmtEur","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"= Intl.NumberFormat('en', { style: 'currency', currency: 'EUR' })","note":{"type":"expr","code":" Intl.NumberFormat('en', { style: 'currency', currency: 'EUR' })"}}},{"id":47,"name":"formatEuro","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"= num => fmtEur.format(num)","note":{"type":"expr","code":" num => fmtEur.format(num)"}}},{"id":24,"name":"fmtDate","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"= Intl.DateTimeFormat('en', { dateStyle: 'short' })","note":{"type":"expr","code":" Intl.DateTimeFormat('en', { dateStyle: 'short' })"}}},{"id":48,"name":"formatDate","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"= date => fmtDate.format(date)","note":{"type":"expr","code":" date => fmtDate.format(date)"}}},{"id":26,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"","note":{"type":"text","tag":"p","text":""}}},{"id":31,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"### Turnover by Month","note":{"type":"text","tag":"h3","text":"Turnover by Month"}}},{"id":32,"name":"turnoverChart","visibility":"result","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"/Code","note":{"type":"block","isInstantiated":true,"code":"Code","state":"const { ResponsiveContainer, BarChart, Bar, CartesianGrid, XAxis, YAxis, Tooltip } = libs.recharts;\n\n<ResponsiveContainer height={300}>\n  <BarChart data={turnoverByMonth}>\n    <Tooltip formatter={formatEuro} />\n    <CartesianGrid stroke=\"#eee\" strokeDasharray=\"5 5\"/>\n    <XAxis dataKey=\"month\" />\n    <YAxis tickFormatter={formatEuro} width={80} />\n    <Bar type=\"monotone\" dataKey=\"income\" fill=\"#93bc60\" />\n    <Bar type=\"monotone\" dataKey=\"expense\" fill=\"red\" />\n  </BarChart>\n</ResponsiveContainer>"}}},{"id":29,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"### Transactions","note":{"type":"text","tag":"h3","text":"Transactions"}}},{"id":22,"name":"transactionsChart","visibility":"result","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"/Code","note":{"type":"block","isInstantiated":true,"code":"Code","state":"const { ResponsiveContainer, BarChart, Bar, CartesianGrid, XAxis, YAxis, Tooltip } = libs.recharts;\n\n<ResponsiveContainer height={300}>\n  <BarChart data={transactions}>\n    <Tooltip formatter={formatEuro} labelFormatter={formatDate} />\n    <CartesianGrid stroke=\"#eee\" strokeDasharray=\"5 5\"/>\n    <XAxis dataKey=\"date\" tickFormatter={formatDate} />\n    <YAxis tickFormatter={formatEuro} width={80} />\n    <Bar type=\"monotone\" dataKey=\"turnover\" fill=\"#93bc60\" />\n  </BarChart>\n</ResponsiveContainer>"}}},{"id":28,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"### Account Balance","note":{"type":"text","tag":"h3","text":"Account Balance"}}},{"id":40,"name":"balances","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"= utils.scan( // scan is like reduce, but returns an array of every step\n  lodash.map(transactions, 'turnover'),\n  balanceStart,\n  lodash.add,\n)","note":{"type":"expr","code":" utils.scan( // scan is like reduce, but returns an array of every step\n  lodash.map(transactions, 'turnover'),\n  balanceStart,\n  lodash.add,\n)"}}},{"id":41,"name":"transactionsWithBalance","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"= utils.addColumn(transactions, 'balance', balances)","note":{"type":"expr","code":" utils.addColumn(transactions, 'balance', balances)"}}},{"id":42,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"","note":{"type":"text","tag":"p","text":""}}},{"id":25,"name":"accountBalanceChart","visibility":"result","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"/Code","note":{"type":"block","isInstantiated":true,"code":"Code","state":"const { ResponsiveContainer, LineChart, Line, XAxis, YAxis, CartesianGrid, Tooltip } = libs.recharts;\n\nconst xScaleArgs = utils.timeScaleArgs(transactionsWithBalance, \"date\");\n\n<ResponsiveContainer height={300}>\n  <LineChart data={transactionsWithBalance}>\n    <Tooltip formatter={formatEuro} labelFormatter={formatDate}/>\n    <CartesianGrid stroke=\"#eee\" strokeDasharray=\"5 5\"/>\n    <Line type=\"stepAfter\" dataKey=\"balance\" fill=\"#93bc60\" />\n    <XAxis {...xScaleArgs} tickFormatter={formatDate} />\n    <YAxis tickFormatter={formatEuro} width={80} />\n  </LineChart>\n</ResponsiveContainer>"}}},{"id":43,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"","note":{"type":"text","tag":"p","text":""}}},{"id":44,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"","note":{"type":"text","tag":"p","text":""}}},{"id":46,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"## Preview","note":{"type":"text","tag":"h2","text":"Preview"}}},{"id":45,"name":"preview","visibility":"result","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"/Code","note":{"type":"block","isInstantiated":true,"code":"Code","state":"<div>\n<h3 className=\"text-xl mt-4 mb-2\">Turnover by Month</h3>\n{turnoverChart}\n\n<h3 className=\"text-xl mt-4 mb-2\">Transactions</h3>\n{transactionsChart}\n\n<h3 className=\"text-xl mt-4 mb-2\">Account Balance</h3>\n{accountBalanceChart}\n</div>"}}}]}},"isCollapsed":true,"children":[{"id":0,"name":"libs","state":{"t":"resheet.selector","v":0,"mode":"run","expr":"SheetOf(Note)","inner":{"t":"resheet.sheet","v":2,"lines":[{"id":1,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"/Code","note":{"type":"block","isInstantiated":true,"code":"Code","state":"function esmsh(lib) {\n  return import(`https://esm.sh/${lib}?external=react`)\n}\n\nasync function esmshDefault(lib) {\n  return (await esmsh(lib)).default\n}\n\nasync function awaitValues(obj) {\n  return (\n    lodash.zipObject(\n      Object.keys(obj),\n      await Promise.all(Object.values(obj)),\n    )\n  )\n}\n\nawaitValues({\n  papaparse: esmshDefault('papaparse'),\n  datefns: esmsh('date-fns'),\n  numeral: esmshDefault('numeral'),\n  \n  recharts: esmsh('recharts'),\n  d3Scale: esmsh('d3-scale'),\n})"}}}]}},"isCollapsed":true,"children":[]},{"id":2,"name":"utils","state":{"t":"resheet.selector","v":0,"mode":"run","expr":"SheetOf(Note)","inner":{"t":"resheet.sheet","v":2,"lines":[{"id":0,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"/Code","note":{"type":"block","isInstantiated":true,"code":"Code","state":"function scan(array, init, fn) {\n  const steps = []\n  array.reduce(\n    (acc, item) => {\n      const newAcc = fn(acc, item)\n      steps.push(newAcc)\n      return newAcc\n    },\n    init,\n  )\n  return steps\n}\n\nfunction addColumn(table, colName, colValues) {\n  return lodash.zipWith(\n    table,\n    colValues,\n    (row, col) => ({ ...row, [colName]: col }),\n  )\n}\n\nfunction timeScaleArgs(data, dataKey) {\n  const timeValues = data.map(row => row[dataKey].valueOf());\n  const scale = (\n    libs.d3Scale.scaleTime()\n      .domain([\n        Math.min(...timeValues),\n        Math.max(...timeValues),\n      ])\n  )\n  \n  return {\n    domain: scale.domain().map(date => date.valueOf()),\n    scale,\n    type: 'number',\n    ticks: scale.ticks(5).map(date => date.valueOf()),\n    data,\n    dataKey,\n  }\n}\n\n({\n  scan,\n  addColumn,\n  timeScaleArgs,\n})"}}}]}},"isCollapsed":true,"children":[]}]},{"id":3,"name":"Invoice","state":{"t":"resheet.selector","v":0,"mode":"run","expr":"SheetOf(Note)","inner":{"t":"resheet.sheet","v":2,"lines":[{"id":43,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"# Invoice","note":{"type":"text","tag":"h1","text":"Invoice"}}},{"id":44,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"Load a working hours export (from atWork) and generate an invoice.","note":{"type":"text","tag":"p","text":"Load a working hours export (from atWork) and generate an invoice."}}},{"id":3,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"","note":{"type":"text","tag":"p","text":""}}},{"id":15,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"## Load and Parse CSV","note":{"type":"text","tag":"h2","text":"Load and Parse CSV"}}},{"id":4,"name":"atWorkExportFile","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"/LoadFile","note":{"type":"block","isInstantiated":true,"code":"LoadFile","state":{"state":"loaded","file":{"content":"RWludHLDpGdlOzs7CkJlZ2lubjtFbmRlO1BhdXNlO0RhdWVyCjA0LjEyLjIwMjMgMDk6MjY7MDQuMTIuMjAyMyAxNTowOTsiMSwxODMiOyI0LDUzMyIKMDUuMTIuMjAyMyAwOTo1MzswNS4xMi4yMDIzIDIwOjE2OyIzLDAzMyI7IjcsMzUiCjA2LjEyLjIwMjMgMTQ6NTY7MDYuMTIuMjAyMyAyMjozMzsiMCw5NjciOyI2LDY1IgowOC4xMi4yMDIzIDEyOjA2OzA4LjEyLjIwMjMgMjE6MDA7IjEsNzUiOyI3LDE1IgoxMi4xMi4yMDIzIDEwOjI2OzEyLjEyLjIwMjMgMTE6MzE7OyIxLDA4MyIKMTMuMTIuMjAyMyAwOTo0NDsxMy4xMi4yMDIzIDEyOjU0OyIwLDUiOyIyLDY2NyIKMTMuMTIuMjAyMyAyMDo0NTsxMy4xMi4yMDIzIDIyOjE1OzsiMSw1IgoxNC4xMi4yMDIzIDE2OjM4OzE0LjEyLjIwMjMgMTc6MDU7OyIwLDQ1IgoxNS4xMi4yMDIzIDEyOjMwOzE1LjEyLjIwMjMgMTg6NDU7IjAsNzY3IjsiNSw0ODMiCjE4LjEyLjIwMjMgMDg6Mjc7MTguMTIuMjAyMyAxMjoyNjs7IjMsOTgzIgoxOS4xMi4yMDIzIDE0OjQwOzE5LjEyLjIwMjMgMTg6MTg7OyIzLDYzMyIKMjAuMTIuMjAyMyAwODozNDsyMC4xMi4yMDIzIDE0OjM0OyIwLDQ4MyI7IjUsNTE3IgoyMS4xMi4yMDIzIDE1OjMwOzIxLjEyLjIwMjMgMjM6MDY7MjsiNSw2Igo7OzsK","name":"numbers-export-atwork-2024-04-03-12_21_50.csv","options":{"type":"text/csv","lastModified":1712139710000}}}}}},{"id":7,"name":"atWorkExportParsed","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"= libs.papaparse.parse(await atWorkExportFile.text())","note":{"type":"expr","code":" libs.papaparse.parse(await atWorkExportFile.text())"}}},{"id":8,"name":"","visibility":"result","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"= <reactInspector.TableInspector data={atWorkExportParsed.data} />","note":{"type":"expr","code":" <reactInspector.TableInspector data={atWorkExportParsed.data} />"}}},{"id":9,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"","note":{"type":"text","tag":"p","text":""}}},{"id":17,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"","note":{"type":"text","tag":"p","text":""}}},{"id":18,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"","note":{"type":"text","tag":"p","text":""}}},{"id":16,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"## Convert and Process Data","note":{"type":"text","tag":"h2","text":"Convert and Process Data"}}},{"id":10,"name":"entriesRaw","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"= atWorkExportParsed.data.slice(2, -2)","note":{"type":"expr","code":" atWorkExportParsed.data.slice(2, -2)"}}},{"id":45,"name":"","visibility":"result","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"= <reactInspector.TableInspector data={entriesRaw} />","note":{"type":"expr","code":" <reactInspector.TableInspector data={entriesRaw} />"}}},{"id":36,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"","note":{"type":"text","tag":"p","text":""}}},{"id":37,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"","note":{"type":"text","tag":"p","text":""}}},{"id":13,"name":"workingIntervals","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"/Code","note":{"type":"block","isInstantiated":true,"code":"Code","state":"const parseDate = utils.localized.de.dateParser({ date: 'medium' })\nconst parseTime = utils.localized.de.dateParser({ time: 'short' })\n\nfunction parseDatetime(str) {\n  const [dateStr, timeStr] = str.split(' ')\n  const date = parseDate(dateStr)\n  const time = parseTime(timeStr)\n  return utils.combineDateTime(date, time)\n}\n\nconst parseNumber = utils.localized.de.numberParser()\n\nentriesRaw\n  .map(\n    ([start, end, pause, duration]) => {\n      const turnoverNum = utils.cldr\n      return {\n        start: parseDatetime(start),\n        end: parseDatetime(end),\n        pauseHours: pause ? parseNumber(pause) : 0,\n        workingHours: parseNumber(duration),\n      }\n    }\n  )"}}},{"id":11,"name":"","visibility":"result","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"= <reactInspector.TableInspector data={workingIntervals} />","note":{"type":"expr","code":" <reactInspector.TableInspector data={workingIntervals} />"}}},{"id":34,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"","note":{"type":"text","tag":"p","text":""}}},{"id":35,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"","note":{"type":"text","tag":"p","text":""}}},{"id":30,"name":"workingHoursBy","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"/Code","note":{"type":"block","isInstantiated":true,"code":"Code","state":"function workingHoursBy(dateGroup) {\n  return lodash.chain(workingIntervals)\n    .map(workingInterval => ({\n      ...workingInterval,\n      timestamp: dateGroup(workingInterval).getTime(),\n    }))\n    .groupBy('timestamp')\n    .mapValues(group => ({\n      workingHours: lodash.sumBy(group, 'workingHours'),\n      pauseHours: lodash.sumBy(group, 'pauseHours'),\n    }))\n    .map((workingInterval, timestamp) => ({\n      date: new Date(Number(timestamp)),\n      ...workingInterval,\n    }))\n    .value()\n}"}}},{"id":48,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"","note":{"type":"text","tag":"p","text":""}}},{"id":19,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"","note":{"type":"text","tag":"p","text":""}}},{"id":20,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"","note":{"type":"text","tag":"p","text":""}}},{"id":21,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"## Graphs","note":{"type":"text","tag":"h2","text":"Graphs"}}},{"id":23,"name":"formatDuration","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"= duration => `${Math.trunc(duration)}:${String(Math.round(duration * 60 % 60)).padStart(2, '0')}`","note":{"type":"expr","code":" duration => `${Math.trunc(duration)}:${String(Math.round(duration * 60 % 60)).padStart(2, '0')}`"}}},{"id":26,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"","note":{"type":"text","tag":"p","text":""}}},{"id":31,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"### Working Hours by Day","note":{"type":"text","tag":"h3","text":"Working Hours by Day"}}},{"id":49,"name":"formatDateDay","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"= date => libs.datefns.format(date, \"dd.LL.uu\")","note":{"type":"expr","code":" date => libs.datefns.format(date, \"dd.LL.uu\")"}}},{"id":50,"name":"workingHoursByDay","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"= workingHoursBy(({ start }) => libs.datefns.startOfDay(start))","note":{"type":"expr","code":" workingHoursBy(({ start }) => libs.datefns.startOfDay(start))"}}},{"id":32,"name":"workingHoursByDayChart","visibility":"result","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"/Code","note":{"type":"block","isInstantiated":true,"code":"Code","state":"const { ResponsiveContainer, BarChart, Bar, XAxis, YAxis, Tooltip } = libs.recharts;\n\n<ResponsiveContainer height={300}>\n  <BarChart data={workingHoursByDay}>\n    <Tooltip formatter={formatDuration} labelFormatter={formatDateDay} />\n    <Bar type=\"monotone\" dataKey=\"workingHours\" stackId=\"\" fill=\"#93bc60\" />\n    <Bar type=\"monotone\" dataKey=\"pauseHours\" stackId=\"\" fill=\"orange\" />\n    <XAxis dataKey=\"date\" tickFormatter={formatDateDay} />\n    <YAxis tickFormatter={formatDuration} width={80} />\n  </BarChart>\n</ResponsiveContainer>"}}},{"id":51,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"### Working Hours by Month","note":{"type":"text","tag":"h3","text":"Working Hours by Month"}}},{"id":52,"name":"formatDateMonth","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"= date => libs.datefns.format(date, \"LLL uu\")","note":{"type":"expr","code":" date => libs.datefns.format(date, \"LLL uu\")"}}},{"id":53,"name":"workingHoursByMonth","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"= workingHoursBy(({ start }) => libs.datefns.startOfMonth(start))","note":{"type":"expr","code":" workingHoursBy(({ start }) => libs.datefns.startOfMonth(start))"}}},{"id":54,"name":"","visibility":"result","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"/Code","note":{"type":"block","isInstantiated":true,"code":"Code","state":"const { ResponsiveContainer, BarChart, Bar, XAxis, YAxis, Tooltip } = libs.recharts;\n\n<ResponsiveContainer height={300}>\n  <BarChart data={workingHoursByMonth}>\n    <Tooltip formatter={formatDuration} labelFormatter={formatDateMonth} />\n    <Bar type=\"monotone\" dataKey=\"workingHours\" stackId=\"\" fill=\"#93bc60\" />\n    <XAxis dataKey=\"date\" tickFormatter={formatDateMonth} />\n    <YAxis tickFormatter={formatDuration} width={80} />\n  </BarChart>\n</ResponsiveContainer>"}}},{"id":55,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"","note":{"type":"text","tag":"p","text":""}}},{"id":56,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"## Invoice","note":{"type":"text","tag":"h2","text":"Invoice"}}},{"id":58,"name":"hourlyWage","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"= 75","note":{"type":"expr","code":" 75"}}},{"id":73,"name":"taxRate","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"= 0.19","note":{"type":"expr","code":" 0.19"}}},{"id":74,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"","note":{"type":"text","tag":"p","text":""}}},{"id":59,"name":"invoiceData","visibility":"result","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"/blocks.JSExpr","note":{"type":"block","isInstantiated":true,"code":"blocks.JSExpr","state":"workingHoursByDay\n  .map(entry => ({\n    ...entry,\n    workingHoursRound: utils.roundOn(entry.workingHours, 0.25),\n  }))\n  .map(entry => ({\n    ...entry,\n    price: utils.roundOn(entry.workingHoursRound * hourlyWage, 0.01),\n  }))"}}},{"id":75,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"","note":{"type":"text","tag":"p","text":""}}},{"id":62,"name":"invoiceSum","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"= lodash.sumBy(invoiceData, 'price')","note":{"type":"expr","code":" lodash.sumBy(invoiceData, 'price')"}}},{"id":63,"name":"invoiceTaxes","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"= utils.roundOn(invoiceSum * taxRate, 0.01)","note":{"type":"expr","code":" utils.roundOn(invoiceSum * taxRate, 0.01)"}}},{"id":64,"name":"invoiceTotal","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"= utils.roundOn(invoiceSum + invoiceTaxes, 0.01)","note":{"type":"expr","code":" utils.roundOn(invoiceSum + invoiceTaxes, 0.01)"}}},{"id":70,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"","note":{"type":"text","tag":"p","text":""}}},{"id":71,"name":"locale","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"= \"en\"","note":{"type":"expr","code":" \"en\""}}},{"id":72,"name":"currency","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"= \"USD\"","note":{"type":"expr","code":" \"USD\""}}},{"id":76,"name":"fmt","visibility":"result","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"/blocks.JSExpr","note":{"type":"block","isInstantiated":true,"code":"blocks.JSExpr","state":"({\n  currency: Intl.NumberFormat(locale, {\n    style: 'currency',\n    currency,\n  }),\n  date: Intl.DateTimeFormat(locale, {\n    dateStyle: 'short',\n  }), \n  percent: Intl.NumberFormat(locale, {\n    style: 'percent',\n  }),\n})"}}},{"id":77,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"","note":{"type":"text","tag":"p","text":""}}},{"id":57,"name":"invoiceTable","visibility":"result","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"/Code","note":{"type":"block","isInstantiated":true,"code":"Code","state":"<table className=\"w-full\">\n  <thead className=\"font-bold bg-sky-100\">\n    <tr>\n      <th className=\"p-2 text-left\">Project</th>\n      <th className=\"p-2 text-center w-28\">Date</th>\n      <th className=\"p-2 text-right w-40\">Working Hours</th>\n      <th className=\"p-2 text-right w-28\">Price</th>\n    </tr>\n  </thead>\n  \n  {/*\n    \"Padding\" at the table bottom, so the content doesn't hide\n    below the footer when printing.\n  */}\n  <tfoot className=\"hidden print:table-footer-group\">\n    <tr className=\"h-28\"><td/></tr>\n  </tfoot>\n\n  <tbody>\n    {invoiceData.map(({ date, workingHoursRound, price }) => (\n      <tr className=\"even:bg-slate-100\">\n        <td className=\"px-2 py-1.5\">\n          BuildTheFuture\n        </td>\n        <td className=\"px-2 py-1.5 text-center\">\n          {fmt.date.format(date)}\n        </td>\n        <td className=\"px-2 py-1.5 text-right\">\n          {formatDuration(workingHoursRound)} h\n        </td>\n        <td className=\"px-2 py-1.5 text-right\">\n          {fmt.currency.format(price)}\n        </td>\n      </tr>\n    ))}\n    \n    {/*\n      Footer not in <tfoot> because otherwise\n      it get's repeated on every printed page\n    */}\n    <tr className=\"font-medium bg-sky-100 border-t-2 border-white break-before-avoid-page\">\n      <td colspan={3} className=\"p-2 text-right\">\n        Sum\n      </td>\n      <td className=\"p-2 text-right\">\n        {fmt.currency.format(invoiceSum)}\n      </td>\n    </tr>\n    <tr className=\"font-medium bg-sky-100 border-t-2 border-white break-before-avoid-page\">\n      <td colSpan={3} className=\"p-2 text-right\">\n        {fmt.percent.format(taxRate)} Taxes\n      </td>\n      <td className=\"p-2 text-right\">\n        {fmt.currency.format(invoiceTaxes)}\n      </td>\n    </tr>\n    <tr className=\"font-bold bg-sky-100 border-t-2 border-white break-before-avoid-page\">\n      <td colSpan={3} className=\"p-2 text-right\">\n        Total\n      </td>\n      <td className=\"p-2 text-right\">\n        {fmt.currency.format(invoiceTotal)}\n      </td>\n    </tr>\n  </tbody>\n</table>"}}},{"id":65,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"","note":{"type":"text","tag":"p","text":""}}},{"id":66,"name":"Document","visibility":"result","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"/Code","note":{"type":"block","isInstantiated":true,"code":"Code","state":"function renderDocument(content) {\n  return ReactDomServer.renderToString(\n      <html>\n        <head>\n          <style>{`\n            @page {\n              margin: 2cm 0 0 0;\n            }\n          `}</style>\n          <script src=\"https://cdn.tailwindcss.com\" />\n        </head>\n        <body className=\"bg-white\">\n          {content}\n        </body>\n      </html>\n    )\n}\n  \nfunction Document({children}) {\n  const iframeRef = React.useRef()\n  \n  function onPrintIframe() {\n    iframeRef.current?.contentWindow?.print()\n  }\n  \n  return (\n    <div className=\"flex flex-col items-stretch space-y-2\">\n      <div className=\"overflow-x-auto\">\n        <iframe\n          ref={iframeRef}\n          className=\"border min-w-[768px]\"\n          height=\"1200\"\n          srcDoc={renderDocument(children)}\n          />\n      </div>\n      <button\n        className=\"px-3 py-1 rounded bg-blue-100 hover:bg-blue-200\"\n        onClick={() => onPrintIframe()}\n      >\n        Print\n      </button>\n    </div>\n  )\n}"}}},{"id":68,"name":"invoiceDocument","visibility":"result","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"/Code","note":{"type":"block","isInstantiated":true,"code":"Code","state":"const invoiceDate = new Date();\nconst invoiceMonth = libs.datefns.formatDate(invoiceDate, \"yyyy-MM\");\nconst invoiceNo = `${invoiceMonth}-01`;\n\nconst senderName = \"Jane Doe\";\nconst senderDescription = \"PrettyGoodSolutions Consultant\";\nconst senderAddress = [\n  senderName,\n  \"Doesit Street 13\",\n  \"12345 WorksTown\",\n];\nconst senderContact = [\n  \"+00 123 456789\",\n  \"jane.doe@prettygood.solutions\",\n];\nconst senderBank = <>\n  BestBank Inc.<br/>\n  IBAN: DE42 1337 1234 7654 8989 00\n</>;\n\nconst receiverAddress = <>\n  BigCorp Inc.<br/>\n  Large Street 123<br/>\n  99999 MegaCity\n</>;\n\n\n<Document>\n  <main className=\"font-['Arial'] mx-20 mb-28\">\n  \n    {/* Header top right with name and description */}\n    <h1\n      className=\"font-bold text-4xl text-right text-sky-700 leading-normal\"\n    >\n      {senderName}\n    </h1>\n    <div className=\"text-right text-slate-800\">\n      {senderDescription}\n    </div>\n    \n    \n    <div className=\"flex my-12\">\n      {/* Adress sender and receiver left */}\n      <div className=\"flex-1 space-y-2\">\n        <address className=\"text-xs not-italic text-sky-700\">\n          {senderAddress.flatMap(field => [\"•\", field]).slice(1).join(\" \")}\n        </address>\n        <address className=\"leading-tight not-italic\">\n          {receiverAddress}\n        </address>\n      </div>\n      \n      {/* Contact details right */}\n      <address\n        className=\"leading-tight not-italic flex-end text-right text-sm\"\n      >\n        {senderAddress.flatMap(field => [field, <br/>])}\n        <br/>\n        {senderContact.flatMap(field => [field, <br/>])}\n      </address>\n    </div>\n    \n    \n    {/* Message Header */}\n    <h2 className=\"font-bold text-xl text-sky-700 leading-normal\">\n      Invoice\n    </h2>\n    <h3 className=\"flex justify-between leading-normal mt-1 mb-5\">\n      <span>InvoiceNo: {invoiceNo}</span>\n      <span>{fmt.date.format(invoiceDate)}</span>\n    </h3>\n    \n    \n    {/* Message Content */}\n    <article>\n      {invoiceTable}\n    </article>\n    \n  </main>\n  \n  {/* Footer */}\n  <footer\n    className={`\n      fixed bottom-0 h-24 w-screen px-20 py-2\n      bg-slate-600\n      font-['Arial'] text-sm text-white\n      flex flex-row justify-between items-start\n    `}\n  >\n    <div>\n      {senderDescription}<br/>\n      {senderName}\n    </div>\n    <address className=\"not-italic\">\n      {senderBank}\n    </address>\n  </footer>\n</Document>"}}},{"id":78,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"","note":{"type":"text","tag":"p","text":""}}},{"id":69,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"**Note**: When printing make sure to fiddle with the printing settings: Enable backgrounds and disable the header and footer added by the browser. Printing in Chromium-based browsers works best.","note":{"type":"text","tag":"p","text":"**Note**: When printing make sure to fiddle with the printing settings: Enable backgrounds and disable the header and footer added by the browser. Printing in Chromium-based browsers works best."}}},{"id":79,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"","note":{"type":"text","tag":"p","text":""}}},{"id":81,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"","note":{"type":"text","tag":"p","text":""}}},{"id":82,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"## Preview","note":{"type":"text","tag":"h2","text":"Preview"}}},{"id":83,"name":"preview","visibility":"result","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"/Code","note":{"type":"block","isInstantiated":true,"code":"Code","state":"<div>\n<h3 className=\"text-xl mt-4 mb-2\">atWork CSV Export</h3>\n<reactInspector.TableInspector data={entriesRaw} />\n\n<h3 className=\"text-xl mt-4 mb-2\">Working Hours</h3>\n{workingHoursByDayChart}\n\n<h3 className=\"text-xl mt-4 mb-2\">Invoice</h3>\n{invoiceDocument}\n</div>"}}}]}},"isCollapsed":true,"children":[{"id":0,"name":"libs","state":{"t":"resheet.selector","v":0,"mode":"run","expr":"SheetOf(Note)","inner":{"t":"resheet.sheet","v":2,"lines":[{"id":1,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"/Code","note":{"type":"block","isInstantiated":true,"code":"Code","state":"function esmsh(lib) {\n  return import(`https://esm.sh/${lib}?external=react`)\n}\n\nasync function esmshDefault(lib) {\n  return (await esmsh(lib)).default\n}\n\nasync function esmshJson(file) {\n  return (await fetch(`https://esm.sh/${file}`)).json()\n}\n\nasync function awaitValues(obj) {\n  return (\n    lodash.zipObject(\n      Object.keys(obj),\n      await Promise.all(Object.values(obj)),\n    )\n  )\n}\n\nawaitValues({\n  papaparse: esmshDefault('papaparse'),\n  datefns: esmsh('date-fns'),\n  numeral: esmshDefault('numeral'),\n  globalize: esmshDefault('globalize'),\n  \n  // see what's available at: https://github.com/unicode-org/cldr-json/tree/main/cldr-json\n  // see what you need at: http://johnnyreilly.github.io/globalize-so-what-cha-want/\n  cldr: Promise.all([\n    esmshJson('cldr-core/supplemental/likelySubtags.json'),\n    esmshJson('cldr-numbers-modern/main/de/numbers.json'),\n    esmshJson('cldr-core/supplemental/numberingSystems.json'),\n    esmshJson('cldr-dates-modern/main/de/ca-gregorian.json'),\n    esmshJson('cldr-dates-modern/main/de/timeZoneNames.json'),\n    esmshJson('cldr-core/supplemental/timeData.json'),\n    esmshJson('cldr-core/supplemental/weekData.json'),\n  ]),\n  \n  recharts: esmsh('recharts'),\n  d3Scale: esmsh('d3-scale'),\n})"}}}]}},"isCollapsed":true,"children":[]},{"id":2,"name":"utils","state":{"t":"resheet.selector","v":0,"mode":"run","expr":"SheetOf(Note)","inner":{"t":"resheet.sheet","v":2,"lines":[{"id":0,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"/Code","note":{"type":"block","isInstantiated":true,"code":"Code","state":"function scan(array, init, fn) {\n  const steps = []\n  array.reduce(\n    (acc, item) => {\n      const newAcc = fn(acc, item)\n      steps.push(newAcc)\n      return newAcc\n    },\n    init,\n  )\n  return steps\n}\n\nfunction addColumn(table, colName, colValues) {\n  return lodash.zipWith(\n    table,\n    colValues,\n    (row, col) => ({ ...row, [colName]: col }),\n  )\n}\n\nfunction timeScaleArgs(data, dataKey) {\n  const timeValues = data.map(row => row[dataKey].valueOf());\n  const scale = (\n    libs.d3Scale.scaleTime()\n      .domain([\n        Math.min(...timeValues),\n        Math.max(...timeValues),\n      ])\n  )\n  \n  return {\n    domain: scale.domain().map(date => date.valueOf()),\n    scale,\n    type: 'number',\n    ticks: scale.ticks(5).map(date => date.valueOf()),\n    data,\n    dataKey,\n  }\n}\n\nfunction combineDateTime(dateRef, timeRef) {\n  const date = libs.datefns.startOfDay(dateRef)\n  const timeInterval = libs.datefns.interval(\n    libs.datefns.startOfDay(timeRef),\n    timeRef,\n  )\n  return libs.datefns.add(date, libs.datefns.intervalToDuration(timeInterval))\n}\n\nfunction roundOn(num, step) {\n  if (step < 0) {\n    return Math.round(num * step) / step\n  }\n  else if (step < 1) {\n    const stepInv = 1 / step\n    const stepRound = Math.round(stepInv)\n    const stepClean = Math.abs(stepRound - stepInv) < 1e-10 ? stepRound : stepInv\n    return Math.round(num * stepClean) / stepClean\n  }\n  else {\n    return step * Math.round(num / step)\n  }\n}\n\nlibs.cldr.forEach(cldr => libs.globalize.load(cldr));\n\nreturn {\n  scan,\n  addColumn,\n  timeScaleArgs,\n  combineDateTime,\n  roundOn,\n  localized: {\n    de: libs.globalize('de'),\n  },\n}"}}}]}},"isCollapsed":true,"children":[]}]},{"id":2,"name":"Advanced Playground","state":{"t":"resheet.selector","v":0,"mode":"run","expr":"SheetOf(Note)","inner":{"t":"resheet.sheet","v":2,"lines":[{"id":1,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"# Advanced Playground","note":{"type":"text","tag":"h1","text":"Advanced Playground"}}},{"id":2,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"Create custom Blocks and use the Inspect Block to get a glimpse into ReSheet.","note":{"type":"text","tag":"p","text":"Create custom Blocks and use the Inspect Block to get a glimpse into ReSheet."}}},{"id":3,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"","note":{"type":"text","tag":"p","text":""}}},{"id":23,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"## Simple custom Blocks","note":{"type":"text","tag":"h2","text":"Simple custom Blocks"}}},{"id":7,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"Let's build a simple checkbox Block:","note":{"type":"text","tag":"p","text":"Let's build a simple checkbox Block:"}}},{"id":8,"name":"CheckBlock","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"/Code","note":{"type":"block","isInstantiated":true,"code":"Code","state":"label => SimpleBlock(false, ({ ref, state, onUpdate }) =>\n  <label>\n    <input\n      ref={ref}\n      type=\"checkbox\"\n      checked={state}\n      onChange={onUpdate('target.checked')}\n      />\n    {' '}\n    {label}\n  </label>\n)"}}},{"id":9,"name":"input","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"/CheckBlock(\"Does it work?\")","note":{"type":"block","isInstantiated":true,"code":"CheckBlock(\"Does it work?\")","state":true}}},{"id":10,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"= input","note":{"type":"expr","code":" input"}}},{"id":11,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"","note":{"type":"text","tag":"p","text":""}}},{"id":87,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"","note":{"type":"text","tag":"p","text":""}}},{"id":88,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"","note":{"type":"text","tag":"p","text":""}}},{"id":13,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"Having an editable label would be nice:","note":{"type":"text","tag":"p","text":"Having an editable label would be nice:"}}},{"id":14,"name":"CheckEditableBlock","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"/Code","note":{"type":"block","isInstantiated":true,"code":"Code","state":"SimpleBlock(\n  { checked: false, label: '' },\n  ({ ref, state, onUpdate, setState }) => (\n    <label>\n      <input\n        type=\"checkbox\"\n        checked={state.checked}\n        onChange={onUpdate('target.checked', 'checked')}\n        />\n      {' '}\n      <input\n        ref={ref}\n        type=\"text\"\n        value={state.label}\n        placeholder=\"label\"\n        onKeyDown={ev => {\n          if (ev.key === 'Enter') {\n            setState(checked => !checked, 'checked')\n          }\n        }}\n        onChange={onUpdate('target.value', 'label')}\n        />\n    </label>\n  ),\n)"}}},{"id":15,"name":"input2","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"/CheckEditableBlock","note":{"type":"block","isInstantiated":true,"code":"CheckEditableBlock","state":{"checked":true,"label":"This works too"}}}},{"id":16,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"= input2","note":{"type":"expr","code":" input2"}}},{"id":17,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"","note":{"type":"text","tag":"p","text":""}}},{"id":85,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"","note":{"type":"text","tag":"p","text":""}}},{"id":86,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"","note":{"type":"text","tag":"p","text":""}}},{"id":18,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"Build a slider Block:","note":{"type":"text","tag":"p","text":"Build a slider Block:"}}},{"id":20,"name":"SliderBlock","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"/Code","note":{"type":"block","isInstantiated":true,"code":"Code","state":"function SliderBlock(props) {\n  const rangeProps = immutable.merge({ min: 0, max: 100, step: 1 }, props)\n  return SimpleBlock(rangeProps.min ?? 0, ({ ref, state, onUpdate }) =>\n    <input\n      ref={ref}\n      type=\"range\"\n      value={state}\n      {...rangeProps}\n      onChange={onUpdate('target.value', [], Number)}\n    />\n  )\n}"}}},{"id":21,"name":"rangeInput","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"/SliderBlock()","note":{"type":"block","isInstantiated":true,"code":"SliderBlock()","state":37}}},{"id":22,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"= rangeInput","note":{"type":"expr","code":" rangeInput"}}},{"id":24,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"","note":{"type":"text","tag":"p","text":""}}},{"id":25,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"","note":{"type":"text","tag":"p","text":""}}},{"id":26,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"## Builtin Blocks","note":{"type":"text","tag":"h2","text":"Builtin Blocks"}}},{"id":33,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"We already used `Code` many times:","note":{"type":"text","tag":"p","text":"We already used `Code` many times:"}}},{"id":50,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"`/Code`","note":{"type":"text","tag":"p","text":"`/Code`"}}},{"id":34,"name":"codeResult","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"/Code","note":{"type":"block","isInstantiated":true,"code":"Code","state":"12 * 12"}}},{"id":35,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"","note":{"type":"text","tag":"p","text":""}}},{"id":82,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"","note":{"type":"text","tag":"p","text":""}}},{"id":36,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"But we can also take a peek inside with the `Inspect` Block:","note":{"type":"text","tag":"p","text":"But we can also take a peek inside with the `Inspect` Block:"}}},{"id":49,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"`/Debug.Inspect(Code)`","note":{"type":"text","tag":"p","text":"`/Debug.Inspect(Code)`"}}},{"id":37,"name":"inspectCodeResult","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"/Debug.Inspect(Code)","note":{"type":"block","isInstantiated":true,"code":"Debug.Inspect(Code)","state":"Promise.resolve(codeResult)"}}},{"id":38,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"= inspectCodeResult","note":{"type":"expr","code":" inspectCodeResult"}}},{"id":39,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"","note":{"type":"text","tag":"p","text":""}}},{"id":83,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"","note":{"type":"text","tag":"p","text":""}}},{"id":27,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"The `Note` Block, of which every line here consists:","note":{"type":"text","tag":"p","text":"The `Note` Block, of which every line here consists:"}}},{"id":48,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"`/Debug.Inspect(Note)`","note":{"type":"text","tag":"p","text":"`/Debug.Inspect(Note)`"}}},{"id":28,"name":"inspectNoteBlockResult","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"/Debug.Inspect(Note)","note":{"type":"block","isInstantiated":true,"code":"Debug.Inspect(Note)","state":{"t":"resheet.note","v":1,"level":0,"input":"= inspectCodeResult.state","note":{"type":"expr","code":" inspectCodeResult.state"}}}}},{"id":29,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"= inspectNoteBlockResult","note":{"type":"expr","code":" inspectNoteBlockResult"}}},{"id":40,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"","note":{"type":"text","tag":"p","text":""}}},{"id":84,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"","note":{"type":"text","tag":"p","text":""}}},{"id":41,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"### Higher-Order Blocks","note":{"type":"text","tag":"h3","text":"Higher-Order Blocks"}}},{"id":42,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"Higher-Order Blocks embed other Blocks inside of them:","note":{"type":"text","tag":"p","text":"Higher-Order Blocks embed other Blocks inside of them:"}}},{"id":46,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"(The `Inspect` Block was already a very simple example of a higher-order Block)","note":{"type":"text","tag":"p","text":"(The `Inspect` Block was already a very simple example of a higher-order Block)"}}},{"id":43,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"","note":{"type":"text","tag":"p","text":""}}},{"id":44,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"You already know `SheetOf`, it's the Block powering every Page, with an embedded Note:","note":{"type":"text","tag":"p","text":"You already know `SheetOf`, it's the Block powering every Page, with an embedded Note:"}}},{"id":47,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"`/Debug.Inspect(SheetOf(Note))`","note":{"type":"text","tag":"p","text":"`/Debug.Inspect(SheetOf(Note))`"}}},{"id":45,"name":"inspectSheetOfNoteBlockResult","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"/Debug.Inspect(SheetOf(Note))","note":{"type":"block","isInstantiated":true,"code":"Debug.Inspect(SheetOf(Note))","state":{"t":"resheet.sheet","v":2,"lines":[{"id":0,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"This is a line of the SheetOf Block, which contains a Note Block in which this sentence is written.","note":{"type":"text","tag":"p","text":"This is a line of the SheetOf Block, which contains a Note Block in which this sentence is written."}}},{"id":1,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"This is another line.","note":{"type":"text","tag":"p","text":"This is another line."}}},{"id":2,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"= inspectNoteBlockResult.state.note","note":{"type":"expr","code":" inspectNoteBlockResult.state.note"}}}]}}}},{"id":51,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"= inspectSheetOfNoteBlockResult.state.lines","note":{"type":"expr","code":" inspectSheetOfNoteBlockResult.state.lines"}}},{"id":52,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"","note":{"type":"text","tag":"p","text":""}}},{"id":80,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"","note":{"type":"text","tag":"p","text":""}}},{"id":81,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"","note":{"type":"text","tag":"p","text":""}}},{"id":53,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"To be more precise, these pages don't contain the `SheetOf` Block itself but a `BlockSelector` Block pre-set with `SheetOf(Note)`:","note":{"type":"text","tag":"p","text":"To be more precise, these pages don't contain the `SheetOf` Block itself but a `BlockSelector` Block pre-set with `SheetOf(Note)`:"}}},{"id":54,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"`/BlockSelector('SheetOf(Note)', SheetOf(Note))` ","note":{"type":"text","tag":"p","text":"`/BlockSelector('SheetOf(Note)', SheetOf(Note))` "}}},{"id":55,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"/BlockSelector('SheetOf(Note)', SheetOf(Note))","note":{"type":"block","isInstantiated":true,"code":"BlockSelector('SheetOf(Note)', SheetOf(Note))","state":{"t":"resheet.selector","v":0,"mode":"run","expr":"SheetOf(Note)","inner":{"t":"resheet.sheet","v":2,"lines":[{"id":0,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"The `BlockSelector` Block allows you to change the Block inside of it.","note":{"type":"text","tag":"p","text":"The `BlockSelector` Block allows you to change the Block inside of it."}}},{"id":1,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"You can use any other Block, change it at the top left.","note":{"type":"text","tag":"p","text":"You can use any other Block, change it at the top left."}}},{"id":12,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"","note":{"type":"text","tag":"p","text":""}}},{"id":2,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"Be aware:","note":{"type":"text","tag":"p","text":"Be aware:"}}},{"id":9,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":1,"input":"Changing the Block will delete this content here.","note":{"type":"text","tag":"p","text":"Changing the Block will delete this content here."}}},{"id":10,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":1,"input":"_**`C-Z`** or **`esc`** are your friends._","note":{"type":"text","tag":"p","text":"_**`C-Z`** or **`esc`** are your friends._"}}},{"id":11,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"","note":{"type":"text","tag":"p","text":""}}},{"id":3,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"Try:","note":{"type":"text","tag":"p","text":"Try:"}}},{"id":4,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":1,"input":"`Code`","note":{"type":"text","tag":"p","text":"`Code`"}}},{"id":5,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":1,"input":"`SheetOf(Code)`","note":{"type":"text","tag":"p","text":"`SheetOf(Code)`"}}},{"id":6,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":1,"input":"`SheetOf(CheckEditableBlock)`","note":{"type":"text","tag":"p","text":"`SheetOf(CheckEditableBlock)`"}}},{"id":7,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"","note":{"type":"text","tag":"p","text":""}}},{"id":8,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"In the subpage \"SimpleBlock\" of this page (\"Advanced Playground\") you can see an example, where the Page was changed to another Block.","note":{"type":"text","tag":"p","text":"In the subpage \"SimpleBlock\" of this page (\"Advanced Playground\") you can see an example, where the Page was changed to another Block."}}}]}}}}},{"id":56,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"","note":{"type":"text","tag":"p","text":""}}},{"id":78,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"","note":{"type":"text","tag":"p","text":""}}},{"id":79,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"","note":{"type":"text","tag":"p","text":""}}},{"id":101,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"## Custom Higher-Order Block","note":{"type":"text","tag":"h2","text":"Custom Higher-Order Block"}}},{"id":102,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"Building a higher-order Block is more involved, as you have to integrate with the embedded Blocks' calculations.","note":{"type":"text","tag":"p","text":"Building a higher-order Block is more involved, as you have to integrate with the embedded Blocks' calculations."}}},{"id":103,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"Let's build an HStack Block where you can put multiple Blocks in a row. As a simplification, these Blocks won't be able to access each other's values.","note":{"type":"text","tag":"p","text":"Let's build an HStack Block where you can put multiple Blocks in a row. As a simplification, these Blocks won't be able to access each other's values."}}},{"id":104,"name":"HStack","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"/Code","note":{"type":"block","isInstantiated":true,"code":"Code","state":"function HStack(...subblocks) {\n  // wrap the subblocks with some safeguards\n  const safeblocks = subblocks.map(resheet.blocks.component.safeBlock)\n  \n  return SimpleBlock(\n    safeblocks.map(block => block.init),\n    \n    ({ state, fieldDispatcher, env }) => (\n      <div className=\"flex flex-row space-x-2\">\n        {safeblocks.map((block, index) => (\n          <div className=\"overflow-x-auto flex-[1_0_0%]\">\n            <block.Component\n              key={index}\n              state={state[index]}\n              dispatch={fieldDispatcher(index)}\n              env={env}\n              />\n          </div>\n        ))}\n      </div>\n    ),\n    \n    {\n      // What is the value of this Block?\n      // @returns an Array of the subblocks' values\n      getResult(state) {\n        return safeblocks.map((block, index) =>\n          block.getResult(state[index])\n        )\n      },\n      \n      // Load a state from json\n      // dispatch and env are needed, because to load some json one\n      // probably has to evaluate the code already. For example when\n      // we will use this Block and load its saved state from a file,\n      // first this definition of the Block has to be evaluated and\n      // then we can use the following fromJSON function to continue\n      // loading the state.\n      // @returns the loaded state\n      fromJSON(json, dispatch, env) {\n        return safeblocks.map((block, index) =>\n          block.fromJSON(\n            json[index],\n            resheet.util.dispatch.fieldDispatcher(index, dispatch),\n            env,\n          )\n        )\n      },\n      \n      // Converts a state to a JSON-serializable value.\n      // @returns a value that can be stringified (NOT an already\n      //          stringified JSON string!)\n      toJSON(state) {\n        return safeblocks.map((block, index) =>\n          block.toJSON(state[index])\n        )\n      },\n      \n      // Reevaluate the computations inside because some variables\n      // given in the Set<string> changedVars changed.\n      // @returns {\n      //            state: /* the new state */,\n      //            invalidated: /* true, if our value changed and\n      //                          * therefore our dependants have\n      //                          * to be recomputed\n      //                          */,\n      //          }\n      recompute(state, dispatch, env, changedVars) {\n        const recomputations = (\n          safeblocks.map((block, index) =>\n            block.recompute(\n              state[index],\n              resheet.util.dispatch.fieldDispatcher(index, dispatch),\n              env,\n              changedVars,\n            )\n          )\n        )\n        \n        const newStates = recomputations.map(recomp => recomp.state)\n        const invalidated = recomputations.some(recomp => recomp.invalidated)\n        return {\n          state: newStates,\n          invalidated,\n        }\n      },\n    },\n  )\n}"}}},{"id":107,"name":"","visibility":"block","width":"wide","state":{"t":"resheet.note","v":1,"level":0,"input":"`/Debug.Inspect(HStack(SheetOf(Note), Code))`","note":{"type":"text","tag":"p","text":"`/Debug.Inspect(HStack(SheetOf(Note), Code))`"}}},{"id":105,"name":"inspectHStack","visibility":"block","width":"wide","state":{"t":"resheet.note","v":1,"level":0,"input":"/Debug.Inspect(HStack(SheetOf(Note), Code))","note":{"type":"block","isInstantiated":true,"code":"Debug.Inspect(HStack(SheetOf(Note), Code))","state":[{"t":"resheet.sheet","v":2,"lines":[{"id":0,"name":"","visibility":"block","width":"wide","state":{"t":"resheet.note","v":1,"level":0,"input":"Now we can put some stuff side-by-side","note":{"type":"text","tag":"p","text":"Now we can put some stuff side-by-side"}}},{"id":1,"name":"","visibility":"block","width":"wide","state":{"t":"resheet.note","v":1,"level":0,"input":"As we haven't implemented any keybindings we have to click to navigate between the columns","note":{"type":"text","tag":"p","text":"As we haven't implemented any keybindings we have to click to navigate between the columns"}}}]},"const block = HStack(SheetOf(Note), Code)\nblock.toJSON(block.init)"]}}},{"id":106,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"= inspectHStack.state","note":{"type":"expr","code":" inspectHStack.state"}}},{"id":108,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"","note":{"type":"text","tag":"p","text":""}}},{"id":109,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"","note":{"type":"text","tag":"p","text":""}}},{"id":110,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"","note":{"type":"text","tag":"p","text":""}}},{"id":57,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"### Grand Finale","note":{"type":"text","tag":"h3","text":"Grand Finale"}}},{"id":58,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"As the Grand Finale, we're going to embed a whole ReSheet instance:","note":{"type":"text","tag":"p","text":"As the Grand Finale, we're going to embed a whole ReSheet instance:"}}},{"id":59,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"`/Debug.Inspect(DocumentOf(Code))`","note":{"type":"text","tag":"p","text":"`/Debug.Inspect(DocumentOf(Code))`"}}},{"id":95,"name":"inspectReSheetSimple","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"/Debug.Inspect(DocumentOf(Code))","note":{"type":"block","isInstantiated":true,"code":"Debug.Inspect(DocumentOf(Code))","state":{"history":[],"inner":{"t":"resheet.document","v":1,"pages":[{"id":0,"name":"","state":"// This is a simplified version. But we already know how to embed the full version:\n\nblocks.DocumentOf(\n  blocks.BlockSelector(\n    'SheetOf(Note)',\n    blocks.SheetOf(blocks.Note),\n    blocks,\n  )\n)\n\n// Now is only left to inspect the state of this whole document below.","isCollapsed":true,"children":[]}],"viewState":{"sidebarOpen":true,"openPage":[0]},"template":{"id":-1,"name":"","state":"","isCollapsed":true,"children":[]}}}}}},{"id":61,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"= inspectReSheetSimple.state","note":{"type":"expr","code":" inspectReSheetSimple.state"}}},{"id":62,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"","note":{"type":"text","tag":"p","text":""}}},{"id":63,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"","note":{"type":"text","tag":"p","text":""}}},{"id":89,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"","note":{"type":"text","tag":"p","text":""}}},{"id":90,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"#### Full ReSheet Version","note":{"type":"text","tag":"h4","text":"Full ReSheet Version"}}},{"id":64,"name":"DefaultPageBlock","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"= BlockSelector('SheetOf(Note)', SheetOf(Note))","note":{"type":"expr","code":" BlockSelector('SheetOf(Note)', SheetOf(Note))"}}},{"id":65,"name":"ReSheet","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"= DocumentOf(DefaultPageBlock)","note":{"type":"expr","code":" DocumentOf(DefaultPageBlock)"}}},{"id":66,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"","note":{"type":"text","tag":"p","text":""}}},{"id":67,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"Here is the full ReSheet version. Try to save the big ReSheet document and load it inside this small instance:","note":{"type":"text","tag":"p","text":"Here is the full ReSheet version. Try to save the big ReSheet document and load it inside this small instance:"}}},{"id":91,"name":"","visibility":"block","width":"wide","state":{"t":"resheet.note","v":1,"level":0,"input":"`/Debug.Inspect(ReSheet)`","note":{"type":"text","tag":"p","text":"`/Debug.Inspect(ReSheet)`"}}},{"id":96,"name":"inspectReSheet","visibility":"block","width":"wide","state":{"t":"resheet.note","v":1,"level":0,"input":"/Debug.Inspect(ReSheet)","note":{"type":"block","isInstantiated":true,"code":"Debug.Inspect(ReSheet)","state":{"history":[],"inner":{"t":"resheet.document","v":1,"pages":[],"viewState":{"sidebarOpen":true,"openPage":[]},"template":{"id":-1,"name":"","state":{"t":"resheet.selector","v":0,"mode":"run","expr":"SheetOf(Note)","inner":{"t":"resheet.sheet","v":2,"lines":[]}},"isCollapsed":true,"children":[]}}}}}},{"id":69,"name":"","visibility":"block","width":"wide","state":{"t":"resheet.note","v":1,"level":0,"input":"= inspectReSheet.state","note":{"type":"expr","code":" inspectReSheet.state"}}},{"id":70,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"","note":{"type":"text","tag":"p","text":""}}},{"id":71,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"","note":{"type":"text","tag":"p","text":""}}},{"id":72,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"That's it. ReSheet is built to be composable and extensible. Its parts can be plugged together and extended as you like.","note":{"type":"text","tag":"p","text":"That's it. ReSheet is built to be composable and extensible. Its parts can be plugged together and extended as you like."}}},{"id":73,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"","note":{"type":"text","tag":"p","text":""}}},{"id":74,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"","note":{"type":"text","tag":"p","text":""}}},{"id":75,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"","note":{"type":"text","tag":"p","text":""}}},{"id":76,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"## Preview","note":{"type":"text","tag":"h2","text":"Preview"}}},{"id":97,"name":"previewBlockTemplate","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"/Debug.Inspect(SheetOf(Note))","note":{"type":"block","isInstantiated":true,"code":"Debug.Inspect(SheetOf(Note))","state":{"t":"resheet.sheet","v":2,"lines":[{"id":1,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"### Advanced Playground Preview","note":{"type":"text","tag":"h3","text":"Advanced Playground Preview"}}},{"id":2,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"We build these custom Blocks in this Page:","note":{"type":"text","tag":"p","text":"We build these custom Blocks in this Page:"}}},{"id":3,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"","note":{"type":"text","tag":"p","text":""}}},{"id":4,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"`/CheckEditableBlock`","note":{"type":"text","tag":"p","text":"`/CheckEditableBlock`"}}},{"id":5,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"/CheckEditableBlock","note":{"type":"block","isInstantiated":true,"code":"CheckEditableBlock","state":{"checked":true,"label":"This is an editable label"}}}},{"id":6,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"","note":{"type":"text","tag":"p","text":""}}},{"id":7,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"","note":{"type":"text","tag":"p","text":""}}},{"id":8,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"`/SliderBlock()`","note":{"type":"text","tag":"p","text":"`/SliderBlock()`"}}},{"id":9,"name":"sliderBlockValue","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"/SliderBlock()","note":{"type":"block","isInstantiated":true,"code":"SliderBlock()","state":49}}},{"id":10,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"= sliderBlockValue","note":{"type":"expr","code":" sliderBlockValue"}}},{"id":11,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"","note":{"type":"text","tag":"p","text":""}}},{"id":12,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"","note":{"type":"text","tag":"p","text":""}}},{"id":13,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"And we inspect some built-in Blocks:","note":{"type":"text","tag":"p","text":"And we inspect some built-in Blocks:"}}},{"id":14,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"`/Debug.Inspect(Note)`","note":{"type":"text","tag":"p","text":"`/Debug.Inspect(Note)`"}}},{"id":15,"name":"inspectNote","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"/Debug.Inspect(Note)","note":{"type":"block","isInstantiated":true,"code":"Debug.Inspect(Note)","state":{"t":"resheet.note","v":1,"level":0,"input":"= sliderBlockValue","note":{"type":"expr","code":" sliderBlockValue"}}}}},{"id":16,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"= inspectNote.state","note":{"type":"expr","code":" inspectNote.state"}}},{"id":17,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"","note":{"type":"text","tag":"p","text":""}}},{"id":18,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"","note":{"type":"text","tag":"p","text":""}}},{"id":19,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"<span className=\"text-gray-400 text-sm\">Psst: And don't miss the Grand Finale!</span>","note":{"type":"text","tag":"p","text":"<span className=\"text-gray-400 text-sm\">Psst: And don't miss the Grand Finale!</span>"}}}]}}}},{"id":99,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"","note":{"type":"text","tag":"p","text":""}}},{"id":100,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"","note":{"type":"text","tag":"p","text":""}}},{"id":98,"name":"preview","visibility":"result","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"/Code","note":{"type":"block","isInstantiated":true,"code":"Code","state":"Util.WithEnv(\n  env => ({ ...env, CheckBlock, CheckEditableBlock, SliderBlock }),\n  previewBlockTemplate.derivedBlock,\n)"}}}]}},"isCollapsed":true,"children":[{"id":0,"name":"SimpleBlock","state":{"t":"resheet.selector","v":0,"mode":"run","expr":"Code","inner":"function update(value, path, fn) {\n  if (!path || Array.isArray(path) && path.length === 0) {\n    return fn(value)\n  }\n  else {\n    return immutable.update(value, path, fn)\n  }\n}\n\nfunction SimpleBlock(init, view, desc={}) {\n  return resheet.core.block.create({\n    init,\n    view({ state, dispatch, env }, ref) {\n      function setState(newState, path=[]) {\n        const updateState = (\n          typeof newState === 'function' ?\n            newState\n          :\n            () => newState\n        )\n        \n        dispatch(state => ({\n          state: update(state, path, updateState),\n        }))\n      }\n      \n      function onUpdate(evPath, statePath=[], processValue=lodash.identity) {\n        return ev => {\n          setState(processValue(lodash.get(ev, evPath)), statePath)\n        }\n      }\n      \n      function fieldDispatcher(field) {\n        return resheet.util.dispatch.fieldDispatcher(field, dispatch)\n      }\n      \n      return view({\n        state, dispatch, env, ref,\n        setState, onUpdate, fieldDispatcher,\n      })\n    },\n    getResult(state) { return state },\n    recompute(state) { return { state, invalidated: false } },\n    fromJSON(json) { return json ?? init },\n    toJSON(state) { return state },\n    ...desc,\n  })\n}"},"isCollapsed":false,"children":[]}]}]}],"viewState":{"sidebarOpen":true,"openPage":[0]},"template":{"id":2,"name":"","state":{"t":"resheet.selector","v":0,"mode":"run","expr":"SheetOf(Note)","inner":{"t":"resheet.sheet","v":2,"lines":[]}},"isCollapsed":false,"children":[]}}}