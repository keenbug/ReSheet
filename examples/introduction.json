{"history":[],"inner":{"t":"resheet.document","v":1,"pages":[{"id":0,"name":"Introduction","state":{"t":"resheet.selector","v":0,"mode":"run","expr":"SheetOf(Note)","inner":{"t":"resheet.sheet","v":2,"lines":[{"id":0,"name":"","visibility":"result","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"= <h1 className=\"flex space-x-2 items-baseline my-2 text-5xl\">\n    <img className=\"h-12\" src={resheet.assets.logoSvg} alt=\"ReSheet Logo\"/>\n    <span>ReSheet</span>\n    <span className=\"text-2xl\">alpha</span>\n  </h1>","note":{"type":"expr","code":" <h1 className=\"flex space-x-2 items-baseline my-2 text-5xl\">\n    <img className=\"h-12\" src={resheet.assets.logoSvg} alt=\"ReSheet Logo\"/>\n    <span>ReSheet</span>\n    <span className=\"text-2xl\">alpha</span>\n  </h1>"}}},{"id":41,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"A hackable notes-spreadsheet-hybrid for programmers.","note":{"type":"text","tag":"p","text":"A hackable notes-spreadsheet-hybrid for programmers."}}},{"id":86,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"","note":{"type":"text","tag":"p","text":""}}},{"id":87,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"ReSheet is a notepad similar to Notion. In every line you can choose to write a formula in JavaScript. Just start with a \"`=`\" like in a spreadsheet.","note":{"type":"text","tag":"p","text":"ReSheet is a notepad similar to Notion. In every line you can choose to write a formula in JavaScript. Just start with a \"`=`\" like in a spreadsheet."}}},{"id":99,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"Every line is a Block. A Block can be thought of like a cell in a spreadsheet. There are different types of Blocks you can use and you can build your own custom Blocks. See the Introduction > Blocks and Examples > \"Advanced Playground\" pages for details.","note":{"type":"text","tag":"p","text":"Every line is a Block. A Block can be thought of like a cell in a spreadsheet. There are different types of Blocks you can use and you can build your own custom Blocks. See the Introduction > Blocks and Examples > \"Advanced Playground\" pages for details."}}},{"id":100,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"","note":{"type":"text","tag":"p","text":""}}},{"id":85,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"ReSheet is heavily keyboard-focused:","note":{"type":"text","tag":"p","text":"ReSheet is heavily keyboard-focused:"}}},{"id":88,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":1,"input":"Try **⌘K/⌘⇧P** to see all commands for the currently focused block(s). (Also try **⌘?**)","note":{"type":"text","tag":"p","text":"Try **⌘K/⌘⇧P** to see all commands for the currently focused block(s). (Also try **⌘?**)"}}},{"id":89,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":1,"input":"Use the ArrowKeys or `H`/`J`/`K`/`L` and `Enter`/`Escape` to move between Blocks.","note":{"type":"text","tag":"p","text":"Use the ArrowKeys or `H`/`J`/`K`/`L` and `Enter`/`Escape` to move between Blocks."}}},{"id":90,"name":"","visibility":"result","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"= <img className=\"my-4\" alt=\"ReSheet demo animation\" src={resheet.assets.demoGif} />","note":{"type":"expr","code":" <img className=\"my-4\" alt=\"ReSheet demo animation\" src={resheet.assets.demoGif} />"}}},{"id":70,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"## Shortcuts","note":{"type":"text","tag":"h2","text":"Shortcuts"}}},{"id":76,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"*⌘ = Meta = Ctrl (can be used interchangeably, useful if the browser intercepts a variant)*","note":{"type":"text","tag":"p","text":"*⌘ = Meta = Ctrl (can be used interchangeably, useful if the browser intercepts a variant)*"}}},{"id":66,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"Command Search: **⌘K/⌘⇧P**","note":{"type":"text","tag":"p","text":"Command Search: **⌘K/⌘⇧P**"}}},{"id":67,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"Shortcut Suggestions: **⌘?**","note":{"type":"text","tag":"p","text":"Shortcut Suggestions: **⌘?**"}}},{"id":68,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"Navigation: **Arrow Keys/`HJKL`**","note":{"type":"text","tag":"p","text":"Navigation: **Arrow Keys/`HJKL`**"}}},{"id":69,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"Go in/out: **`Enter`/`Escape`**","note":{"type":"text","tag":"p","text":"Go in/out: **`Enter`/`Escape`**"}}},{"id":98,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"","note":{"type":"text","tag":"p","text":""}}},{"id":71,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"## Writing","note":{"type":"text","tag":"h2","text":"Writing"}}},{"id":72,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"Format with Markdown: `*italic* **bold** [link text](link url)` etc","note":{"type":"text","tag":"p","text":"Format with Markdown: `*italic* **bold** [link text](link url)` etc"}}},{"id":97,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"","note":{"type":"text","tag":"p","text":""}}},{"id":7,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"\"Formulas\" (JavaScript) start with `\"=\"`:","note":{"type":"text","tag":"p","text":"\"Formulas\" (JavaScript) start with `\"=\"`:"}}},{"id":82,"name":"x","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"= 12","note":{"type":"expr","code":" 12"}}},{"id":84,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"= Math.sqrt(x + x)","note":{"type":"expr","code":" Math.sqrt(x + x)"}}},{"id":80,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"**⌘`Space`** for completions","note":{"type":"text","tag":"p","text":"**⌘`Space`** for completions"}}},{"id":81,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"**⌘`D`** for docs (if available)","note":{"type":"text","tag":"p","text":"**⌘`D`** for docs (if available)"}}},{"id":91,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"","note":{"type":"text","tag":"p","text":""}}},{"id":94,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"","note":{"type":"text","tag":"p","text":""}}},{"id":95,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"---","note":{"type":"text","tag":"p","text":"---"}}},{"id":92,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"#### Notes on Privacy and Data","note":{"type":"text","tag":"h4","text":"Notes on Privacy and Data"}}},{"id":93,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"Documents in ReSheet reside 100% on your devices. They are not stored or sent anywhere on/to a server. Documents are backed up a limited time (7 days since last opening) in your browser (IndexedDB) so you don't lose them because of accidentally reloading or closing ReSheet. To persist your documents use the \"Save File\" and \"Load local File ...\" actions in the File menu.","note":{"type":"text","tag":"p","text":"Documents in ReSheet reside 100% on your devices. They are not stored or sent anywhere on/to a server. Documents are backed up a limited time (7 days since last opening) in your browser (IndexedDB) so you don't lose them because of accidentally reloading or closing ReSheet. To persist your documents use the \"Save File\" and \"Load local File ...\" actions in the File menu."}}},{"id":96,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"ReSheet collects some very basic analytics like visitor count, visit time, browser type and OS without any personally identifiable information with umami.is.","note":{"type":"text","tag":"p","text":"ReSheet collects some very basic analytics like visitor count, visit time, browser type and OS without any personally identifiable information with umami.is."}}}]}},"isCollapsed":false,"children":[{"id":0,"name":"Tips","state":{"t":"resheet.selector","v":0,"mode":"run","expr":"SheetOf(Note)","inner":{"t":"resheet.sheet","v":2,"lines":[{"id":13,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"# Tips","note":{"type":"text","tag":"h1","text":"Tips"}}},{"id":2,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"Your document is automatically backed up to IndexedDB, but gets deleted after 7 days. So don't forget to save it to a local file.","note":{"type":"text","tag":"p","text":"Your document is automatically backed up to IndexedDB, but gets deleted after 7 days. So don't forget to save it to a local file."}}},{"id":3,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"","note":{"type":"text","tag":"p","text":""}}},{"id":4,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"ReSheet gives you the full power of JavaScript and React.","note":{"type":"text","tag":"p","text":"ReSheet gives you the full power of JavaScript and React."}}},{"id":5,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"**Be aware:** You have the **power to break it** (but generally you can undo it – ⌘Z) and full responsibilty to **ensure you trust the code you run**.","note":{"type":"text","tag":"p","text":"**Be aware:** You have the **power to break it** (but generally you can undo it – ⌘Z) and full responsibilty to **ensure you trust the code you run**."}}},{"id":6,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"Also beware of side-effects in your code: Everything is automatically rerun as needed (for changes), so side-effects may execute for every character you type.","note":{"type":"text","tag":"p","text":"Also beware of side-effects in your code: Everything is automatically rerun as needed (for changes), so side-effects may execute for every character you type."}}},{"id":7,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"","note":{"type":"text","tag":"p","text":""}}},{"id":8,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"If a shortcut triggers a browser action, try an alternative key combination by switching ⌘/Meta/Ctrl.","note":{"type":"text","tag":"p","text":"If a shortcut triggers a browser action, try an alternative key combination by switching ⌘/Meta/Ctrl."}}},{"id":9,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":1,"input":"For example:","note":{"type":"text","tag":"p","text":"For example:"}}},{"id":10,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":2,"input":"⌘N = Meta-N = Ctrl-N","note":{"type":"text","tag":"p","text":"⌘N = Meta-N = Ctrl-N"}}},{"id":11,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":2,"input":"⌘⇧P = Meta-Shift-P = Ctrl-Shift-P","note":{"type":"text","tag":"p","text":"⌘⇧P = Meta-Shift-P = Ctrl-Shift-P"}}},{"id":12,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":2,"input":"etc","note":{"type":"text","tag":"p","text":"etc"}}}]}},"isCollapsed":true,"children":[]},{"id":1,"name":"Formulas","state":{"t":"resheet.selector","v":0,"mode":"run","expr":"SheetOf(Note)","inner":{"t":"resheet.sheet","v":2,"lines":[{"id":0,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"# Formulas","note":{"type":"text","tag":"h1","text":"Formulas"}}},{"id":1,"name":"msInADay","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"= 24 /*h*/ * 60 /*min*/ * 60 /*sec*/ * 1000 /*ms*/","note":{"type":"expr","code":" 24 /*h*/ * 60 /*min*/ * 60 /*sec*/ * 1000 /*ms*/"}}},{"id":2,"name":"startOfThisYear","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"= new Date(new Date().getFullYear(), 0, 1)","note":{"type":"expr","code":" new Date(new Date().getFullYear(), 0, 1)"}}},{"id":3,"name":"daysInThisYear","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"= (Date.now() - startOfThisYear.getTime()) / msInADay","note":{"type":"expr","code":" (Date.now() - startOfThisYear.getTime()) / msInADay"}}},{"id":4,"name":"","visibility":"result","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"= // using react:\n<p className=\"py-2\">\n  This year is already {/* preserve the space character before this comment */}\n  {daysInThisYear.toLocaleString(\"en-US\", { maximumFractionDigits: 1 })}\n  {} days long. {}\n  <span className=\"text-sm text-gray-700\">(Select this line and show or hide the code with ⌘M)</span>\n</p>","note":{"type":"expr","code":" // using react:\n<p className=\"py-2\">\n  This year is already {/* preserve the space character before this comment */}\n  {daysInThisYear.toLocaleString(\"en-US\", { maximumFractionDigits: 1 })}\n  {} days long. {}\n  <span className=\"text-sm text-gray-700\">(Select this line and show or hide the code with ⌘M)</span>\n</p>"}}},{"id":30,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"","note":{"type":"text","tag":"p","text":""}}},{"id":35,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"---","note":{"type":"text","tag":"p","text":"---"}}},{"id":31,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"**Important**","note":{"type":"text","tag":"p","text":"**Important**"}}},{"id":32,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"Don't mutate values of other cells. ReSheet is designed to be used like a functional language.","note":{"type":"text","tag":"p","text":"Don't mutate values of other cells. ReSheet is designed to be used like a functional language."}}},{"id":33,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"*Side note:* This is just like any other Spreadsheet works. You can't write formulas that change another cell's value. Cells only change because the values of other cells they depend on change.","note":{"type":"text","tag":"p","text":"*Side note:* This is just like any other Spreadsheet works. You can't write formulas that change another cell's value. Cells only change because the values of other cells they depend on change."}}},{"id":34,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"---","note":{"type":"text","tag":"p","text":"---"}}},{"id":36,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"","note":{"type":"text","tag":"p","text":""}}},{"id":5,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"## External Libraries","note":{"type":"text","tag":"h2","text":"External Libraries"}}},{"id":6,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"[esm.sh](https://esm.sh/) works great for loading npm libraries","note":{"type":"text","tag":"p","text":"[esm.sh](https://esm.sh/) works great for loading npm libraries"}}},{"id":14,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"### Number Formatting","note":{"type":"text","tag":"h3","text":"Number Formatting"}}},{"id":7,"name":"numeral","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"= import('https://esm.sh/numeral')","note":{"type":"expr","code":" import('https://esm.sh/numeral')"}}},{"id":8,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"= numeral.default(123456.789).format('0,0.00')","note":{"type":"expr","code":" numeral.default(123456.789).format('0,0.00')"}}},{"id":10,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"### CSV Parsing","note":{"type":"text","tag":"h3","text":"CSV Parsing"}}},{"id":11,"name":"Papa","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"= import('https://esm.sh/papaparse')","note":{"type":"expr","code":" import('https://esm.sh/papaparse')"}}},{"id":12,"name":"csv","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"id,name,age,plan,email\n0,John,28,free,john@example.com\n1,Alice,34,premium,alice@boo\n2,Bob,43,premium,bob@b.b","note":{"type":"text","tag":"p","text":"id,name,age,plan,email\n0,John,28,free,john@example.com\n1,Alice,34,premium,alice@boo\n2,Bob,43,premium,bob@b.b"}}},{"id":13,"name":"data","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"= Papa.default.parse(csv.text, { header: true }).data","note":{"type":"expr","code":" Papa.default.parse(csv.text, { header: true }).data"}}},{"id":15,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"### Data Validation","note":{"type":"text","tag":"h3","text":"Data Validation"}}},{"id":16,"name":"validator","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"= import('https://esm.sh/validator')","note":{"type":"expr","code":" import('https://esm.sh/validator')"}}},{"id":17,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"= data.map(user => ({ ...user, validEmail: validator.default.isEmail(user.email) }))","note":{"type":"expr","code":" data.map(user => ({ ...user, validEmail: validator.default.isEmail(user.email) }))"}}},{"id":18,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"### Data Processing","note":{"type":"text","tag":"h3","text":"Data Processing"}}},{"id":19,"name":"lodash","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"= import('https://esm.sh/lodash')","note":{"type":"expr","code":" import('https://esm.sh/lodash')"}}},{"id":20,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"= lodash.default.groupBy(data, 'plan')","note":{"type":"expr","code":" lodash.default.groupBy(data, 'plan')"}}},{"id":21,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"### Dates","note":{"type":"text","tag":"h3","text":"Dates"}}},{"id":22,"name":"datefns","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"= import('https://esm.sh/date-fns')","note":{"type":"expr","code":" import('https://esm.sh/date-fns')"}}},{"id":23,"name":"startOfThisyear","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"= datefns.startOfYear(new Date())","note":{"type":"expr","code":" datefns.startOfYear(new Date())"}}},{"id":28,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"= datefns.differenceInDays(new Date(), startOfThisYear)","note":{"type":"expr","code":" datefns.differenceInDays(new Date(), startOfThisYear)"}}},{"id":29,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"= datefns.getDayOfYear(new Date())","note":{"type":"expr","code":" datefns.getDayOfYear(new Date())"}}},{"id":24,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"### Charts","note":{"type":"text","tag":"h3","text":"Charts"}}},{"id":25,"name":"recharts","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"= import('https://esm.sh/recharts?external=react')","note":{"type":"expr","code":" import('https://esm.sh/recharts?external=react')"}}},{"id":27,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"/Code","note":{"type":"block","isInstantiated":true,"code":"Code","state":"const { ResponsiveContainer, BarChart, Bar, XAxis, YAxis } = recharts;\n\n<ResponsiveContainer height={400}>\n  <BarChart data={data}>\n    <Bar type=\"monotone\" dataKey=\"age\" fill=\"#8884d8\" />\n    <XAxis dataKey=\"name\"/>\n    <YAxis/>\n  </BarChart>\n</ResponsiveContainer>"}}}]}},"isCollapsed":true,"children":[]},{"id":2,"name":"Markdown","state":{"t":"resheet.selector","v":0,"mode":"run","expr":"SheetOf(Note)","inner":{"t":"resheet.sheet","v":2,"lines":[{"id":0,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"# Markdown","note":{"type":"text","tag":"h1","text":"Markdown"}}},{"id":1,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"*`*italic*`*","note":{"type":"text","tag":"p","text":"*`*italic*`*"}}},{"id":2,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"**`**bold**`**","note":{"type":"text","tag":"p","text":"**`**bold**`**"}}},{"id":3,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"`[a link](url)`","note":{"type":"text","tag":"p","text":"`[a link](url)`"}}},{"id":4,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"- Lists","note":{"type":"text","tag":"li","text":"Lists"}}},{"id":5,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"[ ] Todos","note":{"type":"checkbox","checked":false,"text":"Todos"}}},{"id":6,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"[x] Done","note":{"type":"checkbox","checked":true,"text":"Done"}}},{"id":7,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"`# Headings`","note":{"type":"text","tag":"p","text":"`# Headings`"}}},{"id":8,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"Inline <span className=\"before:block before:absolute before:-inset-0.5 before:-skew-y-1 before:bg-blue-100 relative inline-block\"><span className=\"relative text-blue-950\">Html with [tailwindcss](https://tailwindcss.com/docs/utility-first)</span></span>","note":{"type":"text","tag":"p","text":"Inline <span className=\"before:block before:absolute before:-inset-0.5 before:-skew-y-1 before:bg-blue-100 relative inline-block\"><span className=\"relative text-blue-950\">Html with [tailwindcss](https://tailwindcss.com/docs/utility-first)</span></span>"}}}]}},"isCollapsed":true,"children":[]},{"id":3,"name":"Blocks","state":{"t":"resheet.selector","v":0,"mode":"run","expr":"SheetOf(Note)","inner":{"t":"resheet.sheet","v":2,"lines":[{"id":0,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"# Blocks","note":{"type":"text","tag":"h1","text":"Blocks"}}},{"id":1,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"Blocks are the equivalent to cells in a spreadsheet. Most things in ReSheet are Blocks.","note":{"type":"text","tag":"p","text":"Blocks are the equivalent to cells in a spreadsheet. Most things in ReSheet are Blocks."}}},{"id":3,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"","note":{"type":"text","tag":"p","text":""}}},{"id":2,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"Every line here contains a `Note` Block, which allows writing Markdown or Formulas (e.g. \"`= 1 + 1`\").","note":{"type":"text","tag":"p","text":"Every line here contains a `Note` Block, which allows writing Markdown or Formulas (e.g. \"`= 1 + 1`\")."}}},{"id":4,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"A `Note` Block also allows using another Block, for example `Code`. Type in an empty line:","note":{"type":"text","tag":"p","text":"A `Note` Block also allows using another Block, for example `Code`. Type in an empty line:"}}},{"id":5,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"`/Code`","note":{"type":"text","tag":"p","text":"`/Code`"}}},{"id":6,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"and after hitting ⌘`Enter` you get:","note":{"type":"text","tag":"p","text":"and after hitting ⌘`Enter` you get:"}}},{"id":7,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"/Code","note":{"type":"block","isInstantiated":true,"code":"Code","state":"// This is a Code Block now\nfunction Mark({ children }) {\n  return (\n    <span className=\"before:block before:absolute before:-inset-0.5 before:-skew-y-2 before:bg-blue-400 relative inline-block\">\n      <span className=\"relative text-white px-0.5 tracking-wide\">\n        {children}\n      </span>\n    </span>\n  )\n}\n\n<p className=\"py-1\">\n  <Mark>Look</Mark> at it!\n</p>"}}},{"id":8,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"","note":{"type":"text","tag":"p","text":""}}},{"id":9,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"All lines here are part of the `SheetOf` Block:","note":{"type":"text","tag":"p","text":"All lines here are part of the `SheetOf` Block:"}}},{"id":10,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"`/SheetOf(Note)`","note":{"type":"text","tag":"p","text":"`/SheetOf(Note)`"}}},{"id":11,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"/SheetOf(Note)","note":{"type":"block","isInstantiated":true,"code":"SheetOf(Note)","state":{"t":"resheet.sheet","v":2,"lines":[{"id":0,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"Now we have a Sheet inside of a Sheet","note":{"type":"text","tag":"p","text":"Now we have a Sheet inside of a Sheet"}}},{"id":1,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"= $9.text","note":{"type":"expr","code":" $9.text"}}}]}}}},{"id":12,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"","note":{"type":"text","tag":"p","text":""}}},{"id":13,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"","note":{"type":"text","tag":"p","text":""}}},{"id":14,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"There are other Blocks available in `blocks`. (Use completion/docs with ⌘`Space`/⌘`D`)","note":{"type":"text","tag":"p","text":"There are other Blocks available in `blocks`. (Use completion/docs with ⌘`Space`/⌘`D`)"}}},{"id":15,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"= blocks","note":{"type":"expr","code":" blocks"}}},{"id":16,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"","note":{"type":"text","tag":"p","text":""}}},{"id":17,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"## Custom Blocks","note":{"type":"text","tag":"h2","text":"Custom Blocks"}}},{"id":18,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"You can build your own blocks. In Examples > \"Advanced Playground\" you can see more elaborate examples. For now you either have to shoot me a message or look at the source code of the existing blocks to find out more.","note":{"type":"text","tag":"p","text":"You can build your own blocks. In Examples > \"Advanced Playground\" you can see more elaborate examples. For now you either have to shoot me a message or look at the source code of the existing blocks to find out more."}}},{"id":19,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"","note":{"type":"text","tag":"p","text":""}}},{"id":20,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"Ok, I'll give you a small example:","note":{"type":"text","tag":"p","text":"Ok, I'll give you a small example:"}}},{"id":21,"name":"RAW","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"/Code","note":{"type":"block","isInstantiated":true,"code":"Code","state":"resheet.core.block.create({\n  init: \"\",\n  view({ state, dispatch, env }, ref) {\n    return (\n      <textarea\n        ref={ref}\n        value={state}\n        onChange={ev => dispatch(stateBefore => ({ state: ev.target.value }))}\n        rows={state.split('\\n').length}\n        />\n    )\n  },\n  recompute(state, update, env) {\n    return { state, invalidated: false }\n  },\n  getResult(state) {\n    return state\n  },\n  fromJSON(json) {\n    return typeof json === 'string' ? json : ''\n  },\n  toJSON(state) {\n    return state\n  },\n})"}}},{"id":22,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"`/RAW`","note":{"type":"text","tag":"p","text":"`/RAW`"}}},{"id":23,"name":"rawText","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"/RAW","note":{"type":"block","isInstantiated":true,"code":"RAW","state":"{\n  \"hello\": \"world\"\n}"}}},{"id":24,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"= JSON.parse(rawText)","note":{"type":"expr","code":" JSON.parse(rawText)"}}}]}},"isCollapsed":true,"children":[]}]},{"id":1,"name":"Examples","state":{"t":"resheet.selector","v":0,"mode":"run","expr":"SheetOf(Note)","inner":{"t":"resheet.sheet","v":2,"lines":[{"id":0,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"# Examples","note":{"type":"text","tag":"h1","text":"Examples"}}},{"id":1,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"The following examples reside in subpages. You find them in the sidebar on the left inside \"Examples\".","note":{"type":"text","tag":"p","text":"The following examples reside in subpages. You find them in the sidebar on the left inside \"Examples\"."}}},{"id":49,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"","note":{"type":"text","tag":"p","text":""}}},{"id":50,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"All example content (text, design and code) is licensed [CC0](https://creativecommons.org/public-domain/cc0/) (public domain). So use and adapt it to your needs however you want.","note":{"type":"text","tag":"p","text":"All example content (text, design and code) is licensed [CC0](https://creativecommons.org/public-domain/cc0/) (public domain). So use and adapt it to your needs however you want."}}},{"id":24,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"","note":{"type":"text","tag":"p","text":""}}},{"id":26,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"","note":{"type":"text","tag":"p","text":""}}},{"id":27,"name":"","visibility":"block","width":"wide","state":{"t":"resheet.note","v":1,"level":0,"input":"----","note":{"type":"text","tag":"p","text":"----"}}},{"id":25,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"","note":{"type":"text","tag":"p","text":""}}},{"id":2,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"#### Personal Finances","note":{"type":"text","tag":"h4","text":"Personal Finances"}}},{"id":3,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"Load and parse a CSV file, process and display the data in a chart.","note":{"type":"text","tag":"p","text":"Load and parse a CSV file, process and display the data in a chart."}}},{"id":8,"name":"","visibility":"result","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"/Code","note":{"type":"block","isInstantiated":true,"code":"Code","state":"<div className=\"m-4 p-3 rounded border bg-gray-50\">\n  <h2 className=\"font-medium text-xl border-b\">\n    Personal Finances Preview\n  </h2>\n  {$`Personal Finances`}\n</div>"}}},{"id":10,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"","note":{"type":"text","tag":"p","text":""}}},{"id":20,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"","note":{"type":"text","tag":"p","text":""}}},{"id":41,"name":"","visibility":"block","width":"wide","state":{"t":"resheet.note","v":1,"level":0,"input":"----","note":{"type":"text","tag":"p","text":"----"}}},{"id":42,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"","note":{"type":"text","tag":"p","text":""}}},{"id":43,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"","note":{"type":"text","tag":"p","text":""}}},{"id":44,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"#### CV","note":{"type":"text","tag":"h4","text":"CV"}}},{"id":45,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"Create a CV by filling in a template.","note":{"type":"text","tag":"p","text":"Create a CV by filling in a template."}}},{"id":46,"name":"","visibility":"result","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"/Code","note":{"type":"block","isInstantiated":true,"code":"Code","state":"<div className=\"m-4 p-3 rounded border bg-gray-50\">\n  <h2 className=\"font-medium text-xl border-b\">CV Preview</h2>\n  {CV}\n</div>"}}},{"id":47,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"","note":{"type":"text","tag":"p","text":""}}},{"id":48,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"","note":{"type":"text","tag":"p","text":""}}},{"id":16,"name":"","visibility":"block","width":"wide","state":{"t":"resheet.note","v":1,"level":0,"input":"----","note":{"type":"text","tag":"p","text":"----"}}},{"id":17,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"","note":{"type":"text","tag":"p","text":""}}},{"id":21,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"","note":{"type":"text","tag":"p","text":""}}},{"id":4,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"#### Invoice","note":{"type":"text","tag":"h4","text":"Invoice"}}},{"id":5,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"Load a working hours export (from atWork) and generate an invoice.","note":{"type":"text","tag":"p","text":"Load a working hours export (from atWork) and generate an invoice."}}},{"id":9,"name":"","visibility":"result","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"/Code","note":{"type":"block","isInstantiated":true,"code":"Code","state":"<div className=\"m-4 p-3 rounded border bg-gray-50\">\n  <h2 className=\"font-medium text-xl border-b\">Invoice Preview</h2>\n  {Invoice}\n</div>"}}},{"id":13,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"","note":{"type":"text","tag":"p","text":""}}},{"id":22,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"","note":{"type":"text","tag":"p","text":""}}},{"id":18,"name":"","visibility":"block","width":"wide","state":{"t":"resheet.note","v":1,"level":0,"input":"----","note":{"type":"text","tag":"p","text":"----"}}},{"id":19,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"","note":{"type":"text","tag":"p","text":""}}},{"id":23,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"","note":{"type":"text","tag":"p","text":""}}},{"id":6,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"#### Advanced Playground","note":{"type":"text","tag":"h4","text":"Advanced Playground"}}},{"id":7,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"Create custom Blocks and use the Inspect Block to get a glimpse into ReSheet.","note":{"type":"text","tag":"p","text":"Create custom Blocks and use the Inspect Block to get a glimpse into ReSheet."}}},{"id":15,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"","note":{"type":"text","tag":"p","text":""}}},{"id":34,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"/$`Advanced Playground`","note":{"type":"block","isInstantiated":true,"code":"$`Advanced Playground`","state":{"t":"resheet.sheet","v":2,"lines":[{"id":1,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"### Advanced Playground Preview","note":{"type":"text","tag":"h3","text":"Advanced Playground Preview"}}},{"id":2,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"We build these custom Blocks in this Page:","note":{"type":"text","tag":"p","text":"We build these custom Blocks in this Page:"}}},{"id":3,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"","note":{"type":"text","tag":"p","text":""}}},{"id":4,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"`/CheckEditableBlock`","note":{"type":"text","tag":"p","text":"`/CheckEditableBlock`"}}},{"id":5,"name":"checkEditableValue","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"/CheckEditableBlock","note":{"type":"block","isInstantiated":true,"code":"CheckEditableBlock","state":{"checked":true,"label":"This is an editable label"}}}},{"id":6,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"","note":{"type":"text","tag":"p","text":""}}},{"id":7,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"","note":{"type":"text","tag":"p","text":""}}},{"id":8,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"`/SliderBlock()`","note":{"type":"text","tag":"p","text":"`/SliderBlock()`"}}},{"id":9,"name":"sliderBlockValue","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"/SliderBlock()","note":{"type":"block","isInstantiated":true,"code":"SliderBlock()","state":49}}},{"id":10,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"= sliderBlockValue","note":{"type":"expr","code":" sliderBlockValue"}}},{"id":11,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"","note":{"type":"text","tag":"p","text":""}}},{"id":20,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"","note":{"type":"text","tag":"p","text":""}}},{"id":21,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"`/HStack(Code, Code, Code)`","note":{"type":"text","tag":"p","text":"`/HStack(Code, Code, Code)`"}}},{"id":22,"name":"hstack","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"/HStack(Code, Code, Code)","note":{"type":"block","isInstantiated":true,"code":"HStack(Code, Code, Code)","state":["checkEditableValue","sliderBlockValue","12"]}}},{"id":23,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"= hstack","note":{"type":"expr","code":" hstack"}}},{"id":12,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"","note":{"type":"text","tag":"p","text":""}}},{"id":24,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"","note":{"type":"text","tag":"p","text":""}}},{"id":13,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"And we inspect some built-in Blocks:","note":{"type":"text","tag":"p","text":"And we inspect some built-in Blocks:"}}},{"id":14,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"`/Debug.Inspect(Note)`","note":{"type":"text","tag":"p","text":"`/Debug.Inspect(Note)`"}}},{"id":15,"name":"inspectNote","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"/Debug.Inspect(Note)","note":{"type":"block","isInstantiated":true,"code":"Debug.Inspect(Note)","state":{"t":"resheet.note","v":1,"level":0,"input":"= sliderBlockValue","note":{"type":"expr","code":" sliderBlockValue"}}}}},{"id":16,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"= inspectNote.state","note":{"type":"expr","code":" inspectNote.state"}}},{"id":17,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"","note":{"type":"text","tag":"p","text":""}}},{"id":18,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"","note":{"type":"text","tag":"p","text":""}}},{"id":19,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"<span className=\"text-gray-400 text-sm\">Psst: And don't miss the Grand Finale!</span>","note":{"type":"text","tag":"p","text":"<span className=\"text-gray-400 text-sm\">Psst: And don't miss the Grand Finale!</span>"}}}]}}}},{"id":28,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"","note":{"type":"text","tag":"p","text":""}}},{"id":29,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"","note":{"type":"text","tag":"p","text":""}}},{"id":37,"name":"","visibility":"block","width":"wide","state":{"t":"resheet.note","v":1,"level":0,"input":"----","note":{"type":"text","tag":"p","text":"----"}}},{"id":38,"name":"","visibility":"block","width":"wide","state":{"t":"resheet.note","v":1,"level":0,"input":"","note":{"type":"text","tag":"p","text":""}}},{"id":35,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"#### Interactive Game Dev","note":{"type":"text","tag":"h4","text":"Interactive Game Dev"}}},{"id":36,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"Build a custom Game Block for interactively developing a simple game. Leverage existing Blocks to combine them to the tailored needs of a Game Editor.","note":{"type":"text","tag":"p","text":"Build a custom Game Block for interactively developing a simple game. Leverage existing Blocks to combine them to the tailored needs of a Game Editor."}}},{"id":39,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"","note":{"type":"text","tag":"p","text":""}}},{"id":40,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"/$`Interactive Game Dev`","note":{"type":"block","isInstantiated":false,"code":"$`Interactive Game Dev`"}}}]}},"isCollapsed":false,"children":[{"id":0,"name":"Personal Finances","state":{"t":"resheet.selector","v":0,"mode":"run","expr":"SheetOf(Note)","inner":{"t":"resheet.sheet","v":2,"lines":[{"id":1,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"# Personal Finances","note":{"type":"text","tag":"h1","text":"Personal Finances"}}},{"id":2,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"Load and parse a CSV file, process and display the data in a chart.","note":{"type":"text","tag":"p","text":"Load and parse a CSV file, process and display the data in a chart."}}},{"id":3,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"","note":{"type":"text","tag":"p","text":""}}},{"id":15,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"## Load and Parse CSV","note":{"type":"text","tag":"h2","text":"Load and Parse CSV"}}},{"id":4,"name":"bankExportFile","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"/LoadFile","note":{"type":"block","isInstantiated":true,"code":"LoadFile","state":{"state":"loaded","file":{"content":"IkV4YW1wbGViYW5rIEdsb2JhbCIKCiJUcmFuc2FjdGlvbiBPdmVydmlldyIKCiJCYW5rIENvZGU6IjsiMTIzNDU2NzgiOzsiRGF0ZToiOyIwNC8wOS8yMDEzIgoiQWNjb3VudDoiOyI5ODc2NTQzMiI7OyJUaW1lOiI7IjEyOjM5OjE4IgoiUXVlcnkgYnk6IjsiSmFuZSBEb2UiOzsiQWNjb3VudCBIb2xkZXI6IjsiSmFuZSBEb2UiCgoiUGVyaW9kOiI7OyJmcm9tOiI7IjA4LzAxLzIwMTIiOyJ0bzoiOyIwNC8wOC8yMDEzIgoiQW1vdW50IGluIEVVUjoiOzsiZnJvbToiOyIgIjsidG86IjsiICIKIlNvcnRlZCBieToiOyJCb29raW5nIGRheSI7ImRlc2NlbmRpbmciCgoiQm9va2luZyBEYXkiOyJWYWx1ZSBEYXRlIjsiUGF5ZXIvUGF5ZWUiOyJSZWNpcGllbnQvT2JsaWdvciI7IkFjY291bnQgTm8uIjsiQmFuayBDb2RlIjsiVHJhbnNhY3Rpb24vUHVycG9zZSI7IkN1cnJlbmN5IjsiQW1vdW50IjsiICIKIjA0LzAyLzIwMTMiOyIwMy8zMS8yMDEzIjs7Ozs7IlNUQVRFTUVOVAoKU1RBVEVNRU5UIEFTIE9GIDAzLzMxLzIwMTMiOyJFVVIiOyIwLjkyIjsiSCIKIjAzLzI1LzIwMTMiOyIwMy8yNS8yMDEzIjsiRjA4NDc5MjE3NDA0NyAgICAgICAwMDAwMCI7IkRFVVRTQ0hFIEJBSE4gS0FSTFNSVUhFIEhCIjsiOTQ3Mjk0ODk0MiI7IjEyMDgwMDAwIjsiRElSRUNUIERFQklUCkVDIDQ3ODI3MjQ4IDg0Mjk3MjQ5NTMyNU9DMSI7IkVVUiI7IjEyNy45MCI7IlMiCiIwMy8yMi8yMDEzIjsiMDMvMjIvMjAxMyI7IkpBTkUgRE9FIjsiQU1BWk9OIERPV05MT0FEUyI7IjQ3ODI3NDkyMDkiOyI4Mjk0Mjk4MCI7IkRJUkVDVCBERUJJVAoxNDkyODI5NDgwMzU1NjI0IjsiRVVSIjsiMy45OSI7IlMiCiIwMy8yMi8yMDEzIjsiMDMvMjIvMjAxMyI7IkpBTkUgRE9FIjsiQU1BWk9OIERPV05MT0FEUyI7IjE3NDI4NDcyNDkiOyI3MjQ5NzI0OSI7IkRJUkVDVCBERUJJVAoyNDk4OTI0ODAyNTQwMjQ5IjsiRVVSIjsiMC43OSI7IlMiCiIwMy8xOC8yMDEzIjsiMDMvMTgvMjAxMyI7IkFUTSA0ODgyIjsiQVRNIE5SMDAwMjg0MDEgQkFOSyBDT0RFNzQyOTI4OTAgMSI7OzsiQVRNIFdJVEhEUkFXQUwKMDMvMTgvMTM6NTYiOyJFVVIiOyI1MC4wMCI7IlMiCiIwMy8xMy8yMDEzIjsiMDMvMTMvMjAxMyI7IkFUTSA3NDg5IjsiQVRNIE5SMDAwMjQ5ODEgQkFOSyBDT0RFMjk0Mjg0OTAgMSI7OzsiQVRNIFdJVEhEUkFXQUwKMDMvMTMvMTg6NDMiOyJFVVIiOyI1MC4wMCI7IlMiCiIwMy8xMS8yMDEzIjsiMDMvMTEvMjAxMyI7IkpBTkUgRE9FIjsiUEVURVIgUEFSS0VSIjsiMTg0OTE0ODIiOyI5MTQ3MTk4NiI7IlNUQU5ESU5HIE9SREVSIENSRURJVApNT05FWSI7IkVVUiI7IjE3Mi4wMCI7IkgiCiIwMy8wNC8yMDEzIjsiMDMvMDQvMjAxMyI7IkFUTSAyNDgyIjsiQVRNIE5SMDAwOTg0MjEgQkFOSyBDT0RFOTE4NDk5NDAgMSI7OzsiQVRNIFdJVEhEUkFXQUwKMDMvMDQvMTk6MDEiOyJFVVIiOyI1MC4wMCI7IlMiCiIwMy8wNC8yMDEzIjsiMDMvMDQvMjAxMyI7IkFUTSA5ODQ5IjsiQVRNIE5SMDA4NDkyMzQgQkFOSyBDT0RFOTQ4MjkyNDAgMSI7OzsiQVRNIFdJVEhEUkFXQUwKMDMvMDIvMTg6MTYiOyJFVVIiOyIyMC4wMCI7IlMiCiIwMi8yNy8yMDEzIjsiMDIvMjcvMjAxMyI7IkFUTSA4MjQ5IjsiQVRNIE5SMDAwNDcyOTEgQkFOSyBDT0RFNzk1Mjg5MDIgMSI7OzsiQVRNIFdJVEhEUkFXQUwKMDIvMjcvMTk6MTUiOyJFVVIiOyIyMC4wMCI7IlMiCiIwMi8yNi8yMDEzIjsiMDIvMjYvMjAxMyI7IlNVUEVSTUFSS0VUIENPUk5FUiI7IkpBTkUgRE9FIjsiOTgyNzQ4MjkiOyIxMjA4MDAwMCI7IkRJUkVDVCBERUJJVApHUk9DRVJJRVMiOyJFVVIiOyI4NS40NyI7IlMiCiIwMi8yMC8yMDEzIjsiMDIvMjAvMjAxMyI7IkpBTkUgRE9FIjsiTUFYIE1VU1RFUk1BTk4iOyI5NDg3Mjk0OCI7IjEyOTQ4NzI5IjsiVFJBTlNGRVIKQklMTCBQQVlNRU5UIjsiRVVSIjsiMjUwLjAwIjsiUyIKIjAyLzE1LzIwMTMiOyIwMi8xNS8yMDEzIjsiVVRJTElUWSBDT01QQU5ZIENJVFkiOyJKQU5FIERPRSI7IjI5NDgyOTQ4IjsiMTIwODAwMDAiOyJESVJFQ1QgREVCSVQKRUxFQ1RSSUNJVFkvRU5FUkdZIjsiRVVSIjsiOTAuMDAiOyJTIgoiMDIvMTAvMjAxMyI7IjAyLzEwLzIwMTMiOyJKQU5FIERPRSI7Ik9OTElORSBTSE9QIFhZWiI7Ijc0ODI5NDgyIjsiMTIwODAwMDAiOyJESVJFQ1QgREVCSVQKT1JERVIgTk8uIDQ4Mjk0IjsiRVVSIjsiNDcuOTAiOyJTIgoiMDIvMDUvMjAxMyI7IjAyLzA1LzIwMTMiOyJGSVRORVNTIENFTlRFUiBHWU0iOyJKQU5FIERPRSI7IjI5Mzg0NzI5IjsiMTIwODAwMDAiOyJESVJFQ1QgREVCSVQKTUVNQkVSU0hJUCBGRUUgRkVCIjsiRVVSIjsiMjkuOTkiOyJTIgoiMDIvMDEvMjAxMyI7IjAyLzAxLzIwMTMiOyJKQU5FIERPRSI7IkxJU0EgTVVTVEVSIjsiODQ5MzcyOTQiOyIxMjA4MDAwMCI7IlRSQU5TRkVSCkJJUlRIREFZIEdJRlQiOyJFVVIiOyIxMDAuMDAiOyJIIgoiMDEvMjgvMjAxMyI7IjAxLzI4LzIwMTMiOyJDSU5FTUEgQ0hBSU4gQ0lUWSI7IkpBTkUgRE9FIjsiNDkyODM3NDkiOyIxMjA4MDAwMCI7IkRJUkVDVCBERUJJVApDSU5FTUEgVElDS0VUUyI7IkVVUiI7IjM1LjAwIjsiUyIKIjAxLzI1LzIwMTMiOyIwMS8yNS8yMDEzIjsiSkFORSBET0UiOyJWRVQgRFIuIFdVRkYiOyI4NDczOTI4NCI7IjEyMDgwMDAwIjsiRElSRUNUIERFQklUClZFVEVSSU5BUlkgVFJFQVRNRU5UIjsiRVVSIjsiMTIwLjAwIjsiUyIKIjAxLzIwLzIwMTMiOyIwMS8yMC8yMDEzIjsiSEFSRFdBUkUgU1RPUkUgRElZIjsiSkFORSBET0UiOyIyODM3NDkyOCI7IjEyMDgwMDAwIjsiRElSRUNUIERFQklUClJFTk9WQVRJT04gTUFURVJJQUwiOyJFVVIiOyIyMDAuMDAiOyJTIgoiMDEvMTUvMjAxMyI7IjAxLzE1LzIwMTMiOyJKQU5FIERPRSI7IkJPT0tTVE9SRSBSRUFESk9ZIjsiOTgyMzc0OTIiOyIxMjA4MDAwMCI7IkRJUkVDVCBERUJJVApTUEVDSUFMVFkgQk9PS1MiOyJFVVIiOyI2MC4wMCI7IlMiCiIwMS8xMC8yMDEzIjsiMDEvMTAvMjAxMyI7IkNBRkUgQ09GRkVFQ0hBVCI7IkpBTkUgRE9FIjsiODI3Mzk0ODIiOyIxMjA4MDAwMCI7IkRJUkVDVCBERUJJVApCUkVBS0ZBU1QgTUVFVElORyI7IkVVUiI7IjE1LjkwIjsiUyIKIjAxLzA1LzIwMTMiOyIwMS8wNS8yMDEzIjsiSkFORSBET0UiOyJJTlRFUk5FVCBQUk9WSURFUiBTUEVFRFkiOyI4NDczMjg5NCI7IjEyMDgwMDAwIjsiRElSRUNUIERFQklUCklOVEVSTkVUIEZFRVMgSkFOIjsiRVVSIjsiMjkuOTUiOyJTIgoiMDEvMDIvMjAxMyI7IjAxLzAxLzIwMTMiOzs7OzsiU1RBVEVNRU5UCgpTVEFURU1FTlQgQVMgT0YgMTIvMzEvMjAxMiI7IkVVUiI7IjEuNTAiOyJIIgoKCiIxMi8wNC8yMDEyIjs7Ozs7OyJFVVIiOyJPcGVuaW5nIEJhbGFuY2UiOyIxLDQxOC45MyI7IkgiCg==","name":"bank-extract.csv","options":{"type":"text/csv","lastModified":1712397176186}}}}}},{"id":5,"name":"bankExportContent","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"= bankExportFile.text()","note":{"type":"expr","code":" bankExportFile.text()"}}},{"id":6,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"","note":{"type":"text","tag":"p","text":""}}},{"id":7,"name":"bankExportParsed","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"= libs.papaparse.parse(bankExportContent)","note":{"type":"expr","code":" libs.papaparse.parse(bankExportContent)"}}},{"id":8,"name":"","visibility":"result","width":"full","state":{"t":"resheet.note","v":1,"level":0,"input":"= <reactInspector.TableInspector data={bankExportParsed.data} />","note":{"type":"expr","code":" <reactInspector.TableInspector data={bankExportParsed.data} />"}}},{"id":9,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"","note":{"type":"text","tag":"p","text":""}}},{"id":17,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"","note":{"type":"text","tag":"p","text":""}}},{"id":18,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"","note":{"type":"text","tag":"p","text":""}}},{"id":16,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"## Convert and Process Data","note":{"type":"text","tag":"h2","text":"Convert and Process Data"}}},{"id":38,"name":"balanceStart","visibility":"result","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"= Number.parseFloat(\n    bankExportParsed.data.slice(-2)[0][8].replace(',','')\n  )","note":{"type":"expr","code":" Number.parseFloat(\n    bankExportParsed.data.slice(-2)[0][8].replace(',','')\n  )"}}},{"id":10,"name":"transactionsCSV","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"= bankExportParsed.data.slice(13, -4)","note":{"type":"expr","code":" bankExportParsed.data.slice(13, -4)"}}},{"id":36,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"","note":{"type":"text","tag":"p","text":""}}},{"id":37,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"","note":{"type":"text","tag":"p","text":""}}},{"id":13,"name":"transactions","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"/Code","note":{"type":"block","isInstantiated":true,"code":"Code","state":"lodash(transactionsCSV)\n  .map(\n    ([date,, payerPayee, recipientObligor, account, bankCode, purpose, currency, turnoverStr, creditDebit]) => {\n      const turnoverNum = Number.parseFloat(turnoverStr)\n      return {\n        date: libs.datefns.parse(date, 'LL/dd/uuuu', new Date()),\n        payerPayee,\n        recipientObligor,\n        purpose,\n        turnover: creditDebit === 'S' ? -turnoverNum : turnoverNum,\n        currency,\n        account,\n        bankCode,\n      }\n    }\n  )\n  .sortBy('date')\n  .value()"}}},{"id":11,"name":"","visibility":"result","width":"full","state":{"t":"resheet.note","v":1,"level":0,"input":"= <reactInspector.TableInspector data={transactions} />","note":{"type":"expr","code":" <reactInspector.TableInspector data={transactions} />"}}},{"id":34,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"","note":{"type":"text","tag":"p","text":""}}},{"id":35,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"","note":{"type":"text","tag":"p","text":""}}},{"id":30,"name":"turnoverByMonth","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"/Code","note":{"type":"block","isInstantiated":true,"code":"Code","state":"lodash.chain(transactions)\n  .map(transaction => ({\n    ...transaction,\n    month: libs.datefns.format(transaction.date, \"MMM yyyy\"),\n  }))\n  .groupBy('month')\n  .mapValues(month =>\n    lodash.chain(month)\n      .groupBy(transaction =>\n        transaction.turnover < 0 ? \"expense\" : \"income\"\n      )\n      .mapValues(transactions =>\n        lodash.sumBy(transactions, 'turnover')\n      )\n      .value()\n  )\n  .map((turnover, month) => ({ month, ...turnover }))\n  .value()"}}},{"id":33,"name":"","visibility":"result","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"= <reactInspector.TableInspector data={turnoverByMonth} />","note":{"type":"expr","code":" <reactInspector.TableInspector data={turnoverByMonth} />"}}},{"id":19,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"","note":{"type":"text","tag":"p","text":""}}},{"id":20,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"","note":{"type":"text","tag":"p","text":""}}},{"id":21,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"## Graphs","note":{"type":"text","tag":"h2","text":"Graphs"}}},{"id":23,"name":"fmtEur","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"= Intl.NumberFormat('en', { style: 'currency', currency: 'EUR' })","note":{"type":"expr","code":" Intl.NumberFormat('en', { style: 'currency', currency: 'EUR' })"}}},{"id":47,"name":"formatEuro","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"= num => fmtEur.format(num)","note":{"type":"expr","code":" num => fmtEur.format(num)"}}},{"id":24,"name":"fmtDate","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"= Intl.DateTimeFormat('en', { dateStyle: 'short' })","note":{"type":"expr","code":" Intl.DateTimeFormat('en', { dateStyle: 'short' })"}}},{"id":48,"name":"formatDate","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"= date => fmtDate.format(date)","note":{"type":"expr","code":" date => fmtDate.format(date)"}}},{"id":26,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"","note":{"type":"text","tag":"p","text":""}}},{"id":31,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"### Turnover by Month","note":{"type":"text","tag":"h3","text":"Turnover by Month"}}},{"id":32,"name":"turnoverChart","visibility":"result","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"/Code","note":{"type":"block","isInstantiated":true,"code":"Code","state":"const { ResponsiveContainer, BarChart, Bar, CartesianGrid, XAxis, YAxis, Tooltip } = libs.recharts;\n\n<ResponsiveContainer height={300}>\n  <BarChart data={turnoverByMonth}>\n    <Tooltip formatter={formatEuro} />\n    <CartesianGrid stroke=\"#eee\" strokeDasharray=\"5 5\"/>\n    <XAxis dataKey=\"month\" />\n    <YAxis tickFormatter={formatEuro} width={80} />\n    <Bar type=\"monotone\" dataKey=\"income\" fill=\"#93bc60\" />\n    <Bar type=\"monotone\" dataKey=\"expense\" fill=\"red\" />\n  </BarChart>\n</ResponsiveContainer>"}}},{"id":29,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"### Transactions","note":{"type":"text","tag":"h3","text":"Transactions"}}},{"id":22,"name":"transactionsChart","visibility":"result","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"/Code","note":{"type":"block","isInstantiated":true,"code":"Code","state":"const { ResponsiveContainer, BarChart, Bar, CartesianGrid, XAxis, YAxis, Tooltip } = libs.recharts;\n\n<ResponsiveContainer height={300}>\n  <BarChart data={transactions}>\n    <Tooltip formatter={formatEuro} labelFormatter={formatDate} />\n    <CartesianGrid stroke=\"#eee\" strokeDasharray=\"5 5\"/>\n    <XAxis dataKey=\"date\" tickFormatter={formatDate} />\n    <YAxis tickFormatter={formatEuro} width={80} />\n    <Bar type=\"monotone\" dataKey=\"turnover\" fill=\"#93bc60\" />\n  </BarChart>\n</ResponsiveContainer>"}}},{"id":28,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"### Account Balance","note":{"type":"text","tag":"h3","text":"Account Balance"}}},{"id":40,"name":"balances","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"= utils.scan( // scan is like reduce, but returns an array of every step\n  lodash.map(transactions, 'turnover'),\n  balanceStart,\n  lodash.add,\n)","note":{"type":"expr","code":" utils.scan( // scan is like reduce, but returns an array of every step\n  lodash.map(transactions, 'turnover'),\n  balanceStart,\n  lodash.add,\n)"}}},{"id":41,"name":"transactionsWithBalance","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"= utils.addColumn(transactions, 'balance', balances)","note":{"type":"expr","code":" utils.addColumn(transactions, 'balance', balances)"}}},{"id":42,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"","note":{"type":"text","tag":"p","text":""}}},{"id":25,"name":"accountBalanceChart","visibility":"result","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"/Code","note":{"type":"block","isInstantiated":true,"code":"Code","state":"const { ResponsiveContainer, LineChart, Line, XAxis, YAxis, CartesianGrid, Tooltip } = libs.recharts;\n\nconst xScaleArgs = utils.timeScaleArgs(transactionsWithBalance, \"date\");\n\n<ResponsiveContainer height={300}>\n  <LineChart data={transactionsWithBalance}>\n    <Tooltip formatter={formatEuro} labelFormatter={formatDate}/>\n    <CartesianGrid stroke=\"#eee\" strokeDasharray=\"5 5\"/>\n    <Line type=\"stepAfter\" dataKey=\"balance\" fill=\"#93bc60\" />\n    <XAxis {...xScaleArgs} tickFormatter={formatDate} />\n    <YAxis tickFormatter={formatEuro} width={80} />\n  </LineChart>\n</ResponsiveContainer>"}}},{"id":43,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"","note":{"type":"text","tag":"p","text":""}}},{"id":44,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"","note":{"type":"text","tag":"p","text":""}}},{"id":46,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"## Preview","note":{"type":"text","tag":"h2","text":"Preview"}}},{"id":45,"name":"preview","visibility":"result","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"/Code","note":{"type":"block","isInstantiated":true,"code":"Code","state":"<div>\n<h3 className=\"text-xl mt-4 mb-2\">Turnover by Month</h3>\n{turnoverChart}\n\n<h3 className=\"text-xl mt-4 mb-2\">Transactions</h3>\n{transactionsChart}\n\n<h3 className=\"text-xl mt-4 mb-2\">Account Balance</h3>\n{accountBalanceChart}\n</div>"}}}]}},"isCollapsed":true,"children":[{"id":0,"name":"libs","state":{"t":"resheet.selector","v":0,"mode":"run","expr":"SheetOf(Note)","inner":{"t":"resheet.sheet","v":2,"lines":[{"id":1,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"/Code","note":{"type":"block","isInstantiated":true,"code":"Code","state":"function esmsh(lib) {\n  return import(`https://esm.sh/${lib}?external=react`)\n}\n\nasync function esmshDefault(lib) {\n  return (await esmsh(lib)).default\n}\n\nasync function awaitValues(obj) {\n  return (\n    lodash.zipObject(\n      Object.keys(obj),\n      await Promise.all(Object.values(obj)),\n    )\n  )\n}\n\nawaitValues({\n  papaparse: esmshDefault('papaparse'),\n  datefns: esmsh('date-fns'),\n  numeral: esmshDefault('numeral'),\n  \n  recharts: esmsh('recharts'),\n  d3Scale: esmsh('d3-scale'),\n})"}}}]}},"isCollapsed":true,"children":[]},{"id":2,"name":"utils","state":{"t":"resheet.selector","v":0,"mode":"run","expr":"SheetOf(Note)","inner":{"t":"resheet.sheet","v":2,"lines":[{"id":0,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"/Code","note":{"type":"block","isInstantiated":true,"code":"Code","state":"function scan(array, init, fn) {\n  const steps = []\n  array.reduce(\n    (acc, item) => {\n      const newAcc = fn(acc, item)\n      steps.push(newAcc)\n      return newAcc\n    },\n    init,\n  )\n  return steps\n}\n\nfunction addColumn(table, colName, colValues) {\n  return lodash.zipWith(\n    table,\n    colValues,\n    (row, col) => ({ ...row, [colName]: col }),\n  )\n}\n\nfunction timeScaleArgs(data, dataKey) {\n  const timeValues = data.map(row => row[dataKey].valueOf());\n  const scale = (\n    libs.d3Scale.scaleTime()\n      .domain([\n        Math.min(...timeValues),\n        Math.max(...timeValues),\n      ])\n  )\n  \n  return {\n    domain: scale.domain().map(date => date.valueOf()),\n    scale,\n    type: 'number',\n    ticks: scale.ticks(5).map(date => date.valueOf()),\n    data,\n    dataKey,\n  }\n}\n\n({\n  scan,\n  addColumn,\n  timeScaleArgs,\n})"}}}]}},"isCollapsed":true,"children":[]}]},{"id":5,"name":"CV","state":{"t":"resheet.selector","v":0,"mode":"run","expr":"SheetOf(Note)","inner":{"t":"resheet.sheet","v":2,"lines":[{"id":33,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"# CV","note":{"type":"text","tag":"h1","text":"CV"}}},{"id":34,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"Helper Components:","note":{"type":"text","tag":"p","text":"Helper Components:"}}},{"id":29,"name":"C","visibility":"result","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"= Components","note":{"type":"expr","code":" Components"}}},{"id":43,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"","note":{"type":"text","tag":"p","text":""}}},{"id":53,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"Most parts here have their code hidden (indicated by a yellow line when selected). To show the code select a line and press C-m.","note":{"type":"text","tag":"p","text":"Most parts here have their code hidden (indicated by a yellow line when selected). To show the code select a line and press C-m."}}},{"id":54,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"","note":{"type":"text","tag":"p","text":""}}},{"id":52,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"Data:","note":{"type":"text","tag":"p","text":"Data:"}}},{"id":44,"name":"addressShort","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"= \"WorksTown, HustleNation\"","note":{"type":"expr","code":" \"WorksTown, HustleNation\""}}},{"id":49,"name":"addressLong","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"= \"Doesit Street 13, 12345 WorksTown, HustleNation\"","note":{"type":"expr","code":" \"Doesit Street 13, 12345 WorksTown, HustleNation\""}}},{"id":50,"name":"phone","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"= \"+00 123 456789\"","note":{"type":"expr","code":" \"+00 123 456789\""}}},{"id":51,"name":"email","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"= \"jane.doe@prettygood.solutions\"","note":{"type":"expr","code":" \"jane.doe@prettygood.solutions\""}}},{"id":47,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"","note":{"type":"text","tag":"p","text":""}}},{"id":48,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"","note":{"type":"text","tag":"p","text":""}}},{"id":37,"name":"header","visibility":"result","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"/Code","note":{"type":"block","isInstantiated":true,"code":"Code","state":"<C.CVHeader\n  name=\"Jane Doe\"\n  description={<>\n    A highly specialised solutions developer, evaluating your requirements {}\n    with high fidelity, with 15+ years experience in customer satisfaction.\n  </>}\n  contact={<>\n    {addressShort}<br/>\n    {phone}<br/>\n    {email}<br/>\n  </>}\n  />"}}},{"id":20,"name":"experienceSection","visibility":"result","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"/Code","note":{"type":"block","isInstantiated":true,"code":"Code","state":"<>\n  <C.SectionHeader>Professional Experience</C.SectionHeader>\n\n  <C.Experience\n    period={<C.OpenPeriod start=\"2023/04\" />}\n    title=\"Satisfaction Tracker\"\n    role=\"Founder\"\n    description={\n      <ul className=\"list-disc ml-5 space-y-1\">\n        <li>\n          Oversaw development of the Satisfaction Tracker \n        </li>\n        <li>\n          Grew satisfaction 200% in 12 months\n        </li>\n        <li>\n          Cut costs by 75%\n        </li>\n      </ul>\n    }\n    tech=\"HustleScript, Reorganize, Quibble\"\n    />\n\n  <C.Experience\n    period={<C.ClosedPeriod start=\"2017/03\" end=\"2023/02\" />}\n    title=\"Solution Refiner\"\n    company=\"Solutions Inc.\"\n    role=\"Staff Solver\"\n    description={<>\n      Implemented solutions which improved ratings by 99.9%.\n    </>}\n    tech=\"HustleScript, SolutionSQL, TalkingMQ\"\n    />\n    \n  <C.Experience\n    hide\n    period={<C.ClosedPeriod start=\"2016/01\" end=\"2017/01\" />}\n    title=\"HyperProduct\"\n    company=\"StartUp Fast\"\n    role=\"Solution Intern\"\n    description={<>\n      Implemented multiple frontend components.\n    </>}\n    tech=\"HustleScript, Reorganize\"\n    />\n    \n</>"}}},{"id":22,"name":"skillsSection","visibility":"result","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"/Code","note":{"type":"block","isInstantiated":true,"code":"Code","state":"function SkillsSectionName({ children }) {\n  return <span className={`text-${Style.colors.gray}`}>{children}</span>\n}\n\n<>\n  <C.SectionHeader breakPage>Skills</C.SectionHeader>\n  \n  <C.Section\n    left={<SkillsSectionName>Programming Languages</SkillsSectionName>}\n  >\n    <C.Skills>\n      {{\n        \"HustleScript\": \"very good\",\n        \"NoScript\":     \"good\",\n        \"Fortran\":      \"basic\",\n      }}\n    </C.Skills>\n  </C.Section>\n\n  <C.Section\n    left={<SkillsSectionName>Frameworks</SkillsSectionName>}\n  >\n    <C.Skills>\n      {{\n        \"Reorganize\": \"very good\",\n      }}\n    </C.Skills>\n  </C.Section>\n\n  <C.Section\n    left={<SkillsSectionName>Tools</SkillsSectionName>}\n  >\n    <C.Skills>\n      {{\n        \"Computers\":   \"very good\",\n        \"SolutionSQL\": \"good\",\n        \"Scissors\":    \"basic\",\n      }}\n    </C.Skills>\n  </C.Section>\n</>"}}},{"id":24,"name":"educationSection","visibility":"result","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"/Code","note":{"type":"block","isInstantiated":true,"code":"Code","state":"<>\n  <C.SectionHeader breakPage>Education</C.SectionHeader>\n  \n  <C.Section\n    left={<C.ClosedPeriod start=\"2000\" end=\"2010\" />}\n  >\n    <h3 className=\"text-lg leading-7\">\n      Master of Solutions in Complicated Problems\n    </h3>\n    \n    <p className={`leading-8 text-${Style.colors.gray}`}>\n      Research Institute of Technology\n    </p>\n    \n    <p className=\"mt-2\">\n      Thesis: Optimizating Solutions with tight time constraints\n    </p>\n  </C.Section>\n  \n  <C.Section\n    left={<C.PeriodYear year=\"1999\" />}\n  >\n    <h3 className=\"text-lg leading-7\">\n      High School\n    </h3>\n    \n    <p className={`leading-8 text-${Style.colors.gray}`}>\n      WorksTown High School\n    </p>\n  </C.Section>\n</>"}}},{"id":26,"name":"engagementSection","visibility":"result","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"/Code","note":{"type":"block","isInstantiated":true,"code":"Code","state":"<>\n  <C.SectionHeader>Engagement</C.SectionHeader>\n  \n  <C.Section\n    left={<C.ClosedPeriod start=\"2000\" end=\"2010\" />}\n  >\n    <h3 className=\"text-lg leading-7\">\n      Volunteering at DoGood\n    </h3>\n    \n    <p className={`leading-8 text-${Style.colors.gray}`}>\n      Helped people\n    </p>\n  </C.Section>\n\n  <C.Section\n    left={<C.ClosedPeriod start=\"2012\" end=\"2014\" />}\n  >\n    <h3 className=\"text-lg leading-7\">\n      Volunteering at AwesomeHelp\n    </h3>\n    \n    <p className={`leading-8 text-${Style.colors.gray}`}>\n      Organized support groups\n    </p>\n  </C.Section>\n</>"}}},{"id":30,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"","note":{"type":"text","tag":"p","text":""}}},{"id":31,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"","note":{"type":"text","tag":"p","text":""}}},{"id":32,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"","note":{"type":"text","tag":"p","text":""}}},{"id":38,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"# CV Short","note":{"type":"text","tag":"h1","text":"CV Short"}}},{"id":39,"name":"","visibility":"result","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"/Code","note":{"type":"block","isInstantiated":true,"code":"Code","state":"<C.Document>\n  <main className={`font-['Arial'] mx-20 mb-28 text-${Style.colors.black}`}>  \n    <C.PageMargin bottom=\"2cm\">\n      {header}\n      \n      {experienceSection}\n            \n    </C.PageMargin>\n  </main>\n\n  <C.CVFooter address={addressLong} phone={phone} email={email} />\n</C.Document>"}}},{"id":40,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"","note":{"type":"text","tag":"p","text":""}}},{"id":41,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"","note":{"type":"text","tag":"p","text":""}}},{"id":42,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"","note":{"type":"text","tag":"p","text":""}}},{"id":27,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"# CV Long","note":{"type":"text","tag":"h1","text":"CV Long"}}},{"id":28,"name":"","visibility":"result","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"/Code","note":{"type":"block","isInstantiated":true,"code":"Code","state":"<C.Document>\n  <main className={`font-['Arial'] mx-20 mb-28 text-${Style.colors.black}`}>  \n    <C.PageMargin bottom=\"2cm\">\n      {header}\n      \n      {experienceSection}\n      \n      {skillsSection}\n      \n      {educationSection}\n      \n      {engagementSection}\n      \n    </C.PageMargin>\n  </main>\n\n  <C.CVFooter address={addressLong} phone={phone} email={email} />\n</C.Document>"}}}]}},"isCollapsed":true,"children":[{"id":2,"name":"Style","state":{"t":"resheet.selector","v":0,"mode":"run","expr":"SheetOf(Note)","inner":{"t":"resheet.sheet","v":2,"lines":[{"id":1,"name":"colors","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"/Code","note":{"type":"block","isInstantiated":true,"code":"Code","state":"({\n  primary: 'sky-700',\n  primaryLight: 'sky-500',\n  gray: 'slate-500',\n  grayDark: 'slate-700',\n  grayLight: 'slate-400',\n  black: 'slate-900',\n})"}}},{"id":2,"name":"sizes","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"/Code","note":{"type":"block","isInstantiated":true,"code":"Code","state":"({\n  leftCol: \"[120px]\",\n})"}}},{"id":4,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"","note":{"type":"text","tag":"p","text":""}}},{"id":3,"name":"export","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"= { colors, sizes }","note":{"type":"expr","code":" { colors, sizes }"}}}]}},"isCollapsed":false,"children":[]},{"id":1,"name":"Components","state":{"t":"resheet.selector","v":0,"mode":"run","expr":"SheetOf(Note)","inner":{"t":"resheet.sheet","v":2,"lines":[{"id":1,"name":"Document","visibility":"result","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"/Code","note":{"type":"block","isInstantiated":true,"code":"Code","state":"function renderDocument(content) {\n  return ReactDomServer.renderToString(\n      <html>\n        <head>\n          <style>{`\n            @page {\n              margin: 2cm 0 0 0;\n            }\n          `}</style>\n          <script src=\"https://cdn.tailwindcss.com\" />\n        </head>\n        <body className=\"bg-white mt-14 print:mt-0\">\n          {content}\n        </body>\n      </html>\n    )\n}\n  \nfunction Document({children}) {\n  const iframeRef = React.useRef()\n  \n  function onPrintIframe() {\n    iframeRef.current?.contentWindow?.print()\n  }\n  \n  return (\n    <div className=\"flex flex-col items-stretch space-y-2\">\n      <div className=\"overflow-x-auto\">\n        <iframe\n          ref={iframeRef}\n          className=\"border h-screen w-full min-w-[768px]\"\n          srcDoc={renderDocument(children)}\n          />\n      </div>\n      <button\n        className=\"px-3 py-1 rounded bg-blue-100 hover:bg-blue-200\"\n        onClick={() => onPrintIframe()}\n      >\n        Print\n      </button>\n    </div>\n  )\n}"}}},{"id":2,"name":"PageMargin","visibility":"result","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"/Code","note":{"type":"block","isInstantiated":true,"code":"Code","state":"function PageMargin({ top = 0, bottom = 0, children }) {\n  // Workaround to get margins on every page while still being able\n  // to create fixed content inside the margins (footers/headers)\n  return (\n    <table>\n      <thead className={`h-[${top}]`} />\n      <tbody>\n        <tr>\n          <td>{children}</td>\n        </tr>\n      </tbody>\n      <tfoot className={`h-[${bottom}]`} />\n    </table>\n  )\n}"}}},{"id":3,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"","note":{"type":"text","tag":"p","text":""}}},{"id":7,"name":"CVHeader","visibility":"result","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"/Code","note":{"type":"block","isInstantiated":true,"code":"Code","state":"function CVHeader({ name, description, contact }) {\n  return (\n    <>\n      <div className=\"flex mb-8 justify-between items-start\">\n        <div>\n          <h1 className={`font-bold text-4xl text-${Style.colors.primary} leading-normal`}>\n            {name}\n          </h1>\n          <span className={`text-xl italic text-${Style.colors.gray}`}>\n            Curriculum Vitae\n          </span>\n        </div>\n  \n        {/* Contact info right */}\n        <address className={`leading-relaxed not-italic flex-end text-right text-${Style.colors.gray}`}>\n          {contact}\n        </address>\n      </div>\n      \n      <div className=\"my-8 px-6 italic font-light leading-tight\">\n        {description}\n      </div>\n\n    </>\n  )\n}"}}},{"id":8,"name":"CVFooter","visibility":"result","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"/Code","note":{"type":"block","isInstantiated":true,"code":"Code","state":"function CVFooter({ address, phone, email }) {\n  return (\n    <footer\n      className={`\n        fixed bottom-0 inset-x-0 px-10 py-4\n        bg-${Style.colors.grayDark}\n        font-['Arial'] text-white\n        flex flex-row justify-between items-baseline space-x-6\n      `}\n    >\n      <address className=\"not-italic\">\n        {address}\n      </address>\n      <address className=\"not-italic text-nowrap\">\n        {phone}\n      </address>\n      <address className=\"not-italic\">\n        {email}\n      </address>\n    </footer>\n  )\n}"}}},{"id":9,"name":"ClosedPeriod","visibility":"result","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"/Code","note":{"type":"block","isInstantiated":true,"code":"Code","state":"function ClosedPeriod({ start, end }) {\n  return (\n    <p className=\"text-lg leading-7\">\n      <span className={`text-${Style.colors.gray} mr-1`}>from</span> {start}\n      <br/>\n      <span className={`text-${Style.colors.gray} mr-1`}>until</span> {end}\n    </p>\n  )\n}"}}},{"id":10,"name":"OpenPeriod","visibility":"result","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"/Code","note":{"type":"block","isInstantiated":true,"code":"Code","state":"function OpenPeriod({ start }) {\n  return (\n    <p className=\"text-lg leading-7\">\n      <span className={`text-${Style.colors.gray} mr-1`}>since</span> {start}\n    </p>\n  )\n}"}}},{"id":11,"name":"PeriodYear","visibility":"result","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"/Code","note":{"type":"block","isInstantiated":true,"code":"Code","state":"function PeriodYear({ year }) {\n  return (\n    <p className=\"text-lg leading-7\">\n      <span className={`text-${Style.colors.gray} mr-1`}>in</span> {year}\n    </p>\n  )\n}"}}},{"id":12,"name":"DescriptionBulletPoints","visibility":"result","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"/Code","note":{"type":"block","isInstantiated":true,"code":"Code","state":"function DescriptionBulletPoints({ children }) {\n  return (\n    <ul className=\"list-disc ml-5 space-y-1\">\n      {children}\n    </ul>\n  )\n}"}}},{"id":13,"name":"SectionHeader","visibility":"result","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"/Code","note":{"type":"block","isInstantiated":true,"code":"Code","state":"function SectionHeader({ breakPage = false, children }) {\n  const line = (\n    <div className={`\n      inline-block mr-4 my-1 h-1.5 w-${Style.sizes.leftCol}\n      bg-${Style.colors.primaryLight}\n    `} />\n  )\n\n  return (\n    <h2 className={`\n      text-xl text-${Style.colors.primary} leading-normal\n      mt-16 mb-4 break-after-avoid-page\n      ${breakPage && 'break-before-page print:mt-4'}\n    `}>\n      {line}\n      {children}\n    </h2>\n  )\n}"}}},{"id":14,"name":"Section","visibility":"result","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"/Code","note":{"type":"block","isInstantiated":true,"code":"Code","state":"function Section({ left, children }) {\n  return (\n    <section className=\"flex flex-row my-8 space-x-4 items-baseline break-inside-avoid-page\">\n      <div className={`shrink-0 w-${Style.sizes.leftCol} text-right`}>\n        {left}\n      </div>\n      \n      <div>\n        {children}\n      </div>\n    </section>\n  )\n}"}}},{"id":15,"name":"Experience","visibility":"result","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"/Code","note":{"type":"block","isInstantiated":true,"code":"Code","state":"function Experience({ period, title, company, role, description, tech, hide = false }) {\n  if (hide) { return null }\n  return (\n    <Section left={period}>\n      <h3 className=\"text-lg leading-7\">\n        {title} {}\n        {company &&\n          <span className={`text-base ml-4 text-${Style.colors.gray}`}>\n            <span className={`text-sm mr-0.5 text-${Style.colors.grayLight}`}>at</span> {}\n            {company}\n          </span>\n        }\n      </h3>\n      \n      <p className=\"leading-7\">\n        <span className={`text-${Style.colors.gray}`}>Role:</span> {role}\n      </p>\n      \n      <div className=\"my-3\">\n        {description}\n      </div>\n      \n      <p className={`text-${Style.colors.gray}`}>\n        Technologies: {tech}\n      </p>\n    </Section>\n  )\n}"}}},{"id":16,"name":"TBody","visibility":"result","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"/Code","note":{"type":"block","isInstantiated":true,"code":"Code","state":"function TBody({ children, className, trClass, tdClass }) {\n  return (\n    <tbody className={className}>\n      {children.map((row, y) => (\n        <tr key={y} className={trClass}>\n          {row.map((cell, x) => (\n            <td key={x} className={tdClass}>\n              {cell}\n            </td>\n          ))}\n        </tr>\n      ))}\n    </tbody>\n  )\n}"}}},{"id":17,"name":"Skills","visibility":"result","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"/Code","note":{"type":"block","isInstantiated":true,"code":"Code","state":"function Skills({ children }) {\n  return (\n    <table className=\"break-inside-avoid-page\">\n      <TBody trClass=\"align-baseline\" tdClass=\"min-w-24\">\n        {Object.entries(children)\n          .map(([topic, desc]) => [\n            topic,\n            <span className={`ml-6 text-${Style.colors.gray}`}>\n              {desc}\n            </span>,\n          ])\n        }\n      </TBody>\n    </table>\n  )\n}"}}},{"id":18,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"","note":{"type":"text","tag":"p","text":""}}},{"id":19,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"","note":{"type":"text","tag":"p","text":""}}},{"id":20,"name":"exports","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"= { Document, PageMargin, CVHeader, CVFooter, ClosedPeriod, OpenPeriod, PeriodYear, DescriptionBulletPoints, SectionHeader, Section, Experience, TBody, Skills }","note":{"type":"expr","code":" { Document, PageMargin, CVHeader, CVFooter, ClosedPeriod, OpenPeriod, PeriodYear, DescriptionBulletPoints, SectionHeader, Section, Experience, TBody, Skills }"}}}]}},"isCollapsed":false,"children":[]}]},{"id":3,"name":"Invoice","state":{"t":"resheet.selector","v":0,"mode":"run","expr":"SheetOf(Note)","inner":{"t":"resheet.sheet","v":2,"lines":[{"id":43,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"# Invoice","note":{"type":"text","tag":"h1","text":"Invoice"}}},{"id":44,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"Load a working hours export (from atWork) and generate an invoice.","note":{"type":"text","tag":"p","text":"Load a working hours export (from atWork) and generate an invoice."}}},{"id":3,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"","note":{"type":"text","tag":"p","text":""}}},{"id":15,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"## Load and Parse CSV","note":{"type":"text","tag":"h2","text":"Load and Parse CSV"}}},{"id":4,"name":"atWorkExportFile","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"/LoadFile","note":{"type":"block","isInstantiated":true,"code":"LoadFile","state":{"state":"loaded","file":{"content":"RWludHLDpGdlOzs7CkJlZ2lubjtFbmRlO1BhdXNlO0RhdWVyCjA0LjEyLjIwMjMgMDk6MjY7MDQuMTIuMjAyMyAxNTowOTsiMSwxODMiOyI0LDUzMyIKMDUuMTIuMjAyMyAwOTo1MzswNS4xMi4yMDIzIDIwOjE2OyIzLDAzMyI7IjcsMzUiCjA2LjEyLjIwMjMgMTQ6NTY7MDYuMTIuMjAyMyAyMjozMzsiMCw5NjciOyI2LDY1IgowOC4xMi4yMDIzIDEyOjA2OzA4LjEyLjIwMjMgMjE6MDA7IjEsNzUiOyI3LDE1IgoxMi4xMi4yMDIzIDEwOjI2OzEyLjEyLjIwMjMgMTE6MzE7OyIxLDA4MyIKMTMuMTIuMjAyMyAwOTo0NDsxMy4xMi4yMDIzIDEyOjU0OyIwLDUiOyIyLDY2NyIKMTMuMTIuMjAyMyAyMDo0NTsxMy4xMi4yMDIzIDIyOjE1OzsiMSw1IgoxNC4xMi4yMDIzIDE2OjM4OzE0LjEyLjIwMjMgMTc6MDU7OyIwLDQ1IgoxNS4xMi4yMDIzIDEyOjMwOzE1LjEyLjIwMjMgMTg6NDU7IjAsNzY3IjsiNSw0ODMiCjE4LjEyLjIwMjMgMDg6Mjc7MTguMTIuMjAyMyAxMjoyNjs7IjMsOTgzIgoxOS4xMi4yMDIzIDE0OjQwOzE5LjEyLjIwMjMgMTg6MTg7OyIzLDYzMyIKMjAuMTIuMjAyMyAwODozNDsyMC4xMi4yMDIzIDE0OjM0OyIwLDQ4MyI7IjUsNTE3IgoyMS4xMi4yMDIzIDE1OjMwOzIxLjEyLjIwMjMgMjM6MDY7MjsiNSw2Igo7OzsK","name":"numbers-export-atwork-2024-04-03-12_21_50.csv","options":{"type":"text/csv","lastModified":1712139710000}}}}}},{"id":7,"name":"atWorkExportParsed","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"= libs.papaparse.parse(await atWorkExportFile.text())","note":{"type":"expr","code":" libs.papaparse.parse(await atWorkExportFile.text())"}}},{"id":8,"name":"","visibility":"result","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"= <reactInspector.TableInspector data={atWorkExportParsed.data} />","note":{"type":"expr","code":" <reactInspector.TableInspector data={atWorkExportParsed.data} />"}}},{"id":9,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"","note":{"type":"text","tag":"p","text":""}}},{"id":17,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"","note":{"type":"text","tag":"p","text":""}}},{"id":18,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"","note":{"type":"text","tag":"p","text":""}}},{"id":16,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"## Convert and Process Data","note":{"type":"text","tag":"h2","text":"Convert and Process Data"}}},{"id":10,"name":"entriesRaw","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"= atWorkExportParsed.data.slice(2, -2)","note":{"type":"expr","code":" atWorkExportParsed.data.slice(2, -2)"}}},{"id":45,"name":"","visibility":"result","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"= <reactInspector.TableInspector data={entriesRaw} />","note":{"type":"expr","code":" <reactInspector.TableInspector data={entriesRaw} />"}}},{"id":36,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"","note":{"type":"text","tag":"p","text":""}}},{"id":37,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"","note":{"type":"text","tag":"p","text":""}}},{"id":13,"name":"workingIntervals","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"/Code","note":{"type":"block","isInstantiated":true,"code":"Code","state":"const parseDate = utils.localized.de.dateParser({ date: 'medium' })\nconst parseTime = utils.localized.de.dateParser({ time: 'short' })\n\nfunction parseDatetime(str) {\n  const [dateStr, timeStr] = str.split(' ')\n  const date = parseDate(dateStr)\n  const time = parseTime(timeStr)\n  return utils.combineDateTime(date, time)\n}\n\nconst parseNumber = utils.localized.de.numberParser()\n\nentriesRaw\n  .map(\n    ([start, end, pause, duration]) => {\n      const turnoverNum = utils.cldr\n      return {\n        start: parseDatetime(start),\n        end: parseDatetime(end),\n        pauseHours: pause ? parseNumber(pause) : 0,\n        workingHours: parseNumber(duration),\n      }\n    }\n  )"}}},{"id":11,"name":"","visibility":"result","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"= <reactInspector.TableInspector data={workingIntervals} />","note":{"type":"expr","code":" <reactInspector.TableInspector data={workingIntervals} />"}}},{"id":34,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"","note":{"type":"text","tag":"p","text":""}}},{"id":35,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"","note":{"type":"text","tag":"p","text":""}}},{"id":30,"name":"workingHoursBy","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"/Code","note":{"type":"block","isInstantiated":true,"code":"Code","state":"function workingHoursBy(dateGroup) {\n  return lodash.chain(workingIntervals)\n    .map(workingInterval => ({\n      ...workingInterval,\n      timestamp: dateGroup(workingInterval).getTime(),\n    }))\n    .groupBy('timestamp')\n    .mapValues(group => ({\n      workingHours: lodash.sumBy(group, 'workingHours'),\n      pauseHours: lodash.sumBy(group, 'pauseHours'),\n    }))\n    .map((workingInterval, timestamp) => ({\n      date: new Date(Number(timestamp)),\n      ...workingInterval,\n    }))\n    .value()\n}"}}},{"id":48,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"","note":{"type":"text","tag":"p","text":""}}},{"id":19,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"","note":{"type":"text","tag":"p","text":""}}},{"id":20,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"","note":{"type":"text","tag":"p","text":""}}},{"id":21,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"## Graphs","note":{"type":"text","tag":"h2","text":"Graphs"}}},{"id":23,"name":"formatDuration","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"= duration => `${Math.trunc(duration)}:${String(Math.round(duration * 60 % 60)).padStart(2, '0')}`","note":{"type":"expr","code":" duration => `${Math.trunc(duration)}:${String(Math.round(duration * 60 % 60)).padStart(2, '0')}`"}}},{"id":26,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"","note":{"type":"text","tag":"p","text":""}}},{"id":31,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"### Working Hours by Day","note":{"type":"text","tag":"h3","text":"Working Hours by Day"}}},{"id":49,"name":"formatDateDay","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"= date => libs.datefns.format(date, \"dd.LL.uu\")","note":{"type":"expr","code":" date => libs.datefns.format(date, \"dd.LL.uu\")"}}},{"id":50,"name":"workingHoursByDay","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"= workingHoursBy(({ start }) => libs.datefns.startOfDay(start))","note":{"type":"expr","code":" workingHoursBy(({ start }) => libs.datefns.startOfDay(start))"}}},{"id":32,"name":"workingHoursByDayChart","visibility":"result","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"/Code","note":{"type":"block","isInstantiated":true,"code":"Code","state":"const { ResponsiveContainer, BarChart, Bar, XAxis, YAxis, Tooltip } = libs.recharts;\n\n<ResponsiveContainer height={300}>\n  <BarChart data={workingHoursByDay}>\n    <Tooltip formatter={formatDuration} labelFormatter={formatDateDay} />\n    <Bar type=\"monotone\" dataKey=\"workingHours\" stackId=\"\" fill=\"#93bc60\" />\n    <Bar type=\"monotone\" dataKey=\"pauseHours\" stackId=\"\" fill=\"orange\" />\n    <XAxis dataKey=\"date\" tickFormatter={formatDateDay} />\n    <YAxis tickFormatter={formatDuration} width={80} />\n  </BarChart>\n</ResponsiveContainer>"}}},{"id":51,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"### Working Hours by Month","note":{"type":"text","tag":"h3","text":"Working Hours by Month"}}},{"id":52,"name":"formatDateMonth","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"= date => libs.datefns.format(date, \"LLL uu\")","note":{"type":"expr","code":" date => libs.datefns.format(date, \"LLL uu\")"}}},{"id":53,"name":"workingHoursByMonth","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"= workingHoursBy(({ start }) => libs.datefns.startOfMonth(start))","note":{"type":"expr","code":" workingHoursBy(({ start }) => libs.datefns.startOfMonth(start))"}}},{"id":54,"name":"","visibility":"result","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"/Code","note":{"type":"block","isInstantiated":true,"code":"Code","state":"const { ResponsiveContainer, BarChart, Bar, XAxis, YAxis, Tooltip } = libs.recharts;\n\n<ResponsiveContainer height={300}>\n  <BarChart data={workingHoursByMonth}>\n    <Tooltip formatter={formatDuration} labelFormatter={formatDateMonth} />\n    <Bar type=\"monotone\" dataKey=\"workingHours\" stackId=\"\" fill=\"#93bc60\" />\n    <XAxis dataKey=\"date\" tickFormatter={formatDateMonth} />\n    <YAxis tickFormatter={formatDuration} width={80} />\n  </BarChart>\n</ResponsiveContainer>"}}},{"id":55,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"","note":{"type":"text","tag":"p","text":""}}},{"id":56,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"## Invoice","note":{"type":"text","tag":"h2","text":"Invoice"}}},{"id":58,"name":"hourlyWage","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"= 75","note":{"type":"expr","code":" 75"}}},{"id":73,"name":"taxRate","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"= 0.19","note":{"type":"expr","code":" 0.19"}}},{"id":74,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"","note":{"type":"text","tag":"p","text":""}}},{"id":59,"name":"invoiceData","visibility":"result","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"/blocks.JSExpr","note":{"type":"block","isInstantiated":true,"code":"blocks.JSExpr","state":"workingHoursByDay\n  .map(entry => ({\n    ...entry,\n    workingHoursRound: utils.roundOn(entry.workingHours, 0.25),\n  }))\n  .map(entry => ({\n    ...entry,\n    price: utils.roundOn(entry.workingHoursRound * hourlyWage, 0.01),\n  }))"}}},{"id":75,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"","note":{"type":"text","tag":"p","text":""}}},{"id":62,"name":"invoiceSum","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"= lodash.sumBy(invoiceData, 'price')","note":{"type":"expr","code":" lodash.sumBy(invoiceData, 'price')"}}},{"id":63,"name":"invoiceTaxes","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"= utils.roundOn(invoiceSum * taxRate, 0.01)","note":{"type":"expr","code":" utils.roundOn(invoiceSum * taxRate, 0.01)"}}},{"id":64,"name":"invoiceTotal","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"= utils.roundOn(invoiceSum + invoiceTaxes, 0.01)","note":{"type":"expr","code":" utils.roundOn(invoiceSum + invoiceTaxes, 0.01)"}}},{"id":70,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"","note":{"type":"text","tag":"p","text":""}}},{"id":71,"name":"locale","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"= \"en\"","note":{"type":"expr","code":" \"en\""}}},{"id":72,"name":"currency","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"= \"USD\"","note":{"type":"expr","code":" \"USD\""}}},{"id":76,"name":"fmt","visibility":"result","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"/blocks.JSExpr","note":{"type":"block","isInstantiated":true,"code":"blocks.JSExpr","state":"({\n  currency: Intl.NumberFormat(locale, {\n    style: 'currency',\n    currency,\n  }),\n  date: Intl.DateTimeFormat(locale, {\n    dateStyle: 'short',\n  }), \n  percent: Intl.NumberFormat(locale, {\n    style: 'percent',\n  }),\n})"}}},{"id":77,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"","note":{"type":"text","tag":"p","text":""}}},{"id":57,"name":"invoiceTable","visibility":"result","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"/Code","note":{"type":"block","isInstantiated":true,"code":"Code","state":"<table className=\"w-full\">\n  <thead className=\"font-bold bg-sky-100\">\n    <tr>\n      <th className=\"p-2 text-left\">Project</th>\n      <th className=\"p-2 text-center w-28\">Date</th>\n      <th className=\"p-2 text-right w-40\">Working Hours</th>\n      <th className=\"p-2 text-right w-28\">Price</th>\n    </tr>\n  </thead>\n  \n  {/*\n    \"Padding\" at the table bottom, so the content doesn't hide\n    below the footer when printing.\n  */}\n  <tfoot className=\"hidden print:table-footer-group\">\n    <tr className=\"h-28\"><td/></tr>\n  </tfoot>\n\n  <tbody>\n    {invoiceData.map(({ date, workingHoursRound, price }) => (\n      <tr className=\"even:bg-slate-100\">\n        <td className=\"px-2 py-1.5\">\n          BuildTheFuture\n        </td>\n        <td className=\"px-2 py-1.5 text-center\">\n          {fmt.date.format(date)}\n        </td>\n        <td className=\"px-2 py-1.5 text-right\">\n          {formatDuration(workingHoursRound)} h\n        </td>\n        <td className=\"px-2 py-1.5 text-right\">\n          {fmt.currency.format(price)}\n        </td>\n      </tr>\n    ))}\n    \n    {/*\n      Footer not in <tfoot> because otherwise\n      it get's repeated on every printed page\n    */}\n    <tr className=\"font-medium bg-sky-100 border-t-2 border-white break-before-avoid-page\">\n      <td colspan={3} className=\"p-2 text-right\">\n        Sum\n      </td>\n      <td className=\"p-2 text-right\">\n        {fmt.currency.format(invoiceSum)}\n      </td>\n    </tr>\n    <tr className=\"font-medium bg-sky-100 border-t-2 border-white break-before-avoid-page\">\n      <td colSpan={3} className=\"p-2 text-right\">\n        {fmt.percent.format(taxRate)} Taxes\n      </td>\n      <td className=\"p-2 text-right\">\n        {fmt.currency.format(invoiceTaxes)}\n      </td>\n    </tr>\n    <tr className=\"font-bold bg-sky-100 border-t-2 border-white break-before-avoid-page\">\n      <td colSpan={3} className=\"p-2 text-right\">\n        Total\n      </td>\n      <td className=\"p-2 text-right\">\n        {fmt.currency.format(invoiceTotal)}\n      </td>\n    </tr>\n  </tbody>\n</table>"}}},{"id":65,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"","note":{"type":"text","tag":"p","text":""}}},{"id":66,"name":"Document","visibility":"result","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"/Code","note":{"type":"block","isInstantiated":true,"code":"Code","state":"function renderDocument(content) {\n  return ReactDomServer.renderToString(\n      <html>\n        <head>\n          <style>{`\n            @page {\n              margin: 2cm 0 0 0;\n            }\n          `}</style>\n          <script src=\"https://cdn.tailwindcss.com\" />\n        </head>\n        <body className=\"bg-white\">\n          {content}\n        </body>\n      </html>\n    )\n}\n  \nfunction Document({children}) {\n  const iframeRef = React.useRef()\n  \n  function onPrintIframe() {\n    iframeRef.current?.contentWindow?.print()\n  }\n  \n  return (\n    <div className=\"flex flex-col items-stretch space-y-2\">\n      <div className=\"overflow-x-auto\">\n        <iframe\n          ref={iframeRef}\n          className=\"border min-w-[768px]\"\n          height=\"1200\"\n          srcDoc={renderDocument(children)}\n          />\n      </div>\n      <button\n        className=\"px-3 py-1 rounded bg-blue-100 hover:bg-blue-200\"\n        onClick={() => onPrintIframe()}\n      >\n        Print\n      </button>\n    </div>\n  )\n}"}}},{"id":68,"name":"invoiceDocument","visibility":"result","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"/Code","note":{"type":"block","isInstantiated":true,"code":"Code","state":"const invoiceDate = new Date();\nconst invoiceMonth = libs.datefns.formatDate(invoiceDate, \"yyyy-MM\");\nconst invoiceNo = `${invoiceMonth}-01`;\n\nconst senderName = \"Jane Doe\";\nconst senderDescription = \"PrettyGoodSolutions Consultant\";\nconst senderAddress = [\n  senderName,\n  \"Doesit Street 13\",\n  \"12345 WorksTown\",\n];\nconst senderContact = [\n  \"+00 123 456789\",\n  \"jane.doe@prettygood.solutions\",\n];\nconst senderBank = <>\n  BestBank Inc.<br/>\n  IBAN: DE42 1337 1234 7654 8989 00\n</>;\n\nconst receiverAddress = <>\n  BigCorp Inc.<br/>\n  Large Street 123<br/>\n  99999 MegaCity\n</>;\n\n\n<Document>\n  <main className=\"font-['Arial'] mx-20 mb-28\">\n  \n    {/* Header top right with name and description */}\n    <h1\n      className=\"font-bold text-4xl text-right text-sky-700 leading-normal\"\n    >\n      {senderName}\n    </h1>\n    <div className=\"text-right text-slate-800\">\n      {senderDescription}\n    </div>\n    \n    \n    <div className=\"flex my-12\">\n      {/* Adress sender and receiver left */}\n      <div className=\"flex-1 space-y-2\">\n        <address className=\"text-xs not-italic text-sky-700\">\n          {senderAddress.flatMap(field => [\"•\", field]).slice(1).join(\" \")}\n        </address>\n        <address className=\"leading-tight not-italic\">\n          {receiverAddress}\n        </address>\n      </div>\n      \n      {/* Contact details right */}\n      <address\n        className=\"leading-tight not-italic flex-end text-right text-sm\"\n      >\n        {senderAddress.flatMap(field => [field, <br/>])}\n        <br/>\n        {senderContact.flatMap(field => [field, <br/>])}\n      </address>\n    </div>\n    \n    \n    {/* Message Header */}\n    <h2 className=\"font-bold text-xl text-sky-700 leading-normal\">\n      Invoice\n    </h2>\n    <h3 className=\"flex justify-between leading-normal mt-1 mb-5\">\n      <span>InvoiceNo: {invoiceNo}</span>\n      <span>{fmt.date.format(invoiceDate)}</span>\n    </h3>\n    \n    \n    {/* Message Content */}\n    <article>\n      {invoiceTable}\n    </article>\n    \n  </main>\n  \n  {/* Footer */}\n  <footer\n    className={`\n      fixed bottom-0 h-24 w-screen px-20 py-2\n      bg-slate-600\n      font-['Arial'] text-sm text-white\n      flex flex-row justify-between items-start\n    `}\n  >\n    <div>\n      {senderDescription}<br/>\n      {senderName}\n    </div>\n    <address className=\"not-italic\">\n      {senderBank}\n    </address>\n  </footer>\n</Document>"}}},{"id":78,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"","note":{"type":"text","tag":"p","text":""}}},{"id":69,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"**Note**: When printing make sure to fiddle with the printing settings: Enable backgrounds and disable the header and footer added by the browser. Printing in Chromium-based browsers works best.","note":{"type":"text","tag":"p","text":"**Note**: When printing make sure to fiddle with the printing settings: Enable backgrounds and disable the header and footer added by the browser. Printing in Chromium-based browsers works best."}}},{"id":79,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"","note":{"type":"text","tag":"p","text":""}}},{"id":81,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"","note":{"type":"text","tag":"p","text":""}}},{"id":82,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"## Preview","note":{"type":"text","tag":"h2","text":"Preview"}}},{"id":83,"name":"preview","visibility":"result","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"/Code","note":{"type":"block","isInstantiated":true,"code":"Code","state":"<div>\n<h3 className=\"text-xl mt-4 mb-2\">atWork CSV Export</h3>\n<reactInspector.TableInspector data={entriesRaw} />\n\n<h3 className=\"text-xl mt-4 mb-2\">Working Hours</h3>\n{workingHoursByDayChart}\n\n<h3 className=\"text-xl mt-4 mb-2\">Invoice</h3>\n{invoiceDocument}\n</div>"}}}]}},"isCollapsed":true,"children":[{"id":0,"name":"libs","state":{"t":"resheet.selector","v":0,"mode":"run","expr":"SheetOf(Note)","inner":{"t":"resheet.sheet","v":2,"lines":[{"id":1,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"/Code","note":{"type":"block","isInstantiated":true,"code":"Code","state":"function esmsh(lib) {\n  return import(`https://esm.sh/${lib}?external=react`)\n}\n\nasync function esmshDefault(lib) {\n  return (await esmsh(lib)).default\n}\n\nasync function esmshJson(file) {\n  return (await fetch(`https://esm.sh/${file}`)).json()\n}\n\nasync function awaitValues(obj) {\n  return (\n    lodash.zipObject(\n      Object.keys(obj),\n      await Promise.all(Object.values(obj)),\n    )\n  )\n}\n\nawaitValues({\n  papaparse: esmshDefault('papaparse'),\n  datefns: esmsh('date-fns'),\n  numeral: esmshDefault('numeral'),\n  globalize: esmshDefault('globalize'),\n  \n  // see what's available at: https://github.com/unicode-org/cldr-json/tree/main/cldr-json\n  // see what you need at: http://johnnyreilly.github.io/globalize-so-what-cha-want/\n  cldr: Promise.all([\n    esmshJson('cldr-core/supplemental/likelySubtags.json'),\n    esmshJson('cldr-numbers-modern/main/de/numbers.json'),\n    esmshJson('cldr-core/supplemental/numberingSystems.json'),\n    esmshJson('cldr-dates-modern/main/de/ca-gregorian.json'),\n    esmshJson('cldr-dates-modern/main/de/timeZoneNames.json'),\n    esmshJson('cldr-core/supplemental/timeData.json'),\n    esmshJson('cldr-core/supplemental/weekData.json'),\n  ]),\n  \n  recharts: esmsh('recharts'),\n  d3Scale: esmsh('d3-scale'),\n})"}}}]}},"isCollapsed":true,"children":[]},{"id":2,"name":"utils","state":{"t":"resheet.selector","v":0,"mode":"run","expr":"SheetOf(Note)","inner":{"t":"resheet.sheet","v":2,"lines":[{"id":0,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"/Code","note":{"type":"block","isInstantiated":true,"code":"Code","state":"function scan(array, init, fn) {\n  const steps = []\n  array.reduce(\n    (acc, item) => {\n      const newAcc = fn(acc, item)\n      steps.push(newAcc)\n      return newAcc\n    },\n    init,\n  )\n  return steps\n}\n\nfunction addColumn(table, colName, colValues) {\n  return lodash.zipWith(\n    table,\n    colValues,\n    (row, col) => ({ ...row, [colName]: col }),\n  )\n}\n\nfunction timeScaleArgs(data, dataKey) {\n  const timeValues = data.map(row => row[dataKey].valueOf());\n  const scale = (\n    libs.d3Scale.scaleTime()\n      .domain([\n        Math.min(...timeValues),\n        Math.max(...timeValues),\n      ])\n  )\n  \n  return {\n    domain: scale.domain().map(date => date.valueOf()),\n    scale,\n    type: 'number',\n    ticks: scale.ticks(5).map(date => date.valueOf()),\n    data,\n    dataKey,\n  }\n}\n\nfunction combineDateTime(dateRef, timeRef) {\n  const date = libs.datefns.startOfDay(dateRef)\n  const timeInterval = libs.datefns.interval(\n    libs.datefns.startOfDay(timeRef),\n    timeRef,\n  )\n  return libs.datefns.add(date, libs.datefns.intervalToDuration(timeInterval))\n}\n\nfunction roundOn(num, step) {\n  if (step < 0) {\n    return Math.round(num * step) / step\n  }\n  else if (step < 1) {\n    const stepInv = 1 / step\n    const stepRound = Math.round(stepInv)\n    const stepClean = Math.abs(stepRound - stepInv) < 1e-10 ? stepRound : stepInv\n    return Math.round(num * stepClean) / stepClean\n  }\n  else {\n    return step * Math.round(num / step)\n  }\n}\n\nlibs.cldr.forEach(cldr => libs.globalize.load(cldr));\n\nreturn {\n  scan,\n  addColumn,\n  timeScaleArgs,\n  combineDateTime,\n  roundOn,\n  localized: {\n    de: libs.globalize('de'),\n  },\n}"}}}]}},"isCollapsed":true,"children":[]}]},{"id":2,"name":"Advanced Playground","state":{"t":"resheet.selector","v":0,"mode":"run","expr":"SheetOf(Note)","inner":{"t":"resheet.sheet","v":2,"lines":[{"id":1,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"# Advanced Playground","note":{"type":"text","tag":"h1","text":"Advanced Playground"}}},{"id":2,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"Create custom Blocks and use the Inspect Block to get a glimpse into ReSheet.","note":{"type":"text","tag":"p","text":"Create custom Blocks and use the Inspect Block to get a glimpse into ReSheet."}}},{"id":3,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"","note":{"type":"text","tag":"p","text":""}}},{"id":23,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"## Simple custom Blocks","note":{"type":"text","tag":"h2","text":"Simple custom Blocks"}}},{"id":7,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"Let's build a simple checkbox Block:","note":{"type":"text","tag":"p","text":"Let's build a simple checkbox Block:"}}},{"id":8,"name":"CheckBlock","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"/Code","note":{"type":"block","isInstantiated":true,"code":"Code","state":"label => SimpleBlock(false, ({ ref, state, onUpdate }) =>\n  <label>\n    <input\n      ref={ref}\n      type=\"checkbox\"\n      checked={state}\n      onChange={onUpdate('target.checked')}\n      />\n    {' '}\n    {label}\n  </label>\n)"}}},{"id":9,"name":"input","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"/CheckBlock(\"Does it work?\")","note":{"type":"block","isInstantiated":true,"code":"CheckBlock(\"Does it work?\")","state":true}}},{"id":10,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"= input","note":{"type":"expr","code":" input"}}},{"id":11,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"","note":{"type":"text","tag":"p","text":""}}},{"id":87,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"","note":{"type":"text","tag":"p","text":""}}},{"id":88,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"","note":{"type":"text","tag":"p","text":""}}},{"id":13,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"Having an editable label would be nice:","note":{"type":"text","tag":"p","text":"Having an editable label would be nice:"}}},{"id":14,"name":"CheckEditableBlock","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"/Code","note":{"type":"block","isInstantiated":true,"code":"Code","state":"SimpleBlock(\n  { checked: false, label: '' },\n  ({ ref, state, onUpdate, setState }) => (\n    <label>\n      <input\n        type=\"checkbox\"\n        checked={state.checked}\n        onChange={onUpdate('target.checked', 'checked')}\n        />\n      {' '}\n      <input\n        ref={ref}\n        type=\"text\"\n        value={state.label}\n        placeholder=\"label\"\n        onKeyDown={ev => {\n          if (ev.key === 'Enter') {\n            setState(checked => !checked, 'checked')\n          }\n        }}\n        onChange={onUpdate('target.value', 'label')}\n        />\n    </label>\n  ),\n)"}}},{"id":15,"name":"input2","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"/CheckEditableBlock","note":{"type":"block","isInstantiated":true,"code":"CheckEditableBlock","state":{"checked":true,"label":"This works too"}}}},{"id":16,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"= input2","note":{"type":"expr","code":" input2"}}},{"id":17,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"","note":{"type":"text","tag":"p","text":""}}},{"id":85,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"","note":{"type":"text","tag":"p","text":""}}},{"id":86,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"","note":{"type":"text","tag":"p","text":""}}},{"id":18,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"Build a slider Block:","note":{"type":"text","tag":"p","text":"Build a slider Block:"}}},{"id":20,"name":"SliderBlock","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"/Code","note":{"type":"block","isInstantiated":true,"code":"Code","state":"function SliderBlock(props) {\n  const rangeProps = immutable.merge({ min: 0, max: 100, step: 1 }, props)\n  return SimpleBlock(rangeProps.min ?? 0, ({ ref, state, onUpdate }) =>\n    <input\n      ref={ref}\n      type=\"range\"\n      value={state}\n      {...rangeProps}\n      onChange={onUpdate('target.value', [], Number)}\n    />\n  )\n}"}}},{"id":21,"name":"rangeInput","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"/SliderBlock()","note":{"type":"block","isInstantiated":true,"code":"SliderBlock()","state":37}}},{"id":22,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"= rangeInput","note":{"type":"expr","code":" rangeInput"}}},{"id":24,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"","note":{"type":"text","tag":"p","text":""}}},{"id":25,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"","note":{"type":"text","tag":"p","text":""}}},{"id":26,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"## Builtin Blocks","note":{"type":"text","tag":"h2","text":"Builtin Blocks"}}},{"id":33,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"We already used `Code` many times:","note":{"type":"text","tag":"p","text":"We already used `Code` many times:"}}},{"id":50,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"`/Code`","note":{"type":"text","tag":"p","text":"`/Code`"}}},{"id":34,"name":"codeResult","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"/Code","note":{"type":"block","isInstantiated":true,"code":"Code","state":"12 * 12"}}},{"id":35,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"","note":{"type":"text","tag":"p","text":""}}},{"id":82,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"","note":{"type":"text","tag":"p","text":""}}},{"id":36,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"But we can also take a peek inside with the `Inspect` Block:","note":{"type":"text","tag":"p","text":"But we can also take a peek inside with the `Inspect` Block:"}}},{"id":49,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"`/Debug.Inspect(Code)`","note":{"type":"text","tag":"p","text":"`/Debug.Inspect(Code)`"}}},{"id":37,"name":"inspectCodeResult","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"/Debug.Inspect(Code)","note":{"type":"block","isInstantiated":true,"code":"Debug.Inspect(Code)","state":"Promise.resolve(codeResult)"}}},{"id":38,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"= inspectCodeResult","note":{"type":"expr","code":" inspectCodeResult"}}},{"id":39,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"","note":{"type":"text","tag":"p","text":""}}},{"id":83,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"","note":{"type":"text","tag":"p","text":""}}},{"id":27,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"The `Note` Block, of which every line here consists:","note":{"type":"text","tag":"p","text":"The `Note` Block, of which every line here consists:"}}},{"id":48,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"`/Debug.Inspect(Note)`","note":{"type":"text","tag":"p","text":"`/Debug.Inspect(Note)`"}}},{"id":28,"name":"inspectNoteBlockResult","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"/Debug.Inspect(Note)","note":{"type":"block","isInstantiated":true,"code":"Debug.Inspect(Note)","state":{"t":"resheet.note","v":1,"level":0,"input":"= inspectCodeResult.state","note":{"type":"expr","code":" inspectCodeResult.state"}}}}},{"id":29,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"= inspectNoteBlockResult","note":{"type":"expr","code":" inspectNoteBlockResult"}}},{"id":40,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"","note":{"type":"text","tag":"p","text":""}}},{"id":84,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"","note":{"type":"text","tag":"p","text":""}}},{"id":41,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"### Higher-Order Blocks","note":{"type":"text","tag":"h3","text":"Higher-Order Blocks"}}},{"id":42,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"Higher-Order Blocks embed other Blocks inside of them:","note":{"type":"text","tag":"p","text":"Higher-Order Blocks embed other Blocks inside of them:"}}},{"id":46,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"(The `Inspect` Block was already a very simple example of a higher-order Block)","note":{"type":"text","tag":"p","text":"(The `Inspect` Block was already a very simple example of a higher-order Block)"}}},{"id":43,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"","note":{"type":"text","tag":"p","text":""}}},{"id":44,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"You already know `SheetOf`, it's the Block powering every Page, with an embedded Note:","note":{"type":"text","tag":"p","text":"You already know `SheetOf`, it's the Block powering every Page, with an embedded Note:"}}},{"id":47,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"`/Debug.Inspect(SheetOf(Note))`","note":{"type":"text","tag":"p","text":"`/Debug.Inspect(SheetOf(Note))`"}}},{"id":45,"name":"inspectSheetOfNoteBlockResult","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"/Debug.Inspect(SheetOf(Note))","note":{"type":"block","isInstantiated":true,"code":"Debug.Inspect(SheetOf(Note))","state":{"t":"resheet.sheet","v":2,"lines":[{"id":0,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"This is a line of the SheetOf Block, which contains a Note Block in which this sentence is written.","note":{"type":"text","tag":"p","text":"This is a line of the SheetOf Block, which contains a Note Block in which this sentence is written."}}},{"id":1,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"This is another line.","note":{"type":"text","tag":"p","text":"This is another line."}}},{"id":2,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"= inspectNoteBlockResult.state.note","note":{"type":"expr","code":" inspectNoteBlockResult.state.note"}}}]}}}},{"id":51,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"= inspectSheetOfNoteBlockResult.state.lines","note":{"type":"expr","code":" inspectSheetOfNoteBlockResult.state.lines"}}},{"id":52,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"","note":{"type":"text","tag":"p","text":""}}},{"id":80,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"","note":{"type":"text","tag":"p","text":""}}},{"id":81,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"","note":{"type":"text","tag":"p","text":""}}},{"id":53,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"To be more precise, these pages don't contain the `SheetOf` Block itself but a `BlockSelector` Block pre-set with `SheetOf(Note)`:","note":{"type":"text","tag":"p","text":"To be more precise, these pages don't contain the `SheetOf` Block itself but a `BlockSelector` Block pre-set with `SheetOf(Note)`:"}}},{"id":54,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"`/BlockSelector('SheetOf(Note)', SheetOf(Note))` ","note":{"type":"text","tag":"p","text":"`/BlockSelector('SheetOf(Note)', SheetOf(Note))` "}}},{"id":55,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"/BlockSelector('SheetOf(Note)', SheetOf(Note))","note":{"type":"block","isInstantiated":true,"code":"BlockSelector('SheetOf(Note)', SheetOf(Note))","state":{"t":"resheet.selector","v":0,"mode":"run","expr":"SheetOf(Note)","inner":{"t":"resheet.sheet","v":2,"lines":[{"id":0,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"The `BlockSelector` Block allows you to change the Block inside of it.","note":{"type":"text","tag":"p","text":"The `BlockSelector` Block allows you to change the Block inside of it."}}},{"id":1,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"You can use any other Block, change it at the top left.","note":{"type":"text","tag":"p","text":"You can use any other Block, change it at the top left."}}},{"id":12,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"","note":{"type":"text","tag":"p","text":""}}},{"id":2,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"Be aware:","note":{"type":"text","tag":"p","text":"Be aware:"}}},{"id":9,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":1,"input":"Changing the Block will delete this content here.","note":{"type":"text","tag":"p","text":"Changing the Block will delete this content here."}}},{"id":10,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":1,"input":"_**`C-Z`** or **`esc`** are your friends._","note":{"type":"text","tag":"p","text":"_**`C-Z`** or **`esc`** are your friends._"}}},{"id":11,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"","note":{"type":"text","tag":"p","text":""}}},{"id":3,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"Try:","note":{"type":"text","tag":"p","text":"Try:"}}},{"id":4,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":1,"input":"`Code`","note":{"type":"text","tag":"p","text":"`Code`"}}},{"id":5,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":1,"input":"`SheetOf(Code)`","note":{"type":"text","tag":"p","text":"`SheetOf(Code)`"}}},{"id":6,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":1,"input":"`SheetOf(CheckEditableBlock)`","note":{"type":"text","tag":"p","text":"`SheetOf(CheckEditableBlock)`"}}},{"id":7,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"","note":{"type":"text","tag":"p","text":""}}},{"id":8,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"In the subpage \"SimpleBlock\" of this page (\"Advanced Playground\") you can see an example, where the Page was changed to another Block.","note":{"type":"text","tag":"p","text":"In the subpage \"SimpleBlock\" of this page (\"Advanced Playground\") you can see an example, where the Page was changed to another Block."}}}]}}}}},{"id":56,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"","note":{"type":"text","tag":"p","text":""}}},{"id":78,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"","note":{"type":"text","tag":"p","text":""}}},{"id":79,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"","note":{"type":"text","tag":"p","text":""}}},{"id":101,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"## Custom Higher-Order Block","note":{"type":"text","tag":"h2","text":"Custom Higher-Order Block"}}},{"id":102,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"Building a higher-order Block is more involved, as you have to integrate with the embedded Blocks' calculations.","note":{"type":"text","tag":"p","text":"Building a higher-order Block is more involved, as you have to integrate with the embedded Blocks' calculations."}}},{"id":103,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"Let's build an HStack Block where you can put multiple Blocks in a row. As a simplification, these Blocks won't be able to access each other's values.","note":{"type":"text","tag":"p","text":"Let's build an HStack Block where you can put multiple Blocks in a row. As a simplification, these Blocks won't be able to access each other's values."}}},{"id":104,"name":"HStack","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"/Code","note":{"type":"block","isInstantiated":true,"code":"Code","state":"function HStack(...subblocks) {\n  // wrap the subblocks with some safeguards\n  const safeblocks = subblocks.map(resheet.blocks.component.safeBlock)\n  \n  return SimpleBlock(\n    safeblocks.map(block => block.init),\n    \n    ({ state, fieldDispatcher, env }) => (\n      <div className=\"flex flex-row space-x-2\">\n        {safeblocks.map((block, index) => (\n          <div className=\"overflow-x-auto flex-[1_0_0%]\">\n            <block.Component\n              key={index}\n              state={state[index]}\n              dispatch={fieldDispatcher(index)}\n              env={env}\n              />\n          </div>\n        ))}\n      </div>\n    ),\n    \n    {\n      // What is the value of this Block?\n      // @returns an Array of the subblocks' values\n      getResult(state) {\n        return safeblocks.map((block, index) =>\n          block.getResult(state[index])\n        )\n      },\n      \n      // Load a state from json\n      // dispatch and env are needed, because to load some json one\n      // probably has to evaluate the code already. For example when\n      // we will use this Block and load its saved state from a file,\n      // first this definition of the Block has to be evaluated and\n      // then we can use the following fromJSON function to continue\n      // loading the state.\n      // @returns the loaded state\n      fromJSON(json, dispatch, env) {\n        return safeblocks.map((block, index) =>\n          block.fromJSON(\n            json[index],\n            resheet.util.dispatch.fieldDispatcher(index, dispatch),\n            env,\n          )\n        )\n      },\n      \n      // Converts a state to a JSON-serializable value.\n      // @returns a value that can be stringified (NOT an already\n      //          stringified JSON string!)\n      toJSON(state) {\n        return safeblocks.map((block, index) =>\n          block.toJSON(state[index])\n        )\n      },\n      \n      // Reevaluate the computations inside because some variables\n      // given in the Set<string> changedVars changed.\n      // @returns {\n      //            state: /* the new state */,\n      //            invalidated: /* true, if our value changed and\n      //                          * therefore our dependants have\n      //                          * to be recomputed\n      //                          */,\n      //          }\n      recompute(state, dispatch, env, changedVars) {\n        const recomputations = (\n          safeblocks.map((block, index) =>\n            block.recompute(\n              state[index],\n              resheet.util.dispatch.fieldDispatcher(index, dispatch),\n              env,\n              changedVars,\n            )\n          )\n        )\n        \n        const newStates = recomputations.map(recomp => recomp.state)\n        const invalidated = recomputations.some(recomp => recomp.invalidated)\n        return {\n          state: newStates,\n          invalidated,\n        }\n      },\n    },\n  )\n}"}}},{"id":107,"name":"","visibility":"block","width":"wide","state":{"t":"resheet.note","v":1,"level":0,"input":"`/Debug.Inspect(HStack(SheetOf(Note), Code))`","note":{"type":"text","tag":"p","text":"`/Debug.Inspect(HStack(SheetOf(Note), Code))`"}}},{"id":105,"name":"inspectHStack","visibility":"block","width":"wide","state":{"t":"resheet.note","v":1,"level":0,"input":"/Debug.Inspect(HStack(SheetOf(Note), Code))","note":{"type":"block","isInstantiated":true,"code":"Debug.Inspect(HStack(SheetOf(Note), Code))","state":[{"t":"resheet.sheet","v":2,"lines":[{"id":0,"name":"","visibility":"block","width":"wide","state":{"t":"resheet.note","v":1,"level":0,"input":"Now we can put some stuff side-by-side","note":{"type":"text","tag":"p","text":"Now we can put some stuff side-by-side"}}},{"id":1,"name":"","visibility":"block","width":"wide","state":{"t":"resheet.note","v":1,"level":0,"input":"As we haven't implemented any keybindings we have to click to navigate between the columns","note":{"type":"text","tag":"p","text":"As we haven't implemented any keybindings we have to click to navigate between the columns"}}}]},"const block = HStack(SheetOf(Note), Code)\nblock.toJSON(block.init)"]}}},{"id":106,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"= inspectHStack.state","note":{"type":"expr","code":" inspectHStack.state"}}},{"id":108,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"","note":{"type":"text","tag":"p","text":""}}},{"id":109,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"","note":{"type":"text","tag":"p","text":""}}},{"id":110,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"","note":{"type":"text","tag":"p","text":""}}},{"id":57,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"### Grand Finale","note":{"type":"text","tag":"h3","text":"Grand Finale"}}},{"id":58,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"As the Grand Finale, we're going to embed a whole ReSheet instance:","note":{"type":"text","tag":"p","text":"As the Grand Finale, we're going to embed a whole ReSheet instance:"}}},{"id":59,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"`/Debug.Inspect(DocumentOf(Code))`","note":{"type":"text","tag":"p","text":"`/Debug.Inspect(DocumentOf(Code))`"}}},{"id":95,"name":"inspectReSheetSimple","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"/Debug.Inspect(DocumentOf(Code))","note":{"type":"block","isInstantiated":true,"code":"Debug.Inspect(DocumentOf(Code))","state":{"history":[],"inner":{"t":"resheet.document","v":1,"pages":[{"id":0,"name":"","state":"// This is a simplified version. But we already know how to embed the full version:\n\nblocks.DocumentOf(\n  blocks.BlockSelector(\n    'SheetOf(Note)',\n    blocks.SheetOf(blocks.Note),\n    blocks,\n  )\n)\n\n// Now is only left to inspect the state of this whole document below.","isCollapsed":true,"children":[]}],"viewState":{"sidebarOpen":true,"openPage":[0]},"template":{"id":-1,"name":"","state":"","isCollapsed":true,"children":[]}}}}}},{"id":61,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"= inspectReSheetSimple.state","note":{"type":"expr","code":" inspectReSheetSimple.state"}}},{"id":62,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"","note":{"type":"text","tag":"p","text":""}}},{"id":63,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"","note":{"type":"text","tag":"p","text":""}}},{"id":89,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"","note":{"type":"text","tag":"p","text":""}}},{"id":90,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"#### Full ReSheet Version","note":{"type":"text","tag":"h4","text":"Full ReSheet Version"}}},{"id":64,"name":"DefaultPageBlock","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"= BlockSelector('SheetOf(Note)', SheetOf(Note))","note":{"type":"expr","code":" BlockSelector('SheetOf(Note)', SheetOf(Note))"}}},{"id":65,"name":"ReSheet","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"= DocumentOf(DefaultPageBlock)","note":{"type":"expr","code":" DocumentOf(DefaultPageBlock)"}}},{"id":66,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"","note":{"type":"text","tag":"p","text":""}}},{"id":67,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"Here is the full ReSheet version. Try to save the big ReSheet document and load it inside this small instance:","note":{"type":"text","tag":"p","text":"Here is the full ReSheet version. Try to save the big ReSheet document and load it inside this small instance:"}}},{"id":91,"name":"","visibility":"block","width":"wide","state":{"t":"resheet.note","v":1,"level":0,"input":"`/Debug.Inspect(ReSheet)`","note":{"type":"text","tag":"p","text":"`/Debug.Inspect(ReSheet)`"}}},{"id":96,"name":"inspectReSheet","visibility":"block","width":"wide","state":{"t":"resheet.note","v":1,"level":0,"input":"/Debug.Inspect(ReSheet)","note":{"type":"block","isInstantiated":true,"code":"Debug.Inspect(ReSheet)","state":{"history":[],"inner":{"t":"resheet.document","v":1,"pages":[],"viewState":{"sidebarOpen":true,"openPage":[]},"template":{"id":-1,"name":"","state":{"t":"resheet.selector","v":0,"mode":"run","expr":"SheetOf(Note)","inner":{"t":"resheet.sheet","v":2,"lines":[]}},"isCollapsed":true,"children":[]}}}}}},{"id":69,"name":"","visibility":"block","width":"wide","state":{"t":"resheet.note","v":1,"level":0,"input":"= inspectReSheet.state","note":{"type":"expr","code":" inspectReSheet.state"}}},{"id":70,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"","note":{"type":"text","tag":"p","text":""}}},{"id":71,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"","note":{"type":"text","tag":"p","text":""}}},{"id":72,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"That's it. ReSheet is built to be composable and extensible. Its parts can be plugged together and extended as you like.","note":{"type":"text","tag":"p","text":"That's it. ReSheet is built to be composable and extensible. Its parts can be plugged together and extended as you like."}}},{"id":73,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"","note":{"type":"text","tag":"p","text":""}}},{"id":74,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"","note":{"type":"text","tag":"p","text":""}}},{"id":75,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"","note":{"type":"text","tag":"p","text":""}}},{"id":76,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"## Preview","note":{"type":"text","tag":"h2","text":"Preview"}}},{"id":97,"name":"previewBlockTemplate","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"/Debug.Inspect(SheetOf(Note))","note":{"type":"block","isInstantiated":true,"code":"Debug.Inspect(SheetOf(Note))","state":{"t":"resheet.sheet","v":2,"lines":[{"id":1,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"### Advanced Playground Preview","note":{"type":"text","tag":"h3","text":"Advanced Playground Preview"}}},{"id":2,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"We build these custom Blocks in this Page:","note":{"type":"text","tag":"p","text":"We build these custom Blocks in this Page:"}}},{"id":3,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"","note":{"type":"text","tag":"p","text":""}}},{"id":4,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"`/CheckEditableBlock`","note":{"type":"text","tag":"p","text":"`/CheckEditableBlock`"}}},{"id":5,"name":"checkEditableValue","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"/CheckEditableBlock","note":{"type":"block","isInstantiated":true,"code":"CheckEditableBlock","state":{"checked":true,"label":"This is an editable label"}}}},{"id":6,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"","note":{"type":"text","tag":"p","text":""}}},{"id":7,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"","note":{"type":"text","tag":"p","text":""}}},{"id":8,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"`/SliderBlock()`","note":{"type":"text","tag":"p","text":"`/SliderBlock()`"}}},{"id":9,"name":"sliderBlockValue","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"/SliderBlock()","note":{"type":"block","isInstantiated":true,"code":"SliderBlock()","state":49}}},{"id":10,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"= sliderBlockValue","note":{"type":"expr","code":" sliderBlockValue"}}},{"id":11,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"","note":{"type":"text","tag":"p","text":""}}},{"id":20,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"","note":{"type":"text","tag":"p","text":""}}},{"id":21,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"`/HStack(Code, Code, Code)`","note":{"type":"text","tag":"p","text":"`/HStack(Code, Code, Code)`"}}},{"id":22,"name":"hstack","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"/HStack(Code, Code, Code)","note":{"type":"block","isInstantiated":true,"code":"HStack(Code, Code, Code)","state":["checkEditableValue","sliderBlockValue","12"]}}},{"id":23,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"= hstack","note":{"type":"expr","code":" hstack"}}},{"id":12,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"","note":{"type":"text","tag":"p","text":""}}},{"id":24,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"","note":{"type":"text","tag":"p","text":""}}},{"id":13,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"And we inspect some built-in Blocks:","note":{"type":"text","tag":"p","text":"And we inspect some built-in Blocks:"}}},{"id":14,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"`/Debug.Inspect(Note)`","note":{"type":"text","tag":"p","text":"`/Debug.Inspect(Note)`"}}},{"id":15,"name":"inspectNote","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"/Debug.Inspect(Note)","note":{"type":"block","isInstantiated":true,"code":"Debug.Inspect(Note)","state":{"t":"resheet.note","v":1,"level":0,"input":"= sliderBlockValue","note":{"type":"expr","code":" sliderBlockValue"}}}}},{"id":16,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"= inspectNote.state","note":{"type":"expr","code":" inspectNote.state"}}},{"id":17,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"","note":{"type":"text","tag":"p","text":""}}},{"id":18,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"","note":{"type":"text","tag":"p","text":""}}},{"id":19,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"<span className=\"text-gray-400 text-sm\">Psst: And don't miss the Grand Finale!</span>","note":{"type":"text","tag":"p","text":"<span className=\"text-gray-400 text-sm\">Psst: And don't miss the Grand Finale!</span>"}}}]}}}},{"id":99,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"","note":{"type":"text","tag":"p","text":""}}},{"id":100,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"","note":{"type":"text","tag":"p","text":""}}},{"id":98,"name":"preview","visibility":"result","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"/Code","note":{"type":"block","isInstantiated":true,"code":"Code","state":"Util.WithEnv(\n  env => ({ ...env, CheckBlock, CheckEditableBlock, SliderBlock, HStack }),\n  previewBlockTemplate.derivedBlock,\n)"}}}]}},"isCollapsed":true,"children":[{"id":0,"name":"SimpleBlock","state":{"t":"resheet.selector","v":0,"mode":"run","expr":"Code","inner":"function update(value, path, fn) {\n  if (!path || Array.isArray(path) && path.length === 0) {\n    return fn(value)\n  }\n  else {\n    return immutable.update(value, path, fn)\n  }\n}\n\nfunction SimpleBlock(init, view, desc={}) {\n  return resheet.core.block.create({\n    init,\n    view({ state, dispatch, env }, ref) {\n      function setState(newState, path=[]) {\n        const updateState = (\n          typeof newState === 'function' ?\n            newState\n          :\n            () => newState\n        )\n        \n        dispatch(state => ({\n          state: update(state, path, updateState),\n        }))\n      }\n      \n      function onUpdate(evPath, statePath=[], processValue=lodash.identity) {\n        return ev => {\n          setState(processValue(lodash.get(ev, evPath)), statePath)\n        }\n      }\n      \n      function fieldDispatcher(field) {\n        return resheet.util.dispatch.fieldDispatcher(field, dispatch)\n      }\n      \n      return view({\n        state, dispatch, env, ref,\n        setState, onUpdate, fieldDispatcher,\n      })\n    },\n    getResult(state) { return state },\n    recompute(state) { return { state, invalidated: false } },\n    fromJSON(json) { return json ?? init },\n    toJSON(state) { return state },\n    ...desc,\n  })\n}"},"isCollapsed":false,"children":[]}]},{"id":4,"name":"Interactive Game Dev","state":{"t":"resheet.selector","v":0,"mode":"run","expr":"SheetOf(Note)","inner":{"t":"resheet.sheet","v":2,"lines":[{"id":0,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"# Interactive Game Dev","note":{"type":"text","tag":"h1","text":"Interactive Game Dev"}}},{"id":1,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"Build a custom Game Block for interactively developing a simple game. Leverage existing Blocks to combine them to the tailored needs of a Game Editor.","note":{"type":"text","tag":"p","text":"Build a custom Game Block for interactively developing a simple game. Leverage existing Blocks to combine them to the tailored needs of a Game Editor."}}},{"id":2,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"","note":{"type":"text","tag":"p","text":""}}},{"id":3,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"This is just a showcase of how powerful a custom-built block can be. It doesn't include a step-by-step guide or explanation of the Game Block implementation.","note":{"type":"text","tag":"p","text":"This is just a showcase of how powerful a custom-built block can be. It doesn't include a step-by-step guide or explanation of the Game Block implementation."}}},{"id":4,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"","note":{"type":"text","tag":"p","text":""}}},{"id":7,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"A Game consists of 3 parts:","note":{"type":"text","tag":"p","text":"A Game consists of 3 parts:"}}},{"id":8,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":1,"input":"- The State: defining the current state of the game (where is the character, health, etc)","note":{"type":"text","tag":"li","text":"The State: defining the current state of the game (where is the character, health, etc)"}}},{"id":9,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":1,"input":"- The Update Logic: calculates a new state of the game by simulating a time-step of the game or responding to input","note":{"type":"text","tag":"li","text":"The Update Logic: calculates a new state of the game by simulating a time-step of the game or responding to input"}}},{"id":10,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":1,"input":"- The Render Logic: creates an image corresponding to the state","note":{"type":"text","tag":"li","text":"The Render Logic: creates an image corresponding to the state"}}},{"id":13,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"","note":{"type":"text","tag":"p","text":""}}},{"id":5,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"Therefore you can edit these 3 components:","note":{"type":"text","tag":"p","text":"Therefore you can edit these 3 components:"}}},{"id":6,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":1,"input":"- Initial State: How does the game start?","note":{"type":"text","tag":"li","text":"Initial State: How does the game start?"}}},{"id":11,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":1,"input":"- Update: calculate a new state out of the old state and an input (if it's `undefined` the update is a simulation-step)","note":{"type":"text","tag":"li","text":"Update: calculate a new state out of the old state and an input (if it's `undefined` the update is a simulation-step)"}}},{"id":12,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":1,"input":"- Render: render the game","note":{"type":"text","tag":"li","text":"Render: render the game"}}},{"id":29,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"","note":{"type":"text","tag":"p","text":""}}},{"id":30,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"As everywhere else you can see the live effects of your code changes.","note":{"type":"text","tag":"p","text":"As everywhere else you can see the live effects of your code changes."}}},{"id":14,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"","note":{"type":"text","tag":"p","text":""}}},{"id":31,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"","note":{"type":"text","tag":"p","text":""}}},{"id":32,"name":"","visibility":"block","width":"wide","state":{"t":"resheet.note","v":1,"level":0,"input":"---","note":{"type":"text","tag":"p","text":"---"}}},{"id":33,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"","note":{"type":"text","tag":"p","text":""}}},{"id":40,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"","note":{"type":"text","tag":"p","text":""}}},{"id":16,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"## Simple Animation","note":{"type":"text","tag":"h2","text":"Simple Animation"}}},{"id":18,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"This example doesn't react to input and only runs some simulation. Start and stop with the left button, make a single simulation step with \"Update\" and reset to the initial state with \"Reset\".","note":{"type":"text","tag":"p","text":"This example doesn't react to input and only runs some simulation. Start and stop with the left button, make a single simulation step with \"Update\" and reset to the initial state with \"Reset\"."}}},{"id":17,"name":"","visibility":"block","width":"wide","state":{"t":"resheet.note","v":1,"level":0,"input":"/Game","note":{"type":"block","isInstantiated":true,"code":"Game","state":{"init":"({\n  y: 200,\n  ySpeed: 0,\n})","update":{"t":"resheet.sheet","v":2,"lines":[{"id":0,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"The current state:","note":{"type":"text","tag":"p","text":"The current state:"}}},{"id":1,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"= state","note":{"type":"expr","code":" state"}}},{"id":2,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"","note":{"type":"text","tag":"p","text":""}}},{"id":3,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"Gravity means decelerating:","note":{"type":"text","tag":"p","text":"Gravity means decelerating:"}}},{"id":4,"name":"gravity","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"= { ...state, ySpeed: state.ySpeed - 0.75 }","note":{"type":"expr","code":" { ...state, ySpeed: state.ySpeed - 0.75 }"}}},{"id":5,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"","note":{"type":"text","tag":"p","text":""}}},{"id":6,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"Jumping means getting some upwards velocity:","note":{"type":"text","tag":"p","text":"Jumping means getting some upwards velocity:"}}},{"id":7,"name":"jump","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"= { ...state, ySpeed: 12 }","note":{"type":"expr","code":" { ...state, ySpeed: 12 }"}}},{"id":8,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"","note":{"type":"text","tag":"p","text":""}}},{"id":9,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"Jump if on ground or otherwise let gravity pull us down:","note":{"type":"text","tag":"p","text":"Jump if on ground or otherwise let gravity pull us down:"}}},{"id":10,"name":"forces","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"= state.y <= 0 ? jump : gravity","note":{"type":"expr","code":" state.y <= 0 ? jump : gravity"}}},{"id":11,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"","note":{"type":"text","tag":"p","text":""}}},{"id":12,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"Move according to speed:","note":{"type":"text","tag":"p","text":"Move according to speed:"}}},{"id":13,"name":"newState","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"= { ...forces, y: forces.y + forces.ySpeed }","note":{"type":"expr","code":" { ...forces, y: forces.y + forces.ySpeed }"}}}]},"render":{"t":"resheet.sheet","v":2,"lines":[{"id":1,"name":"","visibility":"block","width":"full","state":{"t":"resheet.note","v":1,"level":0,"input":"/Code","note":{"type":"block","isInstantiated":true,"code":"Code","state":"const height = 400;\nconst tileSize = 64;\nconst ground = height - tileSize;\n\nfunction GameView({ state, update }) {\n  const { running, toggleRunning } = useAnimation(update)\n  \n  return (\n    <div>\n      <div className=\"w-full flex flex-row space-x-2\">\n        <button\n          className={`\n            flex-1 rounded\n            bg-${running ? \"green\" : \"red\"}-100\n            hover:bg-${running ? \"green\" : \"red\"}-200\n          `}\n          onClick={toggleRunning}\n        >\n          {running ? \"Running\" : \"Stopped\"}\n        </button>\n\n        <button\n          className=\"flex-1 rounded bg-blue-100 hover:bg-blue-200\"\n          onClick={() => update(16)}\n        >\n          Step\n        </button>\n      </div> \n      \n      <svg className=\"w-full\" height={height}>\n        <defs>\n          <pattern id=\"platform\" patternUnits=\"userSpaceOnUse\" width={tileSize} height={tileSize}>\n            <image href={Tiles.ground.src} width={tileSize} height={tileSize} />\n          </pattern>\n        </defs>\n      \n        <rect transform=\"translate(0, 336)\" width=\"2000\" height={tileSize} fill=\"url(#platform)\" />\n      \n        <image\n          transform={`\n            translate(100, ${ground - state.y})\n            translate(${-tileSize/2}, ${-tileSize})\n          `}\n          href={Tiles.character.src}\n          width={tileSize}\n          height={tileSize}\n          />\n      </svg>\n    </div>\n  )\n}"}}}]}}}}},{"id":19,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"= $17","note":{"type":"expr","code":" $17"}}},{"id":41,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"","note":{"type":"text","tag":"p","text":""}}},{"id":34,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"","note":{"type":"text","tag":"p","text":""}}},{"id":35,"name":"","visibility":"block","width":"wide","state":{"t":"resheet.note","v":1,"level":0,"input":"---","note":{"type":"text","tag":"p","text":"---"}}},{"id":36,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"","note":{"type":"text","tag":"p","text":""}}},{"id":20,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"","note":{"type":"text","tag":"p","text":""}}},{"id":21,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"# Input","note":{"type":"text","tag":"h1","text":"Input"}}},{"id":22,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"We add some keyboard input handling and extend the character to be able to move left and right.","note":{"type":"text","tag":"p","text":"We add some keyboard input handling and extend the character to be able to move left and right."}}},{"id":15,"name":"","visibility":"block","width":"wide","state":{"t":"resheet.note","v":1,"level":0,"input":"/Game","note":{"type":"block","isInstantiated":true,"code":"Game","state":{"init":"({\n  x: 100,\n  y: 400,\n  xSpeed: 0,\n  ySpeed: 0,\n})","update":{"t":"resheet.sheet","v":2,"lines":[{"id":0,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"The current state:","note":{"type":"text","tag":"p","text":"The current state:"}}},{"id":1,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"= state","note":{"type":"expr","code":" state"}}},{"id":2,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"### Simulation","note":{"type":"text","tag":"h3","text":"Simulation"}}},{"id":3,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"Gravity means decelerating:","note":{"type":"text","tag":"p","text":"Gravity means decelerating:"}}},{"id":4,"name":"gravity","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"= { ...state, ySpeed: state.ySpeed - 0.75 }","note":{"type":"expr","code":" { ...state, ySpeed: state.ySpeed - 0.75 }"}}},{"id":5,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"","note":{"type":"text","tag":"p","text":""}}},{"id":6,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"Jumping means getting some upwards velocity:","note":{"type":"text","tag":"p","text":"Jumping means getting some upwards velocity:"}}},{"id":7,"name":"jump","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"= { ...state, ySpeed: 12 }","note":{"type":"expr","code":" { ...state, ySpeed: 12 }"}}},{"id":8,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"","note":{"type":"text","tag":"p","text":""}}},{"id":9,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"Jump if on ground or otherwise let gravity pull us down:","note":{"type":"text","tag":"p","text":"Jump if on ground or otherwise let gravity pull us down:"}}},{"id":10,"name":"forces","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"= state.y <= 0 ? jump : gravity","note":{"type":"expr","code":" state.y <= 0 ? jump : gravity"}}},{"id":11,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"","note":{"type":"text","tag":"p","text":""}}},{"id":12,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"Move according to speed:","note":{"type":"text","tag":"p","text":"Move according to speed:"}}},{"id":13,"name":"simulation","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"= {\n  ...forces,\n  x: forces.x + forces.xSpeed,\n  y: forces.y + forces.ySpeed,\n}","note":{"type":"expr","code":" {\n  ...forces,\n  x: forces.x + forces.xSpeed,\n  y: forces.y + forces.ySpeed,\n}"}}},{"id":14,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"","note":{"type":"text","tag":"p","text":""}}},{"id":15,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"### React to Input","note":{"type":"text","tag":"h3","text":"React to Input"}}},{"id":16,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"= input","note":{"type":"expr","code":" input"}}},{"id":17,"name":"reaction","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"/Code","note":{"type":"block","isInstantiated":true,"code":"Code","state":"if (!input) return;\n\nconst xSpeed = (\n  input.type === 'simulate' ?\n    state.xSpeed\n  : input.type === 'keyup' ? // This is not 100% correct, but let's keep it simple\n    0\n  : input.key === 'ArrowLeft' ?\n    -3\n  : input.key === 'ArrowRight' ?\n    3\n  :\n    state.xSpeed\n)\n\nreturn {\n  ...state,\n  xSpeed,\n}"}}},{"id":18,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"","note":{"type":"text","tag":"p","text":""}}},{"id":19,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"### Final State","note":{"type":"text","tag":"h3","text":"Final State"}}},{"id":20,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"Decide which state to use based on the input:","note":{"type":"text","tag":"p","text":"Decide which state to use based on the input:"}}},{"id":21,"name":"finalState","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"= input && input.type !== 'simulate' ? reaction : simulation","note":{"type":"expr","code":" input && input.type !== 'simulate' ? reaction : simulation"}}}]},"render":{"t":"resheet.sheet","v":2,"lines":[{"id":0,"name":"","visibility":"block","width":"full","state":{"t":"resheet.note","v":1,"level":0,"input":"/Code","note":{"type":"block","isInstantiated":true,"code":"Code","state":"const height = 400;\nconst tileSize = 64;\nconst ground = height - tileSize;\n\nfunction GameView({ state, update }) {\n  const { running, toggleRunning } = useAnimation(dt => update({ type: 'simulate', dt }))\n  \n  function react(ev) {\n    ev.preventDefault()\n    ev.stopPropagation()\n    \n    update(ev) // runs an update with `input` set to `ev`\n  }\n\n  return (\n    <div>\n      <div className=\"w-full flex flex-row space-x-2\">\n        <button\n          className={`\n            flex-1 rounded\n            bg-${running ? \"green\" : \"red\"}-100\n            hover:bg-${running ? \"green\" : \"red\"}-200\n          `}\n          onClick={toggleRunning}\n        >\n          {running ? \"Running\" : \"Stopped\"}\n        </button>\n\n        <button\n          className=\"flex-1 rounded bg-blue-100 hover:bg-blue-200\"\n          onClick={() => update({ type: 'simulate', dt: 16 })}\n        >\n          Step\n        </button>\n      </div> \n\n      <svg\n        tabIndex={-1}\n        className=\"w-full\"\n        height={height}\n        onKeyDown={react}\n        onKeyUp={react}\n      >\n        <defs>\n          <pattern id=\"platform\" patternUnits=\"userSpaceOnUse\" width={tileSize} height={tileSize}>\n            <image href={Tiles.ground.src} width={tileSize} height={tileSize} />\n          </pattern>\n        </defs>\n      \n        <rect transform=\"translate(0, 336)\" width=\"2000\" height={tileSize} fill=\"url(#platform)\" />\n      \n        <image\n          transform={`\n            translate(${state.x}, ${ground - state.y})\n            scale(${state.xSpeed < 0 ? 1 : -1}, 1)\n            translate(${-tileSize/2}, ${-tileSize})\n          `}\n          href={Tiles.character.src}\n          width={tileSize}\n          height={tileSize}\n          />\n      </svg>\n    </div>\n  )\n}"}}}]}}}}},{"id":24,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"","note":{"type":"text","tag":"p","text":""}}},{"id":37,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"","note":{"type":"text","tag":"p","text":""}}},{"id":38,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"","note":{"type":"text","tag":"p","text":""}}},{"id":42,"name":"","visibility":"block","width":"wide","state":{"t":"resheet.note","v":1,"level":0,"input":"---","note":{"type":"text","tag":"p","text":"---"}}},{"id":25,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"","note":{"type":"text","tag":"p","text":""}}},{"id":39,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"","note":{"type":"text","tag":"p","text":""}}},{"id":26,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"## Real Game","note":{"type":"text","tag":"h2","text":"Real Game"}}},{"id":27,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"Let's make it a \"real\" game by adding some enemies, lives, mobile input, framerate handling and canvas rendering. (Still missing are more visual effects and sounds)","note":{"type":"text","tag":"p","text":"Let's make it a \"real\" game by adding some enemies, lives, mobile input, framerate handling and canvas rendering. (Still missing are more visual effects and sounds)"}}},{"id":43,"name":"realGame","visibility":"block","width":"wide","state":{"t":"resheet.note","v":1,"level":0,"input":"/Debug.Inspect(Game)","note":{"type":"block","isInstantiated":true,"code":"Debug.Inspect(Game)","state":{"init":"({\n  score: 0,\n  lives: 10,\n  character: {\n    x: 100,\n    y: 400,\n    xSpeed: 0,\n    ySpeed: 0,\n  },\n  enemies: [],\n})","update":{"t":"resheet.sheet","v":2,"lines":[{"id":1,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"The current state:","note":{"type":"text","tag":"p","text":"The current state:"}}},{"id":2,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"= state","note":{"type":"expr","code":" state"}}},{"id":58,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"The input:","note":{"type":"text","tag":"p","text":"The input:"}}},{"id":59,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"= input","note":{"type":"expr","code":" input"}}},{"id":61,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"","note":{"type":"text","tag":"p","text":""}}},{"id":60,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"Respect the framerate:","note":{"type":"text","tag":"p","text":"Respect the framerate:"}}},{"id":62,"name":"dt","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"= input?.dt ?? 16","note":{"type":"expr","code":" input?.dt ?? 16"}}},{"id":64,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"Calculate in px/s:","note":{"type":"text","tag":"p","text":"Calculate in px/s:"}}},{"id":63,"name":"factor","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"= dt / 1000","note":{"type":"expr","code":" dt / 1000"}}},{"id":3,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"### Simulate Character","note":{"type":"text","tag":"h3","text":"Simulate Character"}}},{"id":4,"name":"character","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"= state.character","note":{"type":"expr","code":" state.character"}}},{"id":5,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"Gravity means decelerating:","note":{"type":"text","tag":"p","text":"Gravity means decelerating:"}}},{"id":6,"name":"gravity","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"= { ...character, ySpeed: character.ySpeed - 40 * factor }","note":{"type":"expr","code":" { ...character, ySpeed: character.ySpeed - 40 * factor }"}}},{"id":7,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"","note":{"type":"text","tag":"p","text":""}}},{"id":8,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"Jumping means getting some upwards velocity:","note":{"type":"text","tag":"p","text":"Jumping means getting some upwards velocity:"}}},{"id":9,"name":"jump","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"= { ...character, ySpeed: 14 }","note":{"type":"expr","code":" { ...character, ySpeed: 14 }"}}},{"id":10,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"","note":{"type":"text","tag":"p","text":""}}},{"id":11,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"Jump if on ground or otherwise let gravity pull us down:","note":{"type":"text","tag":"p","text":"Jump if on ground or otherwise let gravity pull us down:"}}},{"id":12,"name":"forces","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"= character.y <= 0 ? jump : gravity","note":{"type":"expr","code":" character.y <= 0 ? jump : gravity"}}},{"id":13,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"","note":{"type":"text","tag":"p","text":""}}},{"id":14,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"Move according to speed:","note":{"type":"text","tag":"p","text":"Move according to speed:"}}},{"id":15,"name":"simulatedCharacter","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"= {\n  ...forces,\n  x: forces.x + forces.xSpeed,\n  y: forces.y + forces.ySpeed,\n}","note":{"type":"expr","code":" {\n  ...forces,\n  x: forces.x + forces.xSpeed,\n  y: forces.y + forces.ySpeed,\n}"}}},{"id":16,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"","note":{"type":"text","tag":"p","text":""}}},{"id":17,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"### Simulate Enemies","note":{"type":"text","tag":"h3","text":"Simulate Enemies"}}},{"id":18,"name":"enemies","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"= state.enemies","note":{"type":"expr","code":" state.enemies"}}},{"id":19,"name":"enemySize","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"= 32","note":{"type":"expr","code":" 32"}}},{"id":20,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"","note":{"type":"text","tag":"p","text":""}}},{"id":21,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"Move enemies:","note":{"type":"text","tag":"p","text":"Move enemies:"}}},{"id":22,"name":"movedEnemies","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"= enemies.map(enemyPosition => enemyPosition - 160 * factor)","note":{"type":"expr","code":" enemies.map(enemyPosition => enemyPosition - 160 * factor)"}}},{"id":23,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"","note":{"type":"text","tag":"p","text":""}}},{"id":24,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"Randomly add enemies:","note":{"type":"text","tag":"p","text":"Randomly add enemies:"}}},{"id":25,"name":"addedEnemies","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"= [ ...movedEnemies, ...(Math.random() < 0.6 * factor ? [1300] : []) ]","note":{"type":"expr","code":" [ ...movedEnemies, ...(Math.random() < 0.6 * factor ? [1300] : []) ]"}}},{"id":26,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"","note":{"type":"text","tag":"p","text":""}}},{"id":27,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"Filter enemies that have passed:","note":{"type":"text","tag":"p","text":"Filter enemies that have passed:"}}},{"id":28,"name":"passedAndLeftEnemies","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"= lodash.partition(addedEnemies, enemyPos => enemyPos < -enemySize)","note":{"type":"expr","code":" lodash.partition(addedEnemies, enemyPos => enemyPos < -enemySize)"}}},{"id":29,"name":"passedEnemies","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"= passedAndLeftEnemies[0]","note":{"type":"expr","code":" passedAndLeftEnemies[0]"}}},{"id":30,"name":"leftEnemies","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"= passedAndLeftEnemies[1]","note":{"type":"expr","code":" passedAndLeftEnemies[1]"}}},{"id":31,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"","note":{"type":"text","tag":"p","text":""}}},{"id":32,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"### Lives, Collisions and Score ","note":{"type":"text","tag":"h3","text":"Lives, Collisions and Score "}}},{"id":33,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"Add passed enemies to score:","note":{"type":"text","tag":"p","text":"Add passed enemies to score:"}}},{"id":34,"name":"score","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"= state.score + passedEnemies.length","note":{"type":"expr","code":" state.score + passedEnemies.length"}}},{"id":35,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"","note":{"type":"text","tag":"p","text":""}}},{"id":36,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"Find collisions with enemies:","note":{"type":"text","tag":"p","text":"Find collisions with enemies:"}}},{"id":37,"name":"collidedAndUntouchedEnemies","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"= lodash.partition(leftEnemies, enemyPos =>\n    simulatedCharacter.y <= enemySize\n    && Math.abs(simulatedCharacter.x - enemyPos) <= enemySize\n)","note":{"type":"expr","code":" lodash.partition(leftEnemies, enemyPos =>\n    simulatedCharacter.y <= enemySize\n    && Math.abs(simulatedCharacter.x - enemyPos) <= enemySize\n)"}}},{"id":38,"name":"collidedEnemies","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"= collidedAndUntouchedEnemies[0]","note":{"type":"expr","code":" collidedAndUntouchedEnemies[0]"}}},{"id":39,"name":"untouchedEnemies","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"= collidedAndUntouchedEnemies[1]","note":{"type":"expr","code":" collidedAndUntouchedEnemies[1]"}}},{"id":40,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"","note":{"type":"text","tag":"p","text":""}}},{"id":41,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"Take a life on collision:","note":{"type":"text","tag":"p","text":"Take a life on collision:"}}},{"id":42,"name":"collided","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"= collidedEnemies.length > 0","note":{"type":"expr","code":" collidedEnemies.length > 0"}}},{"id":43,"name":"leftLives","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"= collided ? state.lives - 1 : state.lives","note":{"type":"expr","code":" collided ? state.lives - 1 : state.lives"}}},{"id":44,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"","note":{"type":"text","tag":"p","text":""}}},{"id":45,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"### Final Simulated State","note":{"type":"text","tag":"h3","text":"Final Simulated State"}}},{"id":46,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"One last thing: Are we even still alive to begin with?","note":{"type":"text","tag":"p","text":"One last thing: Are we even still alive to begin with?"}}},{"id":47,"name":"alive","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"= state.lives > 0","note":{"type":"expr","code":" state.lives > 0"}}},{"id":48,"name":"simulation","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"/Code","note":{"type":"block","isInstantiated":true,"code":"Code","state":"!alive ?\n  state\n:\n  {\n    ...state,\n    score,\n    lives: leftLives,\n    character: simulatedCharacter,\n    enemies: untouchedEnemies,\n  }"}}},{"id":49,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"","note":{"type":"text","tag":"p","text":""}}},{"id":50,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"### React to Input","note":{"type":"text","tag":"h3","text":"React to Input"}}},{"id":51,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"= input","note":{"type":"expr","code":" input"}}},{"id":52,"name":"xSpeed","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"/Code","note":{"type":"block","isInstantiated":true,"code":"Code","state":"// input changes character's xSpeed\nconst previous = state.character.xSpeed\n\nconst speed = 250 * factor\n\nif (!input) return previous;\n\n// This is not 100% correct, but let's keep it simple\nif (input.type === 'keyup') return 0;\nif (input.type === 'pointerup') return 0;\n\nif (input.type === 'keydown') {\n  if (input.key === 'ArrowLeft') return -speed;\n  if (input.key === 'ArrowRight') return speed;\n}\n\nif (input.type === 'pointerdown') {\n  const rect = input.target.getBoundingClientRect()\n  if (input.clientX - rect.x < rect.width / 2) return -speed;\n  if (input.clientX - rect.x > rect.width / 2) return speed;\n}\n\nreturn previous"}}},{"id":53,"name":"reaction","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"= { ...state, character: { ...state.character, xSpeed } }","note":{"type":"expr","code":" { ...state, character: { ...state.character, xSpeed } }"}}},{"id":54,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"","note":{"type":"text","tag":"p","text":""}}},{"id":55,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"### Final State","note":{"type":"text","tag":"h3","text":"Final State"}}},{"id":56,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"Decide which state to use based on the input:","note":{"type":"text","tag":"p","text":"Decide which state to use based on the input:"}}},{"id":57,"name":"finalState","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"= input?.type === 'simulate' ? simulation : reaction","note":{"type":"expr","code":" input?.type === 'simulate' ? simulation : reaction"}}}]},"render":{"t":"resheet.sheet","v":2,"lines":[{"id":1,"name":"Controls","visibility":"result","width":"full","state":{"t":"resheet.note","v":1,"level":0,"input":"/Code","note":{"type":"block","isInstantiated":true,"code":"Code","state":"function Controls({ state, update, running, toggleRunning }) {\n  return (\n    <div className=\"w-full flex flex-row space-x-2\">\n      <button\n        className={`\n          flex-1 rounded\n          bg-${running ? \"green\" : \"red\"}-100\n          hover:bg-${running ? \"green\" : \"red\"}-200\n        `}\n        onClick={toggleRunning}\n      >\n        {running ? \"Running\" : \"Stopped - click to play\"}\n      </button>\n\n      <button\n        className=\"flex-1 rounded bg-blue-100 hover:bg-blue-200\"\n        onClick={() => update({ type: 'simulate', dt: 16 })}\n      >\n        Step\n      </button>\n    </div> \n  )\n}"}}},{"id":0,"name":"","visibility":"block","width":"full","state":{"t":"resheet.note","v":1,"level":0,"input":"/Code","note":{"type":"block","isInstantiated":true,"code":"Code","state":"const height = 400;\nconst width = 800;\nconst tileSize = 64;\nconst ground = height - tileSize;\n\nfunction GameView({ state, update }) {\n  const { running, toggleRunning } = useAnimation(dt => update({ type: 'simulate', dt }))\n  \n  function react(ev) {\n    ev.preventDefault()\n    ev.stopPropagation()\n    ev.target.focus()\n    \n    update(ev) // runs an update with `input` set to `ev`\n  }\n  \n  const canvasRef = React.useRef(null)\n  \n  React.useEffect(() => {\n    const canvas = canvasRef.current;\n    const ctx = canvas.getContext('2d');\n    \n    // Setting up canvas dimensions\n    canvas.width = width;\n    canvas.height = height;\n\n    // Draw the platform\n    const ptrn = ctx.createPattern(Tiles.ground, 'repeat');\n    ctx.save();\n    ctx.fillStyle = ptrn;\n    ctx.translate(0, 336);\n    ctx.scale(tileSize / Tiles.ground.naturalWidth, tileSize / Tiles.ground.naturalHeight);\n    ctx.fillRect(0, 0, width, tileSize);\n    ctx.restore();\n\n    // Draw the character\n    ctx.save();\n    ctx.translate(state.character.x, height - tileSize - state.character.y);\n    if (state.lives <= 0) ctx.rotate(90 * Math.PI / 180);\n    if (state.character.xSpeed >= 0) ctx.scale(-1, 1);\n    ctx.drawImage(Tiles.character, -tileSize/2, -tileSize, tileSize, tileSize);\n    ctx.restore();\n\n    // Draw enemies\n    state.enemies.forEach(enemyPos => {\n      ctx.save();\n      ctx.translate(enemyPos, height - tileSize);\n      ctx.scale(0.5, 0.5);\n      ctx.drawImage(Tiles.enemy, -tileSize/2, -tileSize, tileSize, tileSize);\n      ctx.restore();\n    });\n\n    // Draw text\n    ctx.font = '20px Arial';\n    ctx.fillStyle = 'black';\n    ctx.fillText(`Lives: ${\"❤️\".repeat(state.lives)}`, 20, 30);\n    ctx.fillText(`Score: ${state.score} x ⭐️`, 20, 60);\n    \n    ctx.font = '16px Arial';\n    ctx.fillStyle = '#888';\n    ctx.fillText('Use the arrow keys or press on the left and right', 20, 90);\n    \n    if (state.lives <= 0) {\n      ctx.fillStyle = 'red';\n      ctx.font = '40px Arial';\n      ctx.fillText('Game Over', 50, 200);\n    }\n  }, [state]);\n\n\n  return (\n    <div>\n      <Controls state={state} update={update} running={running} toggleRunning={toggleRunning} />\n      <canvas\n        ref={canvasRef}\n        tabIndex={-1}\n        className=\"w-full\"\n        onKeyDown={react}\n        onKeyUp={react}\n        onPointerDownCapture={react}\n        onPointerUpCapture={react}\n        />\n    </div>\n  )\n}"}}}]}}}}},{"id":44,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"","note":{"type":"text","tag":"p","text":""}}},{"id":45,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"","note":{"type":"text","tag":"p","text":""}}},{"id":46,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"","note":{"type":"text","tag":"p","text":""}}},{"id":47,"name":"","visibility":"block","width":"wide","state":{"t":"resheet.note","v":1,"level":0,"input":"---","note":{"type":"text","tag":"p","text":"---"}}},{"id":48,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"","note":{"type":"text","tag":"p","text":""}}},{"id":49,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"## Preview","note":{"type":"text","tag":"h2","text":"Preview"}}},{"id":50,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"","note":{"type":"text","tag":"p","text":""}}},{"id":51,"name":"preview","visibility":"result","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"/Code","note":{"type":"block","isInstantiated":true,"code":"Code","state":"Util.WithEnv(\n  env => ({ ...env, Tiles, useAnimation }),\n  realGame.derivedBlock,\n)"}}}]}},"isCollapsed":true,"children":[{"id":0,"name":"Tiles","state":{"t":"resheet.selector","v":0,"mode":"run","expr":"SheetOf(Note)","inner":{"t":"resheet.sheet","v":2,"lines":[{"id":4,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"# Tiles","note":{"type":"text","tag":"h1","text":"Tiles"}}},{"id":5,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"from kenney.nl","note":{"type":"text","tag":"p","text":"from kenney.nl"}}},{"id":0,"name":"groundFile","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"/LoadFile","note":{"type":"block","isInstantiated":true,"code":"LoadFile","state":{"state":"loaded","file":{"content":"iVBORw0KGgoAAAANSUhEUgAAABIAAAASBAMAAACk4JNkAAAABGdBTUEAALGPC/xhBQAAABJQTFRF9KxmNuN3n1pSLrCCQ0pfy4FePNWy0QAAADtJREFUCNdjcIEBBgRLEAaQWMYwgJWlbGwEQQxKxkoQxKAEAwyhMABjsYJYqqGhSnAxGCsIRR2QhcV9AJFcJViCy6XLAAAAAElFTkSuQmCC","name":"tile_0002.png","options":{"type":"image/png","lastModified":1696663628000}}}}}},{"id":1,"name":"charFile","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"/LoadFile","note":{"type":"block","isInstantiated":true,"code":"LoadFile","state":{"state":"loaded","file":{"content":"iVBORw0KGgoAAAANSUhEUgAAABgAAAAYBAMAAAASWSDLAAAABGdBTUEAALGPC/xhBQAAABhQTFRFAAAANJleQ0pfhva7////WtKMNGVHvt7xFlk/CQAAAAF0Uk5TAEDm2GYAAACESURBVBjTbdAxDsIwDAXQTGXuwgF6BSROgOQTODMIxV0ZrPr62P7xUMSf8mQr+klrP7HMPOvDQ6mLUgyUPgHCmgasEHtqh3h2o4RkgENuHtmBd+BeYE9hBPpfbLwVDMirjbCWDbybDxjdTq1P72kLWj8BXDAh6/W1yvwQ4T64sIw+cusLm7JKEh9ouLwAAAAASUVORK5CYII=","name":"tile_0000.png","options":{"type":"image/png","lastModified":1696663636000}}}}}},{"id":7,"name":"enemyFile","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"/LoadFile","note":{"type":"block","isInstantiated":true,"code":"LoadFile","state":{"state":"loaded","file":{"content":"iVBORw0KGgoAAAANSUhEUgAAABgAAAAYBAMAAAASWSDLAAAABGdBTUEAALGPC/xhBQAAABJQTFRFAAAAy4Fe/////uSB9LQbbz5D7N5EzgAAAAF0Uk5TAEDm2GYAAABTSURBVBjTY2AgFoRCAYjNCuMEgDjBxmBgiskJcQEDVwhHEMQWxMZBUeYSGuIaCue4hriGuGBVFqSkpIrQo6QE1yMCknGEcUBaHLEYgOwFFM8RBQCbzywIlKpD5AAAAABJRU5ErkJggg==","name":"tile_0012.png","options":{"type":"image/png","lastModified":1696663634000}}}}}},{"id":3,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"","note":{"type":"text","tag":"p","text":""}}},{"id":8,"name":"finreg","visibility":"result","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"/Code","note":{"type":"block","isInstantiated":true,"code":"Code","state":"window.finreg = (\n  window.finreg\n  || new FinalizationRegistry(finalizer => finalizer())\n)\nwindow.finreg"}}},{"id":9,"name":"image","visibility":"result","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"/Code","note":{"type":"block","isInstantiated":true,"code":"Code","state":"async function image(blob) {\n  const image = new Image()\n  const url = URL.createObjectURL(blob)\n  image.src = url\n  finreg.register(image, () => URL.revokeObjectURL(url))\n  await image.decode()\n  return image\n}"}}},{"id":2,"name":"","visibility":"block","width":"narrow","state":{"t":"resheet.note","v":1,"level":0,"input":"/Code","note":{"type":"block","isInstantiated":true,"code":"Code","state":"({\n  character: await image(charFile),\n  ground: await image(groundFile),\n  enemy: await image(enemyFile),\n})"}}}]}},"isCollapsed":false,"children":[]},{"id":3,"name":"Game","state":{"t":"resheet.selector","v":0,"mode":"run","expr":"Code","inner":"const { fieldDispatcher } = resheet.util.dispatch\n\n// The builtin Blocks used for editing the initial state, update logic and render logic\nconst initBlock = resheet.blocks.component.safeBlock(Code)\nconst updateBlock = resheet.blocks.component.safeBlock(SheetOf(Note))\nconst renderBlock = resheet.blocks.component.safeBlock(SheetOf(Note))\n\n\n// helper component to reduce rendering overhead when closed\nfunction Details({ open=false, children }) {\n  const [opened, setOpened] = React.useState(open)\n  \n  return (\n    <details open={opened} onToggle={ev => setOpened(ev.target.open)}>\n      {children[0]}\n      {opened && children.slice(1)}\n    </details>\n  )\n}\n\n\n// create a dispatcher that enhances the env\nfunction enhanceEnv(dispatch, enhance) {\n  return function dispatchWithEnhancedEnv(action) {\n    dispatch((state, { env }) =>\n      action(state, { env: enhance(env, state) })\n    )\n  }\n}\n\n// create the env for the update logic, adding the current state and input\nfunction updateEnv(env, state) {\n  return { ...env, state: state.state, input: state.input }\n}\n\n// the dispatcher for the update block\nfunction updateDispatcher(dispatch) {\n  return (\n    fieldDispatcher(\n      'updateState',\n      enhanceEnv(dispatch, updateEnv),\n    )\n  )\n}\n  \n\n// create the env for the render logic, adding the current state and act procedure\nfunction renderEnv(env, state, dispatch) {\n  return {\n    ...env,\n    state: state.state,\n    update(input) {\n      update(dispatch, state => ({\n        ...state,\n        input\n      }))\n    },\n  }\n}\n\n// the dispatcher for the render block\nfunction renderDispatcher(dispatch) {\n  return (\n    fieldDispatcher(\n      'renderState',\n      enhanceEnv(dispatch, (env, state) => renderEnv(env, state, dispatch)),\n    )\n  )\n}\n\n\n// all dispatchers for the different embedded blocks\nfunction dispatchers(dispatch) {\n  return {\n    init: fieldDispatcher('initState', dispatch),\n    update: updateDispatcher(dispatch),\n    render: renderDispatcher(dispatch),\n  }\n}\n\n\nfunction update(dispatch, fn) {\n  const disp = dispatchers(dispatch)\n\n  dispatch((state, { env }) => {\n    const fnState = fn(state, env)\n    \n    const updateState = updateBlock.recompute(\n      fnState.updateState,\n      disp.update,\n      updateEnv(env, fnState),\n      immutable.Set(['state', 'input']),\n    ).state\n    \n    const newState = {\n      ...fnState,\n      updateState,\n      state: updateBlock.getResult(updateState),\n    }\n    \n    const renderState = renderBlock.recompute(\n      newState.renderState,\n      disp.render,\n      renderEnv(env, newState, dispatch),\n      immutable.Set(['state']),\n    ).state\n\n\n    return {\n      state: {\n        ...newState,\n        renderState,\n      }\n    }\n  })\n}\n\nfunction recompute(state, dispatch, env, changed) {\n  const disp = dispatchers(dispatch)\n  \n  const initState = initBlock.recompute(\n    state.initState,\n    disp.init,\n    env,\n    changed,\n  ).state\n  \n  const updateState = updateBlock.recompute(\n    state.updateState,\n    disp.update,\n    updateEnv(env, state),\n    changed,\n  ).state\n  \n  const renderState = renderBlock.recompute(\n    state.renderState,\n    disp.render,\n    renderEnv(env, state, dispatch),\n    changed,\n  ).state\n  \n  return {\n    ...state,\n    initState,\n    updateState,\n    renderState,\n  }\n}\n\n\n\n// create the Game Block\nresheet.core.block.create({\n  // initial block state\n  init: {\n    state: initBlock.getResult(initBlock.init),\n    input: undefined,\n    initState: initBlock.init,\n    updateState: updateBlock.init,\n    renderState: renderBlock.init,\n  },\n  \n  // rendering the block\n  view({ state, dispatch, env }) {\n    const disp = dispatchers(dispatch)\n        \n    function reset() {\n      dispatch((state, { env }) => ({\n        state: recompute(\n          { ...state, state: initBlock.getResult(state.initState) },\n          dispatch,\n          env,\n          immutable.Set(['state']),\n        )\n      }))\n    }\n    \n    function updateGame(input) {\n      update(dispatch, state => ({\n        ...state,\n        input\n      }))\n    }\n\n    const rendered = renderBlock.getResult(state.renderState)\n    \n    return (\n      <div>\n        <Details>\n          <summary className=\"text-lg mb-2\">Initial State</summary>\n          <initBlock.Component\n            state={state.initState}\n            dispatch={disp.init}\n            env={env}\n            />\n        </Details>\n        \n        <Details>\n          <summary className=\"text-lg mb-2 mt-6\">Update State</summary>\n          <updateBlock.Component\n            state={state.updateState}\n            dispatch={disp.update}\n            env={updateEnv(env, state)}\n            />\n        </Details>\n        \n        <Details open>\n          <summary className=\"text-lg mb-2 mt-6\">Current State</summary>\n          <reactInspector.Inspector data={state.state} />\n        </Details>\n\n        <button\n          className=\"w-full rounded bg-blue-100 hover:bg-blue-200\"\n          onClick={reset}\n        >\n          Reset\n        </button>\n\n        <Details>\n          <summary className=\"text-lg mb-2 mt-6\">Render</summary>\n          <renderBlock.Component\n            state={state.renderState}\n            dispatch={disp.render}\n            env={renderEnv(env, state, dispatch)}\n            />\n        </Details>\n        \n        <resheet.code.value.ErrorBoundary\n          title=\"There was an error in your Renderer\"\n          viewError={error => <resheet.code.value.ErrorInspector error={error} />}\n          autoReset\n        >\n          {React.isValidElement(rendered) && React.createElement(() => rendered)}\n          {typeof rendered === 'function' &&\n            React.createElement(rendered, {\n              state: state.state,\n              update: updateGame,\n            })\n          }\n        </resheet.code.value.ErrorBoundary>\n      </div>\n    )\n  },\n\n  // the block's reported value\n  getResult(state) {\n    return state.state\n  },\n  \n  // loading logic\n  fromJSON(json, dispatch, env) {\n    const disp = dispatchers(dispatch)\n\n    const initState = initBlock.fromJSON(json.init, disp.init, env)\n    const initResult = initBlock.getResult(initState)\n    \n    const envUpdate = updateEnv(env, { state: initResult, input: undefined })\n    const updateState = updateBlock.fromJSON(json.update, disp.update, envUpdate)\n    \n    const envRender = renderEnv(env, { state: initResult }, dispatch)\n    const renderState = renderBlock.fromJSON(json.render, disp.render, envRender)\n    \n    return {\n      state: initResult,\n      initState,\n      updateState,\n      renderState,\n    }\n  },\n  \n  // saving logic\n  toJSON(state) {\n    return {\n      init: initBlock.toJSON(state.initState),\n      update: updateBlock.toJSON(state.updateState),\n      render: updateBlock.toJSON(state.renderState),\n    }\n  },\n  \n  // recomputation logic if something in env changed\n  recompute(state, dispatch, env, changed) {\n    const newState = recompute(state, dispatch, env, changed)\n    \n    return {\n      state: newState,\n      invalidated: false,\n    }\n  },\n})"},"isCollapsed":false,"children":[]},{"id":4,"name":"useAnimation","state":{"t":"resheet.selector","v":0,"mode":"run","expr":"Code","inner":"function useAnimation(step) {\n  const [running, setRunning] = React.useState(false)\n  const stepRef = React.useRef(step)\n  stepRef.current = step\n  \n  React.useEffect(() => {\n    let raf = null\n    let lastTime = null\n    \n    function animate() {\n      const time = performance.now()\n      \n      stepRef.current(lastTime === null ? 0 : time - lastTime)\n      \n      lastTime = time\n      raf = requestAnimationFrame(animate)\n    }\n    \n    if (running) {\n      raf = requestAnimationFrame(animate)\n    }\n    \n    return () => raf && cancelAnimationFrame(raf)\n  }, [running])\n  \n  function toggleRunning() {\n    setRunning(running => !running)\n  }\n  \n  return {\n    running,\n    setRunning,\n    toggleRunning,\n  }\n}"},"isCollapsed":false,"children":[]}]}]}],"viewState":{"sidebarOpen":true,"openPage":[0]},"template":{"id":2,"name":"","state":{"t":"resheet.selector","v":0,"mode":"run","expr":"SheetOf(Note)","inner":{"t":"resheet.sheet","v":2,"lines":[]}},"isCollapsed":false,"children":[]}}}